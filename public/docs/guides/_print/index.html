<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.123.6"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel=canonical type=text/html href=http://localhost:1313/docs/guides/><link rel=alternate type=application/rss+xml href=http://localhost:1313/docs/guides/index.xml><link rel="shortcut icon" href="/favicons/favicon.ico?v=1"><link rel=apple-touch-icon href="/favicons/apple-touch-icon-180x180.png?v=1" sizes=180x180><link rel=icon type=image/png href="/favicons/favicon-16x16.png?v=1" sizes=16x16><link rel=icon type=image/png href="/favicons/favicon-32x32.png?v=1" sizes=32x32><link rel=apple-touch-icon href="/favicons/apple-touch-icon-180x180.png?v=1" sizes=180x180><title>Guides | </title><meta property="og:title" content="Guides"><meta property="og:description" content="Guides for deeper integrations with Code Blind
"><meta property="og:type" content="website"><meta property="og:url" content="http://localhost:1313/docs/guides/"><meta property="og:site_name" content="Goldydocs"><meta itemprop=name content="Guides"><meta itemprop=description content="Guides for deeper integrations with Code Blind
"><meta name=twitter:card content="summary"><meta name=twitter:title content="Guides"><meta name=twitter:description content="Guides for deeper integrations with Code Blind
"><link rel=stylesheet href=/css/prism.css><link href=/scss/main.css rel=stylesheet><link rel=stylesheet type=text/css href=http://localhost:1313/css/asciinema-player.css><script src=https://code.jquery.com/jquery-3.3.1.min.js integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-light nav-shadow flex-column flex-md-row td-navbar"><a id=agones-top class=navbar-brand href=/><svg viewBox="0 -40 700 300" xmlns="http://www.w3.org/2000/svg"><g fill="#006298" fill-rule="none" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode:normal" transform="matrix(1, 0, 0, 1, 4.033676, -59.776756)"><g data-paper-data='{"isGlobalGroup":true,"bounds":{"x":65,"y":134.91096067769388,"width":420,"height":200.17807864461224}}'><g data-paper-data='{"isPrimaryText":true}' fill-rule="nonzero" transform="matrix(1.506311, 0, 0, 1.608315, -96.423798, -293.86853)" style=""><path d="M99.87138 315.5382c-1.20049 6.40261-6.57411 11.03307-12.97673 11.03307-7.14577.0-12.80523-6.00245-12.80523-13.49122.0-7.54594 5.65945-13.60555 12.80523-13.60555 4.4018.0 8.74643 2.22948 11.8334 6.80278l6.91711-4.91629c-3.83013-6.23111-10.86158-10.34708-18.80768-10.34708C74.71825 291.01391 65 300.90366 65 313.08006s9.71825 22.00898 21.89465 22.00898c11.31891.0 20.69416-8.63209 21.95182-19.55084z" data-paper-data='{"glyphName":"C","glyphIndex":0,"firstGlyphOfWord":true,"word":1}'/><path d="M134.79992 335.08904c12.1764.0 22.00898-9.88975 22.00898-22.06615s-9.83258-22.00898-22.06615-22.00898c-12.1764.0-22.00898 9.83258-22.00898 22.00898s9.83258 22.06615 22.06615 22.06615zM134.74275 299.4745c7.20294.0 12.97673 6.05962 12.97673 13.54839.0 7.6031-5.71662 13.54839-12.91956 13.54839-7.31727.0-12.97673-5.94528-12.97673-13.54839.0-7.48877 5.65945-13.54839 12.91956-13.54839z" data-paper-data='{"glyphName":"O","glyphIndex":1,"word":1}'/><path d="M163.15435 291.75707v42.58881h17.32136c12.23356.0 22.23765-9.08942 22.23765-21.32299.0-12.11923-10.00408-21.26582-22.29481-21.26582zm8.86076 34.58554v-26.58228h8.40343c7.4316.0 13.20539 5.54512 13.20539 13.26256.0 7.66027-5.77379 13.31972-13.14822 13.31972z" data-paper-data='{"glyphName":"D","glyphIndex":2,"word":1}'/><path d="M235.46958 334.34588v-8.00327h-17.55002V315.7097h16.00653v-8.00327h-16.00653v-7.9461h13.77705v-8.00327H209.0588v42.58881z" data-paper-data='{"glyphName":"E","glyphIndex":3,"word":1}'/><path d="M256.67824 334.34588c7.83177.0 15.09187-5.03062 15.09187-13.71989.0-4.11597-1.94365-7.7746-5.77379-10.40425 2.05798-1.88648 3.02981-4.2303 3.02981-7.20294.0-7.9461-5.65945-11.26174-13.54839-11.26174h-13.66272v42.58881zM250.67579 326.34261V315.3667h6.28828c3.65864.0 5.71662 2.11515 5.71662 5.54512.0 3.31564-2.05798 5.43079-5.71662 5.43079zm0-18.69334v-7.88893h4.45896c2.45815.0 4.80196.68599 4.80196 3.94447.0 1.77215-.5145 3.94447-4.80196 3.94447z" data-paper-data='{"glyphName":"B","glyphIndex":4,"word":1}'/><path d="M278.11556 291.75707v42.58881h26.01062v-8.00327h-17.14986v-34.58555z" data-paper-data='{"glyphName":"L","glyphIndex":5,"word":1}'/><path d="M317.90323 291.75707h-8.86076v42.58881h8.86076z" data-paper-data='{"glyphName":"I","glyphIndex":6,"word":1}'/><path d="M356.31891 316.3957l-30.29808-25.43895v43.38914h8.86076v-24.46713l30.29808 25.21029v-43.33197h-8.86076z" data-paper-data='{"glyphName":"N","glyphIndex":7,"word":1}'/><path d="M373.29726 291.75707v42.58881h17.32136c12.23356.0 22.23765-9.08942 22.23765-21.32299.0-12.11923-10.00408-21.26582-22.29481-21.26582zM382.15802 326.34261v-26.58228h8.40343c7.4316.0 13.20539 5.54512 13.20539 13.26256.0 7.66027-5.77379 13.31972-13.14822 13.31972z" data-paper-data='{"glyphName":"D","glyphIndex":8,"word":1}'/></g><g data-paper-data='{"fillRule":"evenodd","fillRuleOriginal":"evenodd","isIcon":true,"iconStyle":"standalone","selectedEffects":{"container":"triangle_simple_outline3","transformation":"","pattern":""},"bounds":{"x":200.4253260667158,"y":134.91096067769388,"width":149.1493478665684,"height":129.93559557606665},"widthRatioIconToContainer":0.46864262218011316,"heightRatioIconToContainer":0.5128464428206175,"relativeBoundsIconToContainer":{"top":0.1511909708697078,"left":0.00000405714571068623},"iconType":"icon","rawIconId":"22591","isDetailed":false,"blockLetter":"A","suitableAsStandaloneIcon":true}' fill-rule="evenodd" transform="matrix(0.857575, 0, 0, 0.832887, 371.420288, 37.764965)" style=""><path d="M240.08737 218.30866l-.03565-.03565.03565-.21459c0-3.26912.85904-7.02682 2.57713-11.2738 1.07363-2.36185 2.46949-4.70062 4.18758-7.01493.90657-1.24068 2.39819-2.85113 4.47346-4.83203 2.14726-1.81315 4.21134-3.26842 6.19154-4.36651 1.76562-.97857 3.99676-1.92079 6.69271-2.82736 2.19549-.71575 5.07038-1.21692 8.62538-1.5028l.85904-.03565v.03565l.07199-.03565h2.11161l.25024.03565.03565-.03565.21528.03565c2.95807.0 6.5613.69199 10.80829 2.07597 2.38631.88281 4.74815 2.02843 7.08694 3.43617 1.45527.85904 3.14959 2.11161 5.08226 3.75771 2.33878 2.21925 3.88911 3.93664 4.65239 5.15426 1.79008 2.43314 3.18594 5.04592 4.18758 7.83763 1.14562 3.4837 1.71809 6.52566 1.71809 9.12655l.03495.14259h-.03565l.03565.03565v2.2542l-.03565.03635.03565.03635c0 1.76492-.35788 4.3057-1.07363 7.62305-.66822 2.33808-1.39586 4.34205-2.18291 6.01261-.85904 1.69432-2.02773 3.51935-3.50816 5.47579-.9541 1.16939-2.19549 2.49326-3.72205 3.97299-2.4576 2.07597-4.53287 3.61511-6.22719 4.61675-.73952.38164-1.40774.57247-2.00397.57247-1.59856.0-2.67219-.78775-3.22089-2.36254-.09576-.42917-.14329-.79963-.14329-1.10928.0-1.36021 1.19316-2.66031 3.57947-3.90099.73952-.35788 1.92009-1.26515 3.54242-2.72042 2.07597-2.0522 3.51935-3.75771 4.33086-5.11791.93034-1.43151 1.70551-2.92313 2.3262-4.47346.85904-2.43314 1.28822-4.02051 1.28822-4.76003l.35858-2.29055-.07199-.03565.07199-.21528v-.32223l.03565-.03635-.03565-.03565.03565-.14329.03565-1.61045c0-7.11-2.63584-13.29036-7.90893-18.53898-1.95644-1.74185-3.39983-2.87489-4.33016-3.39983-4.86768-3.03007-10.00935-4.54545-15.42574-4.54545h-1.64609l-.21459.03565v-.03565l-.03565.03565h-.03635c-2.40937.0-5.32062.56058-8.73232 1.68244-1.81385.69199-3.63888 1.59856-5.47579 2.72042-1.16939.69199-2.79172 2.00397-4.86768 3.93664l-1.18127 1.28822c-4.55733 5.08226-6.836 10.90405-6.836 17.46535l.03565.39352h-.03635l.03565.03565v.03565c0 4.67686 1.95644 10.04501 5.86931 16.10584 3.17336 4.72439 5.51214 8.29127 7.01493 10.70135.52493.88351 1.03728 1.86068 1.53845 2.93501h-.03565c-3.19712-1.45527-6.17966-3.16147-8.94761-5.11791-2.09972-1.64609-3.80523-3.30546-5.11791-4.97462-1.5028-2.09972-2.61278-3.88911-3.32853-5.36885-.85904-1.67055-1.65868-3.75771-2.39819-6.26353-.42917-1.57479-.77517-3.2803-1.03798-5.11722l-.17894-1.96832h.03565l-.03565-.03635-.03495-1.82503v-1.00234l.03565-.03565-.03565-.03565v-.03565zm34.03601-22.7622h2.04032l.03565.07199.03635-.07199c1.59856.04753 3.65076.38164 6.15589 1.00234 2.17103.69199 3.97299 1.44339 5.40379 2.2549 1.33645.73952 2.86371 1.86138 4.58179 3.36418 2.14726 2.07597 3.53124 3.63888 4.15123 4.68874 1.16939 1.69432 2.07597 3.49558 2.72042 5.40449.52493 1.31198.89469 3.20901 1.10928 5.69038v.03565h-.03565l.03565.03565v1.32457c0 6.46554-2.67219 12.24049-8.01727 17.32206-2.4576 2.17103-4.0324 3.29288-4.72439 3.36418-.42917.19082-.89399.28588-1.39586.28588h-.07129c-1.5035.0-2.55336-.7514-3.14959-2.2549l-.17964-1.07363c0-1.57479 1.04986-2.82736 3.14959-3.75771.66822-.33481 1.44339-.93104 2.3262-1.79008 1.40844-1.47973 2.41007-2.83924 3.007-4.08063.5487-.9541 1.07363-2.28985 1.57479-4.00793.28588-1.40774.42917-2.42195.42917-3.04195h.03565l-.03565-.0727.03565-.17894v-1.93267l-.03565-.17894h.03565l-.03565-.14329c0-1.74185-.60811-3.84158-1.82503-6.29918-.59693-1.0974-1.46785-2.26679-2.61278-3.50747-1.21622-1.24068-2.24232-2.09972-3.0776-2.57713-3.38794-2.17103-6.76401-3.25724-10.12818-3.25724h-.10694l-.03635-.07199-.03565.07199h-.10764l-.03565-.07199-.03565.07199h-.39352l-.03635-.07199-.03565.07199h-.64446l-.21459.03565v-.03565c-1.5028.14329-2.67219.33411-3.50816.57247-4.00793 1.14492-7.13376 3.03007-9.37678 5.65473-1.28891 1.40774-2.29055 2.89866-3.0063 4.47346-.93034 2.17103-1.39586 4.21134-1.39586 6.12025v.7514l-.03565.03565.03565.03565v.07129c0 3.14959 1.19316 6.47812 3.57876 9.98559 6.06083 9.6389 10.72511 17.28641 13.99423 22.94114l-.03565.03565h-.03635c-4.17569-.38164-6.96741-.77517-8.37445-1.18057-5.55897-8.78056-8.67292-13.66012-9.34113-14.63729-2.95877-4.48604-4.79568-7.77892-5.51143-9.87865-.78775-2.36185-1.18127-4.80827-1.18127-7.33716.0-5.48767 1.80126-10.52241 5.40449-15.10351.5487-.71575 1.68174-1.8495 3.39983-3.39983 3.24536-2.57713 6.78777-4.28264 10.62935-5.11791 1.38467-.30685 3.0063-.52213 4.86768-.64096v.07199zM274.69654 205.06653h1.10998l.07199.07199.03565-.07199h.03565l.03635.07199.03565-.07199c1.04986.0 2.46949.25024 4.25957.7514 3.6263 1.28822 6.38236 3.67453 8.26751 7.15823 1.04986 2.17103 1.57479 4.29522 1.57479 6.37048v.21459c0 3.96111-1.7062 7.55175-5.11791 10.77264-1.43151 1.14562-2.7323 1.71809-3.90099 1.71809-1.45597.0-2.54148-.77517-3.25724-2.3262-.11883-.33411-.19012-.68011-.21459-1.03798.0-1.19246.88281-2.39749 2.64842-3.61441 1.26445-.85904 2.07597-1.8495 2.43314-2.97065.28658-.81151.42917-1.61045.42917-2.39819v-.14329c0-2.38631-1.04986-4.49792-3.14959-6.33484-1.38328-1.0261-3.10206-1.53915-5.15356-1.53915l-.28588.03565v-.03565l-.03635.03565h-.07199c-1.88444.0-3.69829.81081-5.43944 2.43314-1.40844 1.62233-2.11161 3.4837-2.11161 5.58343.0 1.78938 1.2288 4.42593 3.68641 7.90963 6.34672 9.99747 11.22628 17.88264 14.63729 23.65759-3.05383.81081-5.40379 1.21622-7.05059 1.21622-3.14959-4.5811-6.84788-10.4623-11.09487-17.64359-1.45527-2.43384-3.0776-4.95156-4.86698-7.55245-1.59856-2.48137-2.39889-5.07038-2.39889-7.76634.0-3.74582 1.37209-7.06247 4.11628-9.94925 1.47904-1.36021 2.82736-2.32689 4.04428-2.89866 2.17103-.90657 3.61511-1.36021 4.33016-1.36021.4061-.09506 1.19316-.19082 2.36254-.28588v.07199zm74.56087 55.60127c.0215.04174.0421.08398.06181.1267.01926.04277.0374.08599.05442.12966.01747.04366.03381.08771.04904.13215.01478.04448.02867.08926.04165.13436.01299.04515.02486.09058.0356.13631.0103.04573.0197.09168.02822.13785.00851.04618.0159.09253.02217.13907.00582.04653.01075.0932.01478.14001.00358.04676.00627.09361.00806.14054.00134.04694.00179.09385.00134.14074-89e-5.04694-.00291.09383-.00605.14068-.00313.04685-.00739.09358-.01277.14021-.00538.04667-.01186.09316-.01948.13947-.00761.04631-.01635.0924-.0262.13825-.00985.04591-.02083.09153-.03292.13684-.0121.04537-.0253.09038-.03964.13503-.01478.0447-.03023.08901-.04636.13295-.01657.04394-.03426.08745-.05307.13053-.01881.04304-.03852.08561-.05912.12771s-.04232.08369-.06516.12476c-.02284.04102-.0468.08147-.07188.12133-.02463.03986-.05038.07909-.07726.1177-.02642.03856-.05397.07648-.08263.11373-.02867.03722-.05822.07374-.08868.10957-.03046.03579-.06158.07081-.09338.10507-.03225.03426-.06516.06772-.09875.10037s-.06808.06445-.10346.0954c-.03538.03095-.07144.061-.10816.09015-.03673.0292-.07412.05746-.11219.08478-.03852.02736-.07748.05377-.1169.07921-.03941.02544-.0795.04989-.12025.07336-.21766.12585-.44809.22136-.69128.28652-.2432.06516-.49064.09775-.74234.09775H203.29356c-.04694.0-.09385-.00116-.14074-.00349-.04689-.00228-.0937-.00573-.14041-.01034-.04671-.00457-.09327-.0103-.13967-.0172-.04645-.0069-.09269-.01494-.13872-.02412-.04604-.00914-.09184-.01941-.13738-.03084-.04551-.01137-.09071-.02389-.13564-.03756-.04492-.01362-.08948-.02833-.13369-.04414-.04421-.01581-.08798-.03269-.13134-.05065-.0434-.01796-.08631-.03697-.12872-.05703-.04246-.02007-.08438-.04116-.12576-.06328-.04138-.02217-.0822-.0453-.12247-.0694-.04026-.02414-.07992-.04926-.11898-.07537-.03901-.02606-.07737-.05307-.11508-.08102-.03771-.028-.0747-.05686-.11098-.0866-.03628-.02979-.07182-.06044-.10661-.09197-.0348-.03153-.0688-.06389-.10198-.09707-.03319-.03319-.06554-.06718-.09707-.10198-.03153-.03475-.06217-.07029-.09191-.10661-.02979-.03628-.05867-.07327-.08666-.11098-.02795-.03771-.05495-.07607-.08102-.11508-.02611-.03905-.05121-.07871-.07531-.11898-.02414-.04022-.04727-.08104-.0694-.12247-.02213-.04138-.04324-.0833-.06335-.12576-.02007-.04241-.03908-.0853-.05703-.12865-.01796-.0434-.03484-.0872-.05065-.13141-.01581-.04416-.03052-.0887-.04414-.13362-.01366-.04492-.02618-.09015-.03756-.1357-.01142-.04555-.0217-.09134-.03084-.13738-.00918-.04604-.01722-.09226-.02412-.13866-.00685-.04645-.01259-.09302-.0172-.13974-.00462-.04671-.00806-.09352-.01034-.14041-.00233-.04689-.00349-.09381-.00349-.14074.0-.25175.03258-.4992.09775-.74234.06516-.2432.16067-.47378.28652-.69175l71.7064-124.19911c.02347-.04067.04792-.08073.07336-.12018.02544-.03946.05184-.07827.07921-.11643.02732-.03816.05558-.07563.08478-.11239.02916-.03677.0592-.0728.09015-.1081.03095-.03529.06275-.0698.0954-.10352.03265-.03372.0661-.06662.10037-.09868.03426-.03211.06929-.06335.10507-.09372.03579-.03037.07231-.05984.10957-.08841.03722-.02858.07513-.05623.11373-.08296.03861-.02669.07784-.05245.1177-.07726.03986-.02477.0803-.04855.12133-.07135.04102-.0228.08261-.04459.12476-.06536.0421-.02074.08467-.04044.12771-.05912.04308-.01867.0866-.03628.13053-.05281.04394-.01657.08823-.03202.13288-.04636.0447-.01438.08973-.02763.1351-.03977.04533-.01214.09094-.02318.13684-.03312.04586-.0099.09195-.01867.13825-.02633.04631-.00761.09278-.01411.1394-.01948.04667-.00538.09343-.00958.14027-.01263.0468-.00309.09367-.00502.14061-.00578.04694-76e-5.09387-38e-5.14081.00114.04689.00152.09374.00421.14054.00806.0468.00385.09347.00882.14001.01491.04653.00614.09289.01342.13907.02184.04618.00837.09213.01789.13785.02855.04573.01066.09116.02244.13631.03533.0451.0129.08988.02689.13436.04199.04443.01509.08848.03126.13215.0485.04366.01724.08686.03556.12959.05495.04277.01934.08503.03975.12677.0612.04178.02146.08299.04392.12361.06738.21802.1259.41604.27784.59408.45582.17798.17802.32993.37605.45582.59408l71.70627 124.19911c.02374.04062.04613.08182.06718.12361zM274.99998 143.5157l-66.73842 115.59433H341.7386z" data-paper-data='{"isPathIcon":true}'/></g></g></g></svg> <span class="text-uppercase fw-bold"></span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/docs/><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><span>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/josephbarnett/codeblind.ai>GitHub</a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://app.codeblind.ai/login>Login</a></li></ul></div><div class="navbar-nav mx-lg-2 d-none d-lg-block"></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/guides/>Return to the regular view of this page</a>.</p></div><h1 class=title>Guides</h1><div class=lead>Guides for deeper integrations with Code Blind</div><ul><li>1: <a href=#pg-9991ac61ed3099936d3b9bbfb12d0f3e>Feature Stages</a></li><li>2: <a href=#pg-52398247f3240f270287eb9ac807491b>Best Practices</a></li><ul><li>2.1: <a href=#pg-f726976ee94b3b66e8467a404921069b>Google Kubernetes Engine Best Practices</a></li></ul><li>3: <a href=#pg-6f8bbe726ba7c85476067c9513fc6136>Code Blind Game Server Client SDKs</a></li><ul><li>3.1: <a href=#pg-d9110a0f360a4714db35abf6ce38a140>Unreal Engine Game Server Client Plugin</a></li><li>3.2: <a href=#pg-cb46d2c42280b723ba5194728d8f8e48>Unity Game Server Client SDK</a></li><li>3.3: <a href=#pg-ea9cf494f21474538fa0638b52a8cb68>C++ Game Server Client SDK</a></li><li>3.4: <a href=#pg-63f37ca64d7de9cc29ac4ba30acbcd56>Go Game Server Client SDK</a></li><li>3.5: <a href=#pg-7bcee3a1d527cbfefbcd4e6a271adb91>C# Game Server Client SDK</a></li><li>3.6: <a href=#pg-f8485ce33aea4cc5839759a0e6cfb78e>Node.js Game Server Client SDK</a></li><li>3.7: <a href=#pg-24d1a13fcc983c347c4d6e93b5c781b0>Rust Game Server Client SDK</a></li><li>3.8: <a href=#pg-dd2771f8169b00ae8809eb9b01e73547>REST Game Server Client API</a></li><li>3.9: <a href=#pg-556057b2ca01a14c9507c51a6c2ec979>Local Development</a></li></ul><li>4: <a href=#pg-5e516fa2b9ffa121bddad09db5bc4c2c>Windows Gameservers</a></li><li>5: <a href=#pg-02f8cd51bf4cf97802ded5bc598c3392>Fleet Updates</a></li><li>6: <a href=#pg-92d27aa55ec2fc72cebf70399bffad86>GameServer Health Checking</a></li><li>7: <a href=#pg-a08db3b081cafbd3d70d9f298bfcb5a4>Player Tracking</a></li><li>8: <a href=#pg-23757d70ae51993a62d84d8b6ff8f736>Local Game Server</a></li><li>9: <a href=#pg-d09d57ab1b4977b31173571cab22eba4>Latency Testing with Multiple Clusters</a></li><li>10: <a href=#pg-9346aaa1ce9cead47412256db81fcfb4>Metrics</a></li><li>11: <a href=#pg-35cc8c47e6283062d03d8cced1728ff8>Access Code Blind via the Kubernetes API</a></li><li>12: <a href=#pg-48e070a0265c9a00bbcc2563e96ed22c>Troubleshooting</a></li></ul><div class=content></div></div><div class=td-content><h1 id=pg-9991ac61ed3099936d3b9bbfb12d0f3e>1 - Feature Stages</h1><div class=lead>This page provides a description of the various stages that Code Blind features can be in, and the relative maturity and support level expected for each level.</div><h2 id=supported-versions>Supported Versions</h2><p>Code Blind versions are expressed as x.y.z, where x is the major version, y is the minor version, and z is the patch version
following <a href=http://semver.org/>Semantic Versioning</a> terminology.</p><h2 id=code-blind-features>Code Blind Features</h2><p>A feature within Code Blind can be in <code>Alpha</code>, <code>Beta</code> or <code>Stable</code> stage.</p><h2 id=feature-gates>Feature Gates</h2><p><code>Alpha</code> and <code>Beta</code> features can be enabled or disabled through the <code>agones.featureGates</code> configuration option
that can be found in the <a href=http://localhost:1313/docs/installation/install-agones/helm/#configuration>Helm configuration</a> documentation.</p><p>The current set of <code>alpha</code> and <code>beta</code> feature gates:</p><table><thead><tr><th>Feature Name</th><th>Gate</th><th>Default</th><th>Stage</th><th>Since</th></tr></thead><tbody><tr><td><a href=/docs/guides/fleet-updates/#notifying-gameservers-on-fleet-updatedownscale>Allocated GameServers are notified on relevant Fleet Updates</a></td><td><code>FleetAllocationOverflow</code></td><td>Enabled</td><td><code>Beta</code></td><td>1.37.0</td></tr><tr><td><a href=https://github.com/googleforgames/agones/issues/2716>CountsAndLists</a></td><td><code>CountsAndLists</code></td><td>Disabled</td><td><code>Alpha</code></td><td>1.37.0</td></tr><tr><td><a href=https://github.com/googleforgames/agones/issues/1239>GameServer player capacity filtering on GameServerAllocations</a></td><td><code>PlayerAllocationFilter</code></td><td>Disabled</td><td><code>Alpha</code></td><td>1.14.0</td></tr><tr><td><a href=http://localhost:1313/docs/guides/player-tracking/>Player Tracking</a></td><td><code>PlayerTracking</code></td><td>Disabled</td><td><code>Alpha</code></td><td>1.6.0</td></tr><tr><td><a href=https://github.com/googleforgames/agones/issues/3377>DisableResyncOnSDKServer</a></td><td><code>DisableResyncOnSDKServer</code></td><td>Disabled</td><td><code>Alpha</code></td><td>1.37.0</td></tr><tr><td>Example Gate (not in use)</td><td><code>Example</code></td><td>Disabled</td><td>None</td><td>0.13.0</td></tr></tbody></table><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>If you aren&rsquo;t sure if Feature Flags have been set correctly, have a look at the
<em><a href=/docs/guides/troubleshooting/#the-feature-flag-i-enableddisabled-isnt-working-as-expected>The Feature Flag I enabled/disabled isn&rsquo;t working as expected</a></em>
troubleshooting section.</div><h2 id=description-of-stages>Description of Stages</h2><h3 id=alpha>Alpha</h3><p>An <code>Alpha</code> feature means:</p><ul><li>Disabled by default.</li><li>Might be buggy. Enabling the feature may expose bugs.</li><li>Support for this feature may be dropped at any time without notice.</li><li>The API may change in incompatible ways in a later software release without notice.</li><li>Recommended for use only in short-lived testing clusters, due to increased risk of bugs and lack of long-term support.</li></ul><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>Please do try <code>Alpha</code> features and give feedback on them. This is important to ensure less breaking changes
through the <code>Beta</code> period.</div><h3 id=beta>Beta</h3><p>A <code>Beta</code> feature means:</p><ul><li>Enabled by default, but able to be disabled through a feature gate.</li><li>The feature is well tested. Enabling the feature is considered safe.</li><li>Support for the overall feature will not be dropped, though details may change.</li><li>The schema and/or semantics of objects may change in incompatible ways in a subsequent beta or stable releases. When
this happens, we will provide instructions for migrating to the next version. This may require deleting, editing,
and re-creating API objects. The editing process may require some thought. This may require downtime for
applications that rely on the feature.</li><li>Recommended for only non-business-critical uses because of potential for incompatible changes in subsequent releases.
If you have multiple clusters that can be upgraded independently, you may be able to relax this restriction.</li></ul><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>Note: Please do try <code>Beta</code> features and give feedback on them! After they exit beta, it may not be practical for us
to make more changes.</div><h3 id=stable>Stable</h3><p>A <code>Stable</code> feature means:</p><ul><li>The feature is enabled and the corresponding feature gate no longer exists.</li><li>Stable versions of features will appear in released software for many subsequent versions.</li></ul><h2 id=feature-stage-indicators>Feature Stage Indicators</h2><p>There are a variety of features with Code Blind, how can we determine what stage each feature is in?</p><p>Below are indicators for each type of functionality that can be used to determine the feature stage for a given aspect
of Code Blind.</p><h3 id=custom-resource-definitions-crds>Custom Resource Definitions (CRDs)</h3><p>This refers to Kubernetes resource for Code Blind, such as <code>GameServer</code>, <code>Fleet</code> and <code>GameServerAllocation</code>.</p><h4 id=new-crds>New CRDs</h4><p>For new resources, the stage of the resource will be indicated by the <code>apiVersion</code> of the resource.</p><p>For example: <code>apiVersion: "agones.dev/v1"</code> is a <code>stable</code> resource, <code>apiVersion: "agones.dev/v1beta1"</code> is a <code>beta</code>
stage resource, and <code>apiVersion: "agones.dev/v1alpha1"</code> is an <code>alpha</code> stage resource.</p><h4 id=new-crd-attributes>New CRD attributes</h4><p>When <code>alpha</code> and <code>beta</code> attributes are added to an existing stable Code Blind CRD, we will follow the Kubernetes <a href=https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api_changes.md#adding-unstable-features-to-stable-versions><em>Adding
Unstable Features to Stable Versions</em></a>
Guide to optimise on the least amount of breaking changes for users as attributes progress through feature stages.</p><p><code>alpha</code> and <code>beta</code> attributes will be added to the existing CRD as <code>optional</code> and documented with their feature stage.
Attempting to populate these <code>alpha</code> and <code>beta</code> attributes on an Code Blind CRD will return a validation error if their
accompanying Feature Flag is not enabled.</p><p><code>alpha</code> and <code>beta</code> attributes can be subject to change of name and structure, and will result in breaking changes
before moving to a <code>stable</code> stage. These changes will be outlined in release notes and feature documentation.</p><h3 id=code-blind-game-server-sdk>Code Blind Game Server SDK</h3><p>Any <code>alpha</code> or <code>beta</code> Game Server SDK functionality will be a subpackage of the <code>sdk</code> package. For example
, functionality found in a <code>sdk.alphav1</code> package should be considered at the <code>alpha</code> feature stage.</p><p>Only experimental functionality will be found in any <code>alpha</code> and <code>beta</code> SDK packages, and as such may change as
development occurs.</p><p>As SDK features move to through feature stages towards <code>stable</code>, the previous version of the SDK API
will remain for at least one release to enable easy migration to the more stable feature stage (i.e. from <code>alpha </code>-> <code>beta</code>, <code>beta</code> -> <code>stable</code>)</p><p>Any other SDK functionality not marked as <code>alpha</code> or <code>beta</code> is assumed to be <code>stable</code>.</p><h3 id=rest--grpc-apis>REST & gRPC APIs</h3><p>REST and gRPC API will have versioned paths where appropriate to indicate their feature stage.</p><p>For example, a REST API with a prefix of <code>v1alpha1</code> is an <code>alpha</code> stage feature:
<code>http://api.example.com/v1alpha1/exampleaction</code>.</p><p>Similar to the SDK, any <code>alpha</code> or <code>beta</code> gRPC functionality will be a subpackage of the main API package.
For example, functionality found in a <code>api.alphav1</code> package should be considered at the <code>alpha</code> feature stage.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-52398247f3240f270287eb9ac807491b>2 - Best Practices</h1><div class=lead>Best practices for running Code Blind in production.</div><h2 id=overview>Overview</h2><p>Running Code Blind in production takes consideration, from planning your launch to figuring
out the best course of action for cluster and Code Blind upgrades. On this page, we&rsquo;ve collected
some general best practices. We also have cloud specific pages for:</p><ul><li><a href=/docs/guides/best-practices/gke/>Google Kubernetes Engine (GKE)</a></li></ul><p>If you are interested in submitting best practices for your cloud prodiver / on-prem, <a href=/docs/contribute/>please contribute!</a></p><h2 id=separation-of-code-blind-from-gameserver-nodes>Separation of Code Blind from GameServer nodes</h2><p>When running in production, Code Blind should be scheduled on a dedicated pool of nodes, distinct from where Game Servers
are scheduled for better isolation and resiliency. By default Code Blind prefers to be scheduled on nodes labeled with
<code>agones.dev/agones-system=true</code> and tolerates the node taint <code>agones.dev/agones-system=true:NoExecute</code>.
If no dedicated nodes are available, Code Blind will run on regular nodes. See <a href=https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/>taints and tolerations</a>
for more information about Kubernetes taints and tolerations.</p><p>If you are collecting <a href=/docs/guides/metrics/>Metrics</a> using our standard Prometheus installation, see
<a href=/docs/guides/metrics/#prometheus-installation>the installation guide</a> for instructions on configuring a separate node pool for the <code>agones.dev/agones-metrics=true</code> taint.</p><p>See <a href=/docs/installation/creating-cluster/>Creating a Cluster</a> for initial set up on your cloud provider.</p><h2 id=redundant-clusters>Redundant Clusters</h2><h3 id=allocate-across-clusters>Allocate Across Clusters</h3><p>Code Blind supports <a href=/docs/advanced/multi-cluster-allocation/>Multi-cluster Allocation</a>, allowing you to allocate from a set of clusters, versus a single point of potential failure. There are several other options for multi-cluster allocation:</p><ul><li><a href=https://cloud.google.com/anthos/service-mesh>Anthos Service Mesh</a> can be used to route allocation traffic to different clusters based on arbitrary criteria. See <a href=https://github.com/googleforgames/global-multiplayer-demo>Global Multiplayer Demo</a> for an example where the match maker influences which cluster the allocation is routed to.</li><li><a href=https://github.com/googleforgames/agones/tree/main/examples/allocation-endpoint>Allocation Endpoint</a> can be used in Cloud Run to proxy allocation requests.</li><li>Or peruse the <a href=/docs/third-party-content/libraries-tools/#allocation>Third Party Examples</a></li></ul><h3 id=spread>Spread</h3><p>You should consider spreading your game servers in two ways:</p><ul><li><strong>Across geographic fault domains</strong> (<a href=https://cloud.google.com/compute/docs/regions-zones>GCP regions</a>, <a href=https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html>AWS availability zones</a>, separate datacenters, etc.): This is desirable for geographic fault isolation, but also for optimizing client latency to the game server.</li><li><strong>Within a fault domain</strong>: Kubernetes Clusters are single points of failure. A single misconfigured RBAC rule, an overloaded Kubernetes Control Plane, etc. can prevent new game server allocations, or worse, disrupt existing sessions. Running multiple clusters within a fault domain also allows for <a href=/docs/installation/upgrading/#upgrading-agones-multiple-clusters>easier upgrades</a>.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-f726976ee94b3b66e8467a404921069b>2.1 - Google Kubernetes Engine Best Practices</h1><div class=lead>Best practices for running Code Blind on Google Kubernetes Engine (GKE).</div><h2 id=overview>Overview</h2><p>On this page, we&rsquo;ve collected several <a href=https://cloud.google.com/kubernetes-engine/>Google Kubernetes Engine (GKE)</a> best practices.</p><h2 id=release-channels>Release Channels</h2><h3 id=why>Why?</h3><p>We recommned using <a href=https://cloud.google.com/kubernetes-engine/docs/concepts/release-channels>Release Channels</a> for all GKE clusters. Using Release Channels has several advantages:</p><ul><li>Google automatically manages the version and upgrade cadence for your Kubernetes Control Plane and its nodes.</li><li>Clusters on a Release Channel are allowed to use the <code>No minor upgrades</code> and <code>No minor or node upgrades</code> <a href=https://cloud.google.com/kubernetes-engine/docs/concepts/maintenance-windows-and-exclusions#limitations-maint-exclusions>scope of maintenance exclusions</a> - in other words, enrolling a cluster in a Release Channel gives you <em>more control</em> over node upgrades.</li><li>Clusters enrolled in <code>rapid</code> channel have access to the newest Kubernetes version first. Code Blind strives to <a href=/docs/installation/#agones-and-kubernetes-supported-versions>support the newest release in <code>rapid</code> channel</a> to allow you to test the newest Kubernetes soon after it&rsquo;s available in GKE.</li></ul><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>GKE Autopilot clusters must be on Release Channels.</div><h3 id=what-channel-should-i-use>What channel should I use?</h3><p>We recommend the <code>regular</code> channel, which offers a balance between stability and freshness. See <a href=https://cloud.google.com/kubernetes-engine/docs/concepts/release-channels#what_channel_should_i_use>this guide</a> for more discussion.</p><p>If you need to disallow minor version upgrades for more than 6 months, consider choosing the freshest Kubernetes version possible: Choosing the freshest version on <code>rapid</code> or <code>regular</code> will extend the amount of time before your cluster reaches <a href=https://cloud.google.com/kubernetes-engine/docs/release-schedule#schedule-for-release-channels>end of life</a>.</p><h3 id=what-versions-are-available-on-a-given-channel>What versions are available on a given channel?</h3><p>You can query the versions available across different channels using <code>gcloud</code>:</p><pre tabindex=0><code>gcloud container get-server-config \
  --region=[COMPUTE_REGION] \
  --flatten=&#34;channels&#34; \
  --format=&#34;yaml(channels)&#34;
</code></pre><p>Replace the following:</p><ul><li><strong>COMPUTE_REGION</strong>: the
<a href=https://cloud.google.com/compute/docs/regions-zones#available>Google Cloud region</a>
where you will create the cluster.</li></ul><h2 id=managing-game-server-disruption-on-gke>Managing Game Server Disruption on GKE</h2><p>If your game session length is less than an hour, use the <code>eviction</code> API to configure your game servers appropriately - see <a href=/docs/advanced/controlling-disruption/>Controlling Disruption</a>.</p><p>For sessions longer than an hour, there are currently two possible approaches to manage disruption:</p><ul><li><p>(GKE Standard/Autopilot) <a href=https://martinfowler.com/bliki/BlueGreenDeployment.html>Blue/green deployment</a> at the cluster level: If you are using an automated deployment process, you can:</p><ul><li>create a new, <code>green</code> cluster within a release channel e.g. every week,</li><li>use <a href=https://cloud.google.com/kubernetes-engine/docs/concepts/maintenance-windows-and-exclusions#exclusions>maintenance exclusions</a> to prevent node upgrades for 30d, and</li><li>scale the <code>Fleet</code> on the old, <code>blue</code> cluster down to 0, and</li><li>use <a href=/docs/advanced/multi-cluster-allocation/>multi-cluster allocation</a> on Code Blind, which will then direct new allocations to the new <code>green</code> cluster (since <code>blue</code> has 0 desired), then</li><li>delete the old, <code>blue</code> cluster when the <code>Fleet</code> successfully scales down.</li></ul></li><li><p>(GKE Standard only) Use <a href=https://cloud.google.com/kubernetes-engine/docs/concepts/node-pool-upgrade-strategies#blue-green-upgrade-strategy>node pool blue/green upgrades</a></p></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-6f8bbe726ba7c85476067c9513fc6136>3 - Code Blind Game Server Client SDKs</h1><div class=lead>The SDKs are integration points for game servers with Code Blind itself.</div><h2 id=overview>Overview</h2><p>The client SDKs are required for a game server to work with Code Blind.</p><p>The current supported SDKs are:</p><ul><li><a href=/docs/guides/client-sdks/unreal/>Unreal Engine</a></li><li><a href=/docs/guides/client-sdks/unity/>Unity</a></li><li><a href=/docs/guides/client-sdks/cpp/>C++</a></li><li><a href=/docs/guides/client-sdks/csharp/>C#</a></li><li><a href=/docs/guides/client-sdks/nodejs/>Node.js</a></li><li><a href=/docs/guides/client-sdks/go/>Go</a></li><li><a href=/docs/guides/client-sdks/rust/>Rust</a></li><li><a href=/docs/guides/client-sdks/rest/>REST</a></li></ul><p>You can also find some externally supported SDKs in our
<a href=http://localhost:1313/docs/third-party-content/libraries-tools/#client-sdks>Third Party Content</a>.</p><p>The SDKs are relatively thin wrappers around <a href=https://grpc.io>gRPC</a> generated clients,
or an implementation of the REST API (exposed via <a href=https://github.com/grpc-ecosystem/grpc-gateway>grpc-gateway</a>),
where gRPC client generation and compilation isn&rsquo;t well supported.</p><p>They connect to a small process that Code Blind coordinates to run alongside the Game Server
in a Kubernetes <a href=https://kubernetes.io/docs/concepts/workloads/pods/pod-overview/><code>Pod</code></a>.
This means that more languages can be supported in the future with minimal effort
(but pull requests are welcome! 😊 ).</p><p>There is also <a href=/docs/guides/client-sdks/local/>local development tooling</a> for working against the SDK locally,
without having to spin up an entire Kubernetes infrastructure.</p><h2 id=connecting-to-the-sdk-server>Connecting to the SDK Server</h2><p>Starting with Code Blind 1.1.0, the port that the SDK Server listens on for incoming gRPC or HTTP requests is
configurable. This provides flexibility in cases where the default port conflicts with a port that is needed
by the game server.</p><p>Code Blind will automatically set the following environment variables on all game server containers:</p><ul><li><code>AGONES_SDK_GRPC_PORT</code>: The port where the gRPC server is listening (defaults to 9357)</li><li><code>AGONES_SDK_HTTP_PORT</code>: The port where the grpc-gateway is listening (defaults to 9358)</li></ul><p>The SDKs will automatically discover and connect to the gRPC port specified in the environment variable.</p><p>If your game server requires using a REST client, it is advised to use the port from the environment variable,
otherwise your game server will not be able to contact the SDK server if it is configured to use a non-default port.</p><h2 id=function-reference>Function Reference</h2><p>While each of the SDKs are canonical to their languages, they all have the following
functions that implement the core responsibilities of the SDK.</p><p>For language specific documentation, have a look at the respective source (linked above),
and the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>examples</a>.</p><p>Calling any of state changing functions mentioned below does not guarantee that GameServer Custom Resource object would actually change its state right after the call. For instance, it could be moved to the <code>Shutdown</code> state elsewhere (for example, when a fleet scales down), which leads to no changes in <code>GameServer</code> object. You can verify the result of this call by waiting for the desired state in a callback to WatchGameServer() function.</p><p>Functions which changes GameServer state or settings are:</p><ol><li>Ready()</li><li>Shutdown()</li><li>SetLabel()</li><li>SetAnnotation()</li><li>Allocate()</li><li>Reserve()</li><li>Alpha().SetCapacity()</li><li>Alpha().PlayerConnect()</li><li>Alpha().PlayerDisconnect()</li><li>Alpha().SetCounterCount()</li><li>Alpha().IncrementCounter()</li><li>Alpha().DecrementCounter()</li><li>Alpha().SetCounterCapacity()</li><li>Alpha().AppendListValue()</li><li>Alpha().DeleteListValue()</li><li>Alpha().SetListCapacity()</li></ol><h3 id=lifecycle-management>Lifecycle Management</h3><h4 id=ready>Ready()</h4><p>This tells Code Blind that the Game Server is ready to take player connections.
Once a Game Server has specified that it is <code>Ready</code>, then the Kubernetes
GameServer record will be moved to the <code>Ready</code> state, and the details
for its public address and connection port will be populated.</p><p>While Code Blind prefers that <code>Shutdown()</code> is run once a game has completed to delete the <code>GameServer</code> instance,
if you want or need to move an <code>Allocated</code> <code>GameServer</code> back to <code>Ready</code> to be reused, you can call this SDK method again to do
this.</p><h4 id=health>Health()</h4><p>This sends a single ping to designate that the Game Server is alive and
healthy. Failure to send pings within the configured thresholds will result
in the GameServer being marked as <code>Unhealthy</code>.</p><p>See the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>gameserver.yaml</a> for all health checking
configurations.</p><h4 id=reserveseconds>Reserve(seconds)</h4><p>With some matchmaking scenarios and systems it is important to be able to ensure that a <code>GameServer</code> is unable to be deleted,
but doesn&rsquo;t trigger a FleetAutoscaler scale up. This is where <code>Reserve(seconds)</code> is useful.</p><p><code>Reserve(seconds)</code> will move the <code>GameServer</code> into the Reserved state for the specified number of seconds (0 is forever), and then it will be
moved back to <code>Ready</code> state. While in <code>Reserved</code> state, the <code>GameServer</code> will not be deleted on scale down or <code>Fleet</code> update,
and also it could not be Allocated using <a href=http://localhost:1313/docs/reference/gameserverallocation/>GameServerAllocation</a>.</p><p>This is often used when a game server process must register itself with an external system, such as a matchmaker,
that requires it to designate itself as available for a game session for a certain period. Once a game session has started,
it should call <code>SDK.Allocate()</code> to designate that players are currently active on it.</p><p>Calling other state changing SDK commands such as <code>Ready</code> or <code>Allocate</code> will turn off the timer to reset the <code>GameServer</code> back
to the <code>Ready</code> state or to promote it to an <code>Allocated</code> state accordingly.</p><h4 id=allocate>Allocate()</h4><p>With some matchmakers and game matching strategies, it can be important for game servers to mark themselves as <code>Allocated</code>.
For those scenarios, this SDK functionality exists.</p><p>There is a chance that GameServer does not actually become <code>Allocated</code> after this call. Please refer to the general note in <a href=/docs/guides/client-sdks/#function-reference>Function Reference</a> above.</p><p>The <code>agones.dev/last-allocated</code> annotation will be set on the GameServer to an RFC3339 formatted timestamp of the time of allocation, even if the GameServer was already in an <code>Allocated</code> state.</p><p>Note that if using <code>SDK.Allocate()</code> in combination with <a href=http://localhost:1313/docs/reference/gameserverallocation/>GameServerAllocation</a>s, it&rsquo;s possible for the <code>agones.dev/last-allocated</code> timestamp to move backwards if clocks are not synchronized between the Code Blind controller and the GameServer pod.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>Using a <a href=http://localhost:1313/docs/reference/gameserverallocation/>GameServerAllocation</a> is preferred in all other scenarios,
as it gives Code Blind control over how packed <code>GameServers</code> are scheduled within a cluster, whereas with <code>Allocate()</code> you
relinquish control to an external service which likely doesn&rsquo;t have as much information as Code Blind.</div><h4 id=shutdown>Shutdown()</h4><p>This tells Code Blind to shut down the currently running game server. The GameServer state will be set <code>Shutdown</code> and the
backing Pod will be Terminated.</p><p>It&rsquo;s worth reading the <a href=https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#pod-termination>Termination of Pods</a>
Kubernetes documentation, to understand the termination process, and the related configuration options.</p><p>As a rule of thumb, implement a graceful shutdown in your game sever process when it receives the TERM signal
from Kubernetes when the backing Pod goes into Termination state.</p><p>Be aware that if you use a variation of <code>System.exit(0)</code> after calling SDK.Shutdown(), your game server container may
restart for a brief period, inline with our <a href=http://localhost:1313/docs/guides/health-checking/#health-failure-strategy>Health Checking</a> policies.</p><p>If the SDK server receives a TERM signal before calling SDK.Shutdown(),
the SDK server will stay alive for the period of the <code>terminationGracePeriodSeconds</code> until <code>SDK.Shutdown()</code> has been called.</p><h3 id=configuration-retrieval>Configuration Retrieval</h3><h4 id=gameserver>GameServer()</h4><p>This returns most of the backing GameServer configuration and Status. This can be useful
for instances where you may want to know Health check configuration, or the IP and Port
the GameServer is currently allocated to.</p><p>Since the GameServer contains an entire <a href=https://kubernetes.io/docs/concepts/workloads/pods/pod-overview/#pod-templates>PodTemplate</a>
the returned object is limited to that configuration that was deemed useful. If there are
areas that you feel are missing, please <a href=https://github.com/googleforgames/agones/issues>file an issue</a> or pull request.</p><p>The easiest way to see what is exposed, is to check
the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore><code>sdk.proto</code></a>, specifically at
the <code>message GameServer</code>.</p><p>For language specific documentation, have a look at the respective source (linked above),
and the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>examples</a>.</p><h4 id=watchgameserverfunctiongameserver>WatchGameServer(function(gameserver){&mldr;})</h4><p>This executes the passed in callback with the current <code>GameServer</code> details whenever the underlying <code>GameServer</code> configuration is updated.
This can be useful to track <code>GameServer > Status > State</code> changes, <code>metadata</code> changes, such as labels and annotations, and more.</p><p>In combination with this SDK, manipulating <a href=https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/>Annotations</a> and
<a href=https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/>Labels</a> can also be a useful way to communicate information through to running game server processes from outside those processes.
This is especially useful when combined with <code>GameServerAllocation</code> <a href=http://localhost:1313/docs/reference/gameserverallocation/>applied metadata</a>.</p><p>Since the GameServer contains an entire <a href=https://kubernetes.io/docs/concepts/workloads/pods/pod-overview/#pod-templates>PodTemplate</a>
the returned object is limited to that configuration that was deemed useful. If there are
areas that you feel are missing, please <a href=https://github.com/googleforgames/agones/issues>file an issue</a> or pull request.</p><p>The easiest way to see what is exposed, is to check
the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore><code>sdk.proto</code></a>, specifically at
the <code>message GameServer</code>.</p><p>For language specific documentation, have a look at the respective source (linked above),
and the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>examples</a>.</p><h3 id=metadata-management>Metadata Management</h3><h4 id=setlabelkey-value>SetLabel(key, value)</h4><p>This will set a <a href=https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/>Label</a> value on the backing <code>GameServer</code>
record that is stored in Kubernetes.</p><p>To maintain isolation, the <code>key</code> value is automatically prefixed with the value <strong>&ldquo;agones.dev/sdk-&rdquo;</strong>. This is done for
two main reasons:</p><ul><li>The prefix allows the developer to always know if they are accessing or reading a value that could have come, or
may be changed by the client SDK. Much like <code>private</code> vs <code>public</code> scope in a programming language, the Code Blind
SDK only gives you access to write to part of the set of labels and annotations that exist on a GameServer.</li><li>The prefix allows for a smaller attack surface if the GameServer container gets compromised. Since the
game container is generally externally exposed, and the Code Blind project doesn&rsquo;t control the binary that is
run within it, limiting exposure if the game server becomes compromised is worth the extra
development friction that comes with having this prefix in place.</li></ul><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4><p>There are limits on the characters that be used for label keys and values. Details are <a href=https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#syntax-and-character-set>here</a>.</p><p>You will need to take them into account when combined with the label prefix above.</p></div><p>Setting <code>GameServer</code> labels can be useful if you want information from your running game server process to be
observable or searchable through the Kubernetes API.</p><h4 id=setannotationkey-value>SetAnnotation(key, value)</h4><p>This will set an <a href=https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/>Annotation</a> value
on the backing <code>GameServer</code> record that is stored in Kubernetes.</p><p>To maintain isolation, the <code>key</code> value is automatically prefixed with <strong>&ldquo;agones.dev/sdk-&rdquo;</strong> for the same reasons as
in <a href=/docs/guides/client-sdks/#setlabelkey-value>SetLabel(&mldr;)</a> above. The isolation is also important as Code Blind uses annotations on the
<code>GameServer</code> as part of its internal processing.</p><p>Setting <code>GameServer</code> annotations can be useful if you want information from your running game server process to be
observable through the Kubernetes API.</p><h3 id=counters-and-lists>Counters And Lists</h3><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4><p>The Counters And Lists feature is currently <strong><a href=http://localhost:1313/docs/guides/feature-stages/#alpha>Alpha</a></strong>,
not enabled by default, and may change in the future.</p><p>Use the FeatureGate <code>CountsAndLists</code>
to enable and test this feature.</p><p>See the <a href=http://localhost:1313/docs/guides/feature-stages/#feature-gates>Feature Gate documentation</a> for details on how to enable features.</p></div><p>The <code>Counters</code> and <code>Lists</code> features in the SDK offer a flexible configuration for tracking various entities like
players, rooms, and sessions.</p><p>Declared keys and default values for Counters and Lists are specified in
<a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerSpec><code>GameServer.Spec.Counters</code> and <code>GameServer.Spec.Lists</code></a> respectively.</p><p>Modified Counter and List values and capacities will be updated
in <a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerStatus><code>GameServer.Status.Counters</code> and <code>GameServer.Status.Lists</code></a> respectively.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4><p>The SDK batches mutation operations every 1 second for performance reasons. However, changes made and subsequently
retrieved through the SDK will be atomically accurate through the SDK, as those values are tracked within the
SDK Server sidecar process.</p><p>Changes made through Allocation or the Kubernetes API to
<a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerSpec><code>GameServer.Spec.Counters</code> and <code>GameServer.Spec.Lists</code></a>
will be eventually consistent when being retrieved through the SDK.</p><p>Since the Code Blind SDK server batches the update operations of
<a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerStatus><code>GameServer.Status.Counters</code> and <code>GameServer.Status.Lists</code></a>
asynchronously, this means that if you update
<a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerStatus><code>GameServer.status</code></a> values
through both the SDK and the Allocation/Kubernetes API, the batch processing may silently truncate some of those values
to the capacity of that Counter or List.</p></div><h4 id=counters>Counters</h4><p>All functions will return an error if the specified <code>key</code> is not predefined in the
<a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerSpec><code>GameServer.Spec.Counters</code></a> resource configuration.</p><p><strong>Note:</strong> For Counters, the default setting for the capacity is preset to 1000. It is recommended to avoid configuring the capacity to max(int64), as doing so could cause problems with <a href=https://github.com/googleforgames/agones/issues/3636>JSON Patch operations</a>.</p><h5 id=alphagetcountercountkey>Alpha().GetCounterCount(key)</h5><p>This function retrieves either the <a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerStatus><code>GameServer.Status.Counters[key].Count</code></a> or the SDK awaiting-batch
value for a given key, whichever is most up to date.</p><h5 id=alphasetcountercountkey-amount>Alpha().SetCounterCount(key, amount)</h5><p>This function sets the value of <a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerStatus><code>GameServer.Status.Counters[key].Count</code></a> for the given key to the
passed in amount. This operation overwrites any previous values and the new value cannot exceed the Counter&rsquo;s capacity.</p><h5 id=alphaincrementcounterkey-amount>Alpha().IncrementCounter(key, amount)</h5><p>This function increments <a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerStatus><code>GameServer.Status.Counters[key].Count</code></a> for the given key by the passed in
non-negative amount. The function returns an error if the Counter is already at capacity (at time of operation),
indicating no increment will occur.</p><h5 id=alphadecrementcounterkey-amount>Alpha().DecrementCounter(key, amount)</h5><p>This function decreases <a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerStatus><code>GameServer.Status.Counters[key].Count</code></a> for the given key by the passed in
non-negative amount. It returns an error if the Counter&rsquo;s count is already at zero.</p><h5 id=alphasetcountercapacitykey-amount>Alpha().SetCounterCapacity(key, amount)</h5><p>This function sets the maximum <a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerStatus><code>GameServer.Status.Counters[key].Capacity</code></a> for the given key by the
passed in non-negative amount. A capacity value of 0 indicates no capacity limit.</p><h5 id=alphagetcountercapacitykey>Alpha().GetCounterCapacity(key)</h5><p>This function retrieves either the <a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerStatus><code>GameServer.Status.Counters[key].Capacity</code></a> or the SDK
awaiting-batch value for the given key, whichever is most up to date.</p><h4 id=lists>Lists</h4><p>All functions will return an error if the specified <code>key</code> is not predefined in the
<a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerSpec><code>GameServer.Spec.Lists</code></a> resource configuration.</p><h5 id=alphaappendlistvaluekey-value>Alpha().AppendListValue(key, value)</h5><p>This function appends the specified string value to the List
in <a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerStatus><code>GameServer.Status.Lists[key].Values</code></a>.</p><p>An error is returned if the string already exists in the list or if the list is at capacity.</p><h5 id=alphadeletelistvaluekey-value>Alpha().DeleteListValue(key, value)</h5><p>This function removes the specified string value from the List
in <a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerStatus><code>GameServer.Status.Lists[key].Values</code></a>.</p><p>An error is returned if the string does not exist in the list.</p><h5 id=alphasetlistcapacitykey-amount>Alpha().SetListCapacity(key, amount)</h5><p>This function sets the maximum capacity for the List at <a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerStatus><code>GameServer.Status.Lists[key].Capacity</code></a>.</p><p>The capacity value is required to be between 0 and 1000.</p><h5 id=alphagetlistcapacitykey>Alpha().GetListCapacity(key)</h5><p>This function retrieves either the <a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerStatus><code>GameServer.Status.Lists[key].Capacity</code></a> or the SDK
awaiting-batch value for the given key, whichever is most up to date.</p><h5 id=alphagetlistvalueskey>Alpha().GetListValues(key)</h5><p>This function retrieves either the <a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerStatus><code>GameServer.Status.Lists[key].Values</code></a> or the SDK
awaiting-batch values array for the given key, whichever is most up to date.</p><h5 id=alphalistcontainskey-value>Alpha().ListContains(key, value)</h5><p>Convenience function, which returns if the specific string value exists in the results
of <a href=/docs/guides/client-sdks/#alphagetlistvalueskey><code>Alpha().GetListValues(key)</code></a>.</p><h5 id=alphagetlistlengthkey>Alpha().GetListLength(key)</h5><p>Convenience function, which retrieves the length of the results of <a href=/docs/guides/client-sdks/#alphagetlistvalueskey><code>Alpha().GetListValues(key)</code></a>.</p><h3 id=player-tracking>Player Tracking</h3><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4><p>The Player Tracking feature is currently <strong><a href=http://localhost:1313/docs/guides/feature-stages/#alpha>Alpha</a></strong>,
not enabled by default, and may change in the future.</p><p>Use the FeatureGate <code>PlayerTracking</code>
to enable and test this feature.</p><p>See the <a href=http://localhost:1313/docs/guides/feature-stages/#feature-gates>Feature Gate documentation</a> for details on how to enable features.</p></div><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4><a href=/#counters-and-lists>Counters and Lists</a> will eventually replace the Alpha functionality of Player Tracking, which will subsequently be
removed from Code Blind. If you are currently using this Alpha feature, we would love for you to test (and ideally migrate
to!) this new functionality to ensure it will meet all your needs.</div><h4 id=alphaplayerconnectplayerid>Alpha().PlayerConnect(playerID)</h4><p>This function increases the SDK’s stored player count by one, and appends this playerID to
<code>GameServer.Status.Players.IDs</code>.</p><p><a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.PlayerStatus><code>GameServer.Status.Players.Count</code> and <code>GameServer.Status.Players.IDs</code></a>
are then set to update the player count and id list a second from now,
unless there is already an update pending, in which case the update joins that batch operation.</p><p><code>PlayerConnect()</code> returns true and adds the playerID to the list of playerIDs if this playerID was not already in the
list of connected playerIDs.</p><p>If the playerID exists within the list of connected playerIDs, <code>PlayerConnect()</code> will return false, and the list of
connected playerIDs will be left unchanged.</p><p>An error will be returned if the playerID was not already in the list of connected playerIDs but the player capacity for
the server has been reached. The playerID will not be added to the list of playerIDs.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>Do not use this method if you are manually managing <code>GameServer.Status.Players.IDs</code> and <code>GameServer.Status.Players.Count</code>
through the Kubernetes API, as indeterminate results will occur.</div><h4 id=alphaplayerdisconnectplayerid>Alpha().PlayerDisconnect(playerID)</h4><p>This function decreases the SDK’s stored player count by one, and removes the playerID from
<a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.PlayerStatus><code>GameServer.Status.Players.IDs</code></a>.</p><p><code>GameServer.Status.Players.Count</code> and <code>GameServer.Status.Players.IDs</code> are then set to
update the player count and id list a second from now,
unless there is already an update pending, in which case the update joins that batch operation.</p><p><code>PlayerDisconnect()</code> will return true and remove the supplied playerID from the list of connected playerIDs if the
playerID value exists within the list.</p><p>If the playerID was not in the list of connected playerIDs, the call will return false, and the connected playerID list
will be left unchanged.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>Do not use this method if you are manually managing <code>GameServer.Status.Players.IDs</code> and <code>GameServer.Status.Players.Count</code>
through the Kubernetes API, as indeterminate results will occur.</div><h4 id=alphasetplayercapacitycount>Alpha().SetPlayerCapacity(count)</h4><p>Update the <a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.PlayerStatus><code>GameServer.Status.Players.Capacity</code></a> value with a new capacity.</p><h4 id=alphagetplayercapacity>Alpha().GetPlayerCapacity()</h4><p>This function retrieves the current player capacity. This is always accurate from what has been set through this SDK,
even if the value has yet to be updated on the GameServer status resource.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>If <code>GameServer.Status.Players.Capacity</code> is set manually through the Kubernetes API, use <code>SDK.GameServer()</code> or
<code>SDK.WatchGameServer()</code> instead to view this value.</div><h4 id=alphagetplayercount>Alpha().GetPlayerCount()</h4><p>This function retrieves the current player count.
This is always accurate from what has been set through this SDK, even if the value has yet to be updated on the
GameServer status resource.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>If <code>GameServer.Status.Players.IDs</code> is set manually through the Kubernetes API, use SDK.GameServer()
or SDK.WatchGameServer() instead to retrieve the current player count.</div><h4 id=alphaisplayerconnectedplayerid>Alpha().IsPlayerConnected(playerID)</h4><p>This function returns if the playerID is currently connected to the GameServer. This is always accurate from what has
been set through this SDK,
even if the value has yet to be updated on the GameServer status resource.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>If <code>GameServer.Status.Players.IDs</code> is set manually through the Kubernetes API, use SDK.GameServer()
or SDK.WatchGameServer() instead to determine connected status.</div><h4 id=alphagetconnectedplayers>Alpha().GetConnectedPlayers()</h4><p>This function returns the list of the currently connected player ids. This is always accurate from what has been set
through this SDK, even if the value has yet to be updated on the GameServer status resource.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>If <code>GameServer.Status.Players.IDs</code> is set manually through the Kubernetes API, use SDK.GameServer()
or SDK.WatchGameServer() instead to list the connected players.</div><h2 id=writing-your-own-sdk>Writing your own SDK</h2><p>If there isn&rsquo;t an SDK for the language and platform you are looking for, you have several options:</p><h3 id=grpc-client-generation>gRPC Client Generation</h3><p>If client generation is well supported by <a href=https://grpc.io/docs/>gRPC</a>, then generate client(s) from
the proto files found in the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore><code>proto/sdk</code></a>,
directory and look at the current
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>sdks</a> to see how the wrappers are
implemented to make interaction with the SDK server simpler for the user.</p><h3 id=rest-api-implementation>REST API Implementation</h3><p>If client generation is not well supported by gRPC, or if there are other complicating factors, implement the SDK through
the <a href=/docs/guides/client-sdks/rest/>REST</a> HTTP+JSON interface. This could be written by hand, or potentially generated from
the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>Swagger/OpenAPI Specifications</a>.</p><p>Finally, if you build something that would be usable by the community, please submit a pull request!</p><h2 id=sdk-conformance-test>SDK Conformance Test</h2><p>There is a tool <code>SDK server Conformance</code> checker which will run Local SDK server and record all requests your client is performing.</p><p>In order to check that SDK is working properly you should write simple SDK test client which would use all methods of your SDK.</p><p>Also to test that SDK client is receiving valid Gameserver data, your binary should set the same <code>Label</code> value as creation timestamp which you will receive as a result of GameServer() call and <code>Annotation</code> value same as gameserver UID received by Watch gameserver callback.</p><p>Complete list of endpoints which should be called by your test client is the following:</p><pre tabindex=0><code>ready,allocate,setlabel,setannotation,gameserver,health,shutdown,watch
</code></pre><p>In order to run this test SDK server locally use:</p><pre tabindex=0><code>SECONDS=30 make run-sdk-conformance-local
</code></pre><p>Docker container would timeout in 30 seconds and give your the comparison of received requests and expected requests</p><p>For instance you could run Go SDK conformance test and see how the process goes:</p><pre tabindex=0><code>SDK_FOLDER=go make run-sdk-conformance-test
</code></pre><p>In order to add test client for your SDK, write <code>sdktest.sh</code> and <code>Dockerfile</code>. Refer to
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>Golang SDK Conformance testing directory structure</a>.</p><h2 id=building-the-tools>Building the Tools</h2><p>If you wish to build the binaries from source
the <code>make</code> target <code>build-agones-sdk-binary</code> will compile the necessary binaries
for all supported operating systems (64 bit windows, linux and osx).</p><p>You can find the binaries in the <code>bin</code> folder in
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>`cmd/sdk-server`</a>
once compilation is complete.</p><p>See
<a href=https://github.com/josephbarnett/codeblind.ai/blob/main/ target=_blank data-proofer-ignore>Developing, Testing and Building Code Blind</a> for more details.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-d9110a0f360a4714db35abf6ce38a140>3.1 - Unreal Engine Game Server Client Plugin</h1><div class=lead>This is the Unreal Engine Code Blind Game Server Client Plugin.</div><p>Check the <a href=/docs/guides/client-sdks/>Client SDK Documentation</a> for more details on each of the SDK functions and how to run the SDK locally.</p><h2 id=sdk-functionality>SDK Functionality</h2><table><thead><tr><th>Area</th><th>Action</th><th>Implemented</th></tr></thead><tbody><tr><td>Lifecycle</td><td>Ready</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Health</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Reserve</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Allocate</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Shutdown</td><td>✔️</td></tr><tr><td>Configuration</td><td>GameServer</td><td>✔️</td></tr><tr><td>Configuration</td><td>Watch</td><td>✔️</td></tr><tr><td>Metadata</td><td>SetAnnotation</td><td>✔️</td></tr><tr><td>Metadata</td><td>SetLabel</td><td>✔️</td></tr><tr><td>Counters</td><td>GetCounterCount</td><td>❌</td></tr><tr><td>Counters</td><td>SetCounterCount</td><td>❌</td></tr><tr><td>Counters</td><td>IncrementCounter</td><td>❌</td></tr><tr><td>Counters</td><td>DecrementCounter</td><td>❌</td></tr><tr><td>Counters</td><td>SetCounterCapacity</td><td>❌</td></tr><tr><td>Counters</td><td>GetCounterCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>AppendListValue</td><td>❌</td></tr><tr><td>Lists</td><td>DeleteListValue</td><td>❌</td></tr><tr><td>Lists</td><td>SetListCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>GetListCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>ListContains</td><td>❌</td></tr><tr><td>Lists</td><td>GetListLength</td><td>❌</td></tr><tr><td>Lists</td><td>GetListValues</td><td>❌</td></tr><tr><td>Player Tracking</td><td>GetConnectedPlayers</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>GetPlayerCapacity</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>GetPlayerCount</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>IsPlayerConnected</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>PlayerConnect</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>PlayerDisconnect</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>SetPlayerCapacity</td><td>✔️</td></tr></tbody></table><p>Additional methods have been added for ease of use (both of which are enabled by default):</p><ul><li>Connect<ul><li>will call <code>/gameserver</code> till a succesful response is returned and then call <code>/ready</code>.</li><li>disabled by setting <code>bDisableAutoConnect</code> to <code>true</code>.</li><li>An event is broadcast with the <code>GameServer</code> data once the <code>/gameserver</code> call succeeds.</li></ul></li><li>Health<ul><li>calls <code>/health</code> endpoint on supplied rate</li><li>enabled by default with 10 second rate</li><li>disabled by default by setting <code>HealthRateSeconds</code> to <code>0</code>.</li></ul></li></ul><p>Both of the above are automatically kicked off in the <code>BeginPlay</code> of the component.</p><h2 id=download>Download</h2><p>Download the source from the <a href=https://github.com/googleforgames/agones/releases>Releases Page</a>
or
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>directly from GitHub</a>.</p><h2 id=resources>Resources</h2><p><a href=https://www.unrealengine.com/>Unreal</a> is a <a href=https://en.wikipedia.org/wiki/Game_engine>game engine</a> that is used by anyone from hobbyists all the way through to huge AAA Game Stuidos.</p><p>With this in mind there is a vast amount to learn to run a production game using Unreal, even before you get to learning how it integrates with Code Blind. If you want to kick the tires with a starter project you will probably be fine with one of the starter projects out of the box.</p><p>However as your Unreal/Code Blind project gets more advanced you will want to understand more about the engine itself and how it can be used to integrate with this project. There will be different ways of interacting via in Play In Editor (PIE) versus running as an actual dedicated game server packaged into a container.</p><p>There are few helpful links for latest Unreal Engine 5:</p><ul><li><a href=https://docs.unrealengine.com/en-US/>UE5 Documentation Site</a></li><li><a href=https://docs.unrealengine.com/en-US/setting-up-dedicated-servers-in-unreal-engine/>UE5 Dedicated Servers</a><ul><li>useful guide to getting started with dedicated servers in Unreal</li></ul></li><li><a href=https://docs.unrealengine.com/en-US/game-mode-and-game-state-in-unreal-engine/>UE5 Game Mode and Game State</a></li><li><a href=https://docs.unrealengine.com/en-US/API/Runtime/Engine/GameFramework/AGameMode/>UE5 Game Mode API Reference</a><ul><li>useful for hooking up calls to Code Blind</li></ul></li><li><a href=https://docs.unrealengine.com/en-US/API/Runtime/Engine/GameFramework/AGameSession/>UE5 Game Session API Reference</a><ul><li>as above there are hooks in Game Session that can be used to call into Code Blind</li></ul></li><li><a href=https://docs.unrealengine.com/en-US/build-operations-cooking-packaging-deploying-and-running-projects-in-unreal-engine/>UE5 Building & Packaging Games</a><ul><li>only building out Unreal game servers / clients, will also need to package into a container</li></ul></li></ul><p>If you use Unreal Engine 4, There are few helpful links for it:</p><ul><li><a href=https://docs.unrealengine.com/4.27/en-US/index.html>UE4 Documentation Site</a></li><li><a href=https://docs.unrealengine.com/4.27/en-US/Gameplay/Networking/HowTo/DedicatedServers/index.html>UE4 Dedicated Servers</a></li><li><a href=https://docs.unrealengine.com/4.27/en-US/InteractiveExperiences/Framework/GameFlow/>UE4 Game Flow</a></li><li><a href=https://docs.unrealengine.com/4.27/en-US/API/Runtime/Engine/GameFramework/AGameMode/index.html>UE4 Game Mode</a></li><li><a href=https://docs.unrealengine.com/4.27/en-US/API/Runtime/Engine/GameFramework/AGameSession/index.html>UE4 Game Session</a></li><li><a href=https://docs.unrealengine.com/4.27/en-US/Engine/Deployment/BuildOperations/index.html>UE4 Building & Packaging Games</a></li></ul><h2 id=getting-started>Getting Started</h2><p>This is a SDK inspired by the REST API to the Code Blind sidecars that allows engineers to communicate with the sidecar from either C++ or Blueprints.</p><h3 id=getting-the-code>Getting the Code</h3><p>Easiest way to get this code is to clone the repository and drop the entire plugin folder into your own <code>Plugins</code> folder. This runs the plugin as a Project plugin rather than an engine plugin.</p><p>We could however turn this into a marketplace plugin that can be retrived from the marketplace directly into the UE editor.</p><h4 id=using-c-ue5ue4>Using C++ (UE5/UE4)</h4><ul><li>Add Plugin (in your own <code>.uproject</code> file)</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>  <span style=color:#4e9a06>&#34;Plugins&#34;</span><span style=color:#a40000>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&#34;Enabled&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&#34;Name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Code Blind&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>]</span><span style=color:#a40000>,</span>
</span></span></code></pre></div><ul><li>Add Plugin (in your own <code>*.Build.cs</code>)</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#a40000>PublicDependencyModuleNames.AddRange(</span>
</span></span><span style=display:flex><span>    <span style=color:#a40000>new</span><span style=color:#000;font-weight:700>[]</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;Code Blind&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span><span style=color:#a40000>);</span>
</span></span></code></pre></div><ul><li>Add component in header</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c++ data-lang=c++><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&#34;AgonesComponent.h&#34;</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#000>UPROPERTY</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>EditAnywhere</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>BlueprintReadWrite</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>UAgonesComponent</span><span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>AgonesSDK</span><span style=color:#000;font-weight:700>;</span>
</span></span></code></pre></div><ul><li>Initialize component in GameMode</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c++ data-lang=c++><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&#34;AgonesComponent.h&#34;</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&#34;Classes.h&#34;</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#000>ATestGameMode</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>ATestGameMode</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>AgonesSDK</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>CreateDefaultSubobject</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>UAgonesComponent</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>TEXT</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;AgonesSDK&#34;</span><span style=color:#000;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><ul><li>Use the Code Blind component to call PlayerReady</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c++ data-lang=c++><span style=display:flex><span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>APlatformGameSession</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>PostLogin</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>APlayerController</span><span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>NewPlayer</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// Empty brances are for callbacks on success and errror.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>AgonesSDK</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>PlayerConnect</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;netspeak-player&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>{},</span> <span style=color:#000;font-weight:700>{});</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=using-blueprints-ue5>Using Blueprints (UE5)</h4><ul><li><p>Add Component to your Blueprint GameMode
<img alt=component src=../../../../images/unreal5_bp_component.png></p></li><li><p>This will automatically call <code>/health</code> every 10 seconds and once <code>/gameserver</code> calls are succesful it will call <code>/ready</code>.</p></li><li><p>Accessing other functionality of Code Blind can be done via adding a node in Blueprints.
<img alt=actions src=../../../../images/unreal5_bp_actions.png></p></li></ul><h4 id=using-blueprints-ue4>Using Blueprints (UE4)</h4><ul><li><p>Add Component to your Blueprint GameMode
<img alt=component src=../../../../images/unreal_bp_component.png></p></li><li><p>This will automatically call <code>/health</code> every 10 seconds and once <code>/gameserver</code> calls are succesful it will call <code>/ready</code>.</p></li><li><p>Accessing other functionality of Code Blind can be done via adding a node in Blueprints.
<img alt=actions src=../../../../images/unreal_bp_actions.png></p></li></ul><h2 id=configuration-options>Configuration Options</h2><p>A number of options can be altered via config files in Unreal these are supplied via <code>Game</code> configuration eg. <code>DefaultGame.ini</code>.</p><pre tabindex=0><code>[/Script/Code Blind.AgonesComponent]
HttpPort=1337
HealthRateSeconds=5.0
bDisableAutoConnect=true
</code></pre><h2 id=unreal-hooks>Unreal Hooks</h2><p>Within the Unreal <a href=https://docs.unrealengine.com/en-US/API/Runtime/Engine/GameFramework/AGameMode/index.html>GameMode</a> and <a href=https://docs.unrealengine.com/en-US/API/Runtime/Engine/GameFramework/AGameSession/index.html>GameSession</a> exist a number of useful existing
funtions that can be used to fit in with making calls out to Code Blind.</p><p>A few examples are:</p><ul><li><code>RegisterServer</code> to call <code>SetLabel</code>, <code>SetPlayerCapacity</code></li><li><code>PostLogin</code> to call <code>PlayerConnect</code></li><li><code>NotifyLogout</code> to call <code>PlayerDisconnect</code></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-cb46d2c42280b723ba5194728d8f8e48>3.2 - Unity Game Server Client SDK</h1><div class=lead>This is the Unity version of the Code Blind Game Server Client SDK.</div><p>Check the <a href=/docs/guides/client-sdks/>Client SDK Documentation</a> for more details on each of the SDK functions and how to run the SDK locally.</p><h2 id=sdk-functionality>SDK Functionality</h2><table><thead><tr><th>Area</th><th>Action</th><th>Implemented</th></tr></thead><tbody><tr><td>Lifecycle</td><td>Ready</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Health</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Reserve</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Allocate</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Shutdown</td><td>✔️</td></tr><tr><td>Configuration</td><td>GameServer</td><td>✔️</td></tr><tr><td>Configuration</td><td>Watch</td><td>✔️</td></tr><tr><td>Metadata</td><td>SetAnnotation</td><td>✔️</td></tr><tr><td>Metadata</td><td>SetLabel</td><td>✔️</td></tr><tr><td>Counters</td><td>GetCounterCount</td><td>❌</td></tr><tr><td>Counters</td><td>SetCounterCount</td><td>❌</td></tr><tr><td>Counters</td><td>IncrementCounter</td><td>❌</td></tr><tr><td>Counters</td><td>DecrementCounter</td><td>❌</td></tr><tr><td>Counters</td><td>SetCounterCapacity</td><td>❌</td></tr><tr><td>Counters</td><td>GetCounterCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>AppendListValue</td><td>❌</td></tr><tr><td>Lists</td><td>DeleteListValue</td><td>❌</td></tr><tr><td>Lists</td><td>SetListCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>GetListCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>ListContains</td><td>❌</td></tr><tr><td>Lists</td><td>GetListLength</td><td>❌</td></tr><tr><td>Lists</td><td>GetListValues</td><td>❌</td></tr><tr><td>Player Tracking</td><td>GetConnectedPlayers</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>GetPlayerCapacity</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>GetPlayerCount</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>IsPlayerConnected</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>PlayerConnect</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>PlayerDisconnect</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>SetPlayerCapacity</td><td>✔️</td></tr></tbody></table><p>Additional methods have been added for ease of use:</p><ul><li>Connect</li></ul><h2 id=installation>Installation</h2><p>The client SDK code can be manually downloaded and added to your project hierarchy.</p><p>It can also be imported into your project via the Unity Package Manager (UPM). To do that, open your project&rsquo;s <code>manifest.json</code> file, and add the following line to the dependencies section:</p><pre tabindex=0><code>{
  &#34;dependencies&#34;: {
        &#34;com.googleforgames.agones&#34;: &#34;https://github.com/googleforgames/agones.git?path=/sdks/unity&#34;,
...
</code></pre><p>If you want a specific release, the dependency can be pinned to that version. For example:</p><p><code>"com.googleforgames.agones": "https://github.com/googleforgames/agones.git?path=/sdks/unity#v1.38.0",</code></p><h2 id=download>Download</h2><p>Download the source
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>directly from GitHub</a>.</p><h2 id=prerequisites>Prerequisites</h2><ul><li>Unity >= 2018.x (.NET 4.x)</li></ul><h2 id=usage>Usage</h2><p>Import this script to your unity project and attach it to GameObject.</p><p>To begin working with the SDK, get an instance of it.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>agones</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>agonesGameObject</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GetComponent</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#000>Code</span> <span style=color:#000>Blind</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>AgonesSdk</span><span style=color:#000;font-weight:700>&gt;();</span>
</span></span></code></pre></div><p>To connect to the SDK server, either local or when running on Code Blind, run the async <code>Connect()</code> method.
This will wait for up to 30 seconds if the SDK server has not yet started and the connection cannot be made,
and will return <code>false</code> if there was an issue connecting.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>bool</span> <span style=color:#000>ok</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Connect</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><p>To mark the game server as <a href=/docs/guides/client-sdks/#ready>ready to receive player connections</a>, call the async method <code>Ready()</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>async</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>SomeMethod</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>bool</span> <span style=color:#000>ok</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Ready</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>To get the details on the <a href=/docs/guides/client-sdks/#gameserver>backing <code>GameServer</code></a> call <code>GameServer()</code>.</p><p>Will return <code>null</code> if there is an error in retrieving the <code>GameServer</code> record.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>gameserver</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GameServer</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><p>To mark the GameServer as <a href=/docs/guides/client-sdks/#reserveseconds>Reserved</a> for a duration call
<code>Reserve(TimeSpan duration)</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#000>ok</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Reserve</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>duration</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><p>To mark that the <a href=/docs/guides/client-sdks/#shutdown>game session is completed</a> and the game server should be shut down call <code>Shutdown()</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>bool</span> <span style=color:#000>ok</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Shutdown</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><p>Similarly <code>SetAnnotation(string key, string value)</code> and <code>SetLabel(string key, string value)</code> are async methods that perform an action.</p><p>And there is no need to call <code>Health()</code>, it is automatically called.</p><p>To watch when
<a href=/docs/guides/client-sdks/#watchgameserverfunctiongameserver>the backing <code>GameServer</code> configuration changes</a>
call <code>WatchGameServer(callback)</code>, where the delegate function <code>callback</code> will be executed every time the <code>GameServer</code>
configuration changes.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WatchGameServer</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>gameServer</span> <span style=color:#000;font-weight:700>=&gt;</span> <span style=color:#000>Debug</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Log</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>$&#34;Server - Watch {gameServer}&#34;</span><span style=color:#000;font-weight:700>));</span>
</span></span></code></pre></div><h2 id=player-tracking>Player Tracking</h2><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4><p>The Player Tracking feature is currently <strong><a href=http://localhost:1313/docs/guides/feature-stages/#alpha>Alpha</a></strong>,
not enabled by default, and may change in the future.</p><p>Use the FeatureGate <code>PlayerTracking</code>
to enable and test this feature.</p><p>See the <a href=http://localhost:1313/docs/guides/feature-stages/#feature-gates>Feature Gate documentation</a> for details on how to enable features.</p></div><p>To use alpha features use the AgonesAlphaSDK class.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>agones</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>agonesGameObject</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GetComponent</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#000>Code</span> <span style=color:#000>Blind</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>AgonesAlphaSdk</span><span style=color:#000;font-weight:700>&gt;();</span>
</span></span></code></pre></div><h3 id=alpha-playerconnect>Alpha: PlayerConnect</h3><p>This method increases the SDK’s stored player count by one, and appends this playerID to GameServer.Status.Players.IDs.
Returns true and adds the playerID to the list of playerIDs if the playerIDs was not already in the list of connected playerIDs.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>bool</span> <span style=color:#000>ok</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>PlayerConnect</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>playerId</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=alpha-playerdisconnect>Alpha: PlayerDisconnect</h3><p>This function decreases the SDK’s stored player count by one, and removes the playerID from GameServer.Status.Players.IDs.
Will return true and remove the supplied playerID from the list of connected playerIDs if the playerID value exists within the list.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>bool</span> <span style=color:#000>ok</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>PlayerDisconnect</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>playerId</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=alpha-setplayercapacity>Alpha: SetPlayerCapacity</h3><p>Update the <code>GameServer.Status.Players.Capacity</code> value with a new capacity.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>capacity</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>100</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>bool</span> <span style=color:#000>ok</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>SetPlayerCapacity</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>capacity</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=alpha-getplayercapacity>Alpha: GetPlayerCapacity</h3><p>This function retrieves the current player capacity <code>GameServer.Status.Players.Capacity</code>.
This is always accurate from what has been set through this SDK, even if the value has yet to be updated on the GameServer status resource.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>long</span> <span style=color:#000>capacity</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GetPlayerCapacity</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><h3 id=alpha-getplayercount>Alpha: GetPlayerCount</h3><p>Returns the current player count</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>long</span> <span style=color:#000>count</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GetPlayerCount</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><h3 id=alpha-isplayerconnected>Alpha: IsPlayerConnected</h3><p>This returns if the playerID is currently connected to the GameServer.
This is always accurate, even if the value hasn’t been updated to the GameServer status yet.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>bool</span> <span style=color:#000>isConnected</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>IsPlayerConnected</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>playerId</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=alpha-getconnectedplayers>Alpha: GetConnectedPlayers</h3><p>This returns a list of the playerIDs that are currently connected to the GameServer.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#000>List</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>&gt;</span> <span style=color:#000>players</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GetConnectedPlayers</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4><p>The following code causes deadlock. Do not use a <code>Wait</code> method with the returned Task.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>Deadlock</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Task</span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>bool</span><span style=color:#000;font-weight:700>&gt;</span> <span style=color:#000>t</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Shutdown</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#000>t</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Wait</span><span style=color:#000;font-weight:700>();</span> <span style=color:#8f5902;font-style:italic>// deadlock!!!</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div></div><h2 id=settings>Settings</h2><p>The properties for the Unity Code Blind SDK can be found in the Inspector.</p><ul><li>Health Interval Second<ul><li>Interval of the server sending a health ping to the Code Blind sidecar. (default: <code>5</code>)</li></ul></li><li>Health Enabled<ul><li>Whether the server sends a health ping to the Code Blind sidecar. (default: <code>true</code>)</li></ul></li><li>Log Enabled<ul><li>Debug Logging Enabled. Debug logging for development of this Plugin. (default: <code>false</code>)</li></ul></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-ea9cf494f21474538fa0638b52a8cb68>3.3 - C++ Game Server Client SDK</h1><div class=lead>This is the C++ version of the Code Blind Game Server Client SDK.</div><p>Check the <a href=/docs/guides/client-sdks/>Client SDK Documentation</a> for more details on each of the SDK functions and how to run the SDK locally.</p><h2 id=sdk-functionality>SDK Functionality</h2><table><thead><tr><th>Area</th><th>Action</th><th>Implemented</th></tr></thead><tbody><tr><td>Lifecycle</td><td>Ready</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Health</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Reserve</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Allocate</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Shutdown</td><td>✔️</td></tr><tr><td>Configuration</td><td>GameServer</td><td>✔️</td></tr><tr><td>Configuration</td><td>WatchGameServer</td><td>✔️</td></tr><tr><td>Metadata</td><td>SetAnnotation</td><td>✔️</td></tr><tr><td>Metadata</td><td>SetLabel</td><td>✔️</td></tr><tr><td>Counters</td><td>GetCounterCount</td><td>❌</td></tr><tr><td>Counters</td><td>SetCounterCount</td><td>❌</td></tr><tr><td>Counters</td><td>IncrementCounter</td><td>❌</td></tr><tr><td>Counters</td><td>DecrementCounter</td><td>❌</td></tr><tr><td>Counters</td><td>SetCounterCapacity</td><td>❌</td></tr><tr><td>Counters</td><td>GetCounterCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>AppendListValue</td><td>❌</td></tr><tr><td>Lists</td><td>DeleteListValue</td><td>❌</td></tr><tr><td>Lists</td><td>SetListCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>GetListCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>ListContains</td><td>❌</td></tr><tr><td>Lists</td><td>GetListLength</td><td>❌</td></tr><tr><td>Lists</td><td>GetListValues</td><td>❌</td></tr></tbody></table><h2 id=installation>Installation</h2><h3 id=download>Download</h3><p>Download the source from the <a href=https://github.com/googleforgames/agones/releases>Releases Page</a> or
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>directly from GitHub</a>.</p><h3 id=building-the-libraries-from-source>Building the Libraries from source</h3><p>CMake is used to build SDK for all supported platforms (Linux/Window/macOS).</p><h3 id=prerequisites>Prerequisites</h3><ul><li>CMake >= 3.15.0</li><li>Git</li><li>C++17 compiler</li></ul><h3 id=dependencies>Dependencies</h3><p>Code Blind SDK only depends on the <a href=https://grpc.io/>gRPC</a> library.</p><p>If CMake cannot find gRPC with find_package(), it downloads and builds gRPC.
There are some extra prerequisites for OpenSSL on Windows, see <a href=https://github.com/openssl/openssl/blob/OpenSSL_1_1_1-stable/NOTES.WIN>documentation</a>:</p><ul><li>Perl</li><li>NASM</li></ul><p>Note that OpenSSL is not used in Code Blind SDK, but it is required to have a successful build of gRPC.</p><h2 id=options>Options</h2><p>Following options are available:</p><ul><li><strong>AGONES_THIRDPARTY_INSTALL_PATH</strong> (default is CMAKE_INSTALL_PREFIX) - installation path for Code Blind prerequisites (used only if gRPC and Protobuf are not found by find_package)</li><li><strong>AGONES_ZLIB_STATIC</strong> (default is ON) - use static version of zlib for gRPC</li></ul><p>(Windows only):</p><ul><li><strong>AGONES_BUILD_THIRDPARTY_DEBUG</strong> (default is OFF) - build both debug and release versions of SDK&rsquo;s prerequisites. Option is not used if you already have built gRPC.</li><li><strong>AGONES_OPENSSL_CONFIG_STRING</strong> (default is VC-WIN64A) - arguments to configure OpenSSL build (<a href=https://github.com/openssl/openssl/blob/OpenSSL_1_1_1-stable/INSTALL>documentation</a>). Used only if OpenSSL and gRPC is built by Code Blind.</li></ul><h2 id=linux--macos>Linux / MacOS</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir -p .build
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> .build
</span></span><span style=display:flex><span>cmake .. -DCMAKE_BUILD_TYPE<span style=color:#ce5c00;font-weight:700>=</span>Release -G <span style=color:#4e9a06>&#34;Unix Makefiles&#34;</span> -DCMAKE_INSTALL_PREFIX<span style=color:#ce5c00;font-weight:700>=</span>./install
</span></span><span style=display:flex><span>cmake --build . --target install
</span></span></code></pre></div><h2 id=windows>Windows</h2><p>Building with Visual Studio:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>md .build
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> .build
</span></span><span style=display:flex><span>cmake .. -G <span style=color:#4e9a06>&#34;Visual Studio 15 2017 Win64&#34;</span> -DCMAKE_INSTALL_PREFIX<span style=color:#ce5c00;font-weight:700>=</span>./install
</span></span><span style=display:flex><span>cmake --build . --config Release --target install
</span></span></code></pre></div><p>Building with NMake</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>md .build
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> .build
</span></span><span style=display:flex><span>cmake .. -G <span style=color:#4e9a06>&#34;NMake Makefiles&#34;</span> -DCMAKE_BUILD_TYPE<span style=color:#ce5c00;font-weight:700>=</span>Release -DCMAKE_INSTALL_PREFIX<span style=color:#ce5c00;font-weight:700>=</span>./install
</span></span><span style=display:flex><span>cmake --build . --target install
</span></span></code></pre></div><p><strong>CMAKE_INSTALL_PREFIX</strong> may be skipped if it is OK to install Code Blind SDK to a default location (usually /usr/local or c:/Program Files/Code Blind).</p><p>CMake option <code>-Wno-dev</code> is specified to suppress <a href=https://cmake.org/cmake/help/v3.13/policy/CMP0048.html>CMP0048</a> deprecation warning for gRPC build.</p><p>If <strong>AGONES_ZLIB_STATIC</strong> is set to OFF, ensure that you have installed zlib. For Windows, it&rsquo;s enough to copy zlib.dll near to gameserver executable. For Linux/Mac usually no actions are needed.</p><h2 id=usage>Usage</h2><h3 id=using-sdk>Using SDK</h3><p>In CMake-based projects it&rsquo;s enough to specify a folder where SDK is installed with <code>CMAKE_PREFIX_PATH</code> and use <code>find_package(agones CONFIG REQUIRED)</code> command. For example:
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>cpp-simple</a>.
It may be useful to disable some <a href=https://github.com/protocolbuffers/protobuf/blob/master/cmake/README.md#notes-on-compiler-warnings>protobuf warnings</a> in your project.</p><h2 id=usage-1>Usage</h2><p>The C++ SDK is specifically designed to be as simple as possible, and deliberately doesn&rsquo;t include any kind
of singleton management, or threading/asynchronous processing to allow developers to manage these aspects as they deem
appropriate for their system.</p><p>We may consider these types of features in the future, depending on demand.</p><p>To begin working with the SDK, create an instance of it:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#000>agones</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>SDK</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>sdk</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>agones</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>SDK</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><p>To connect to the SDK server, either local or when running on Code Blind, run the <code>sdk->Connect()</code> method.
This will block for up to 30 seconds if the SDK server has not yet started and the connection cannot be made,
and will return <code>false</code> if there was an issue connecting.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#204a87;font-weight:700>bool</span> <span style=color:#000>ok</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>sdk</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>Connect</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><p>To send a <a href=/docs/guides/client-sdks/#health>health check</a> call <code>sdk->Health()</code>. This is a synchronous request that will
return <code>false</code> if it has failed in any way. Read <a href=/docs/guides/health-checking/>GameServer Health Checking</a> for more
details on the game server health checking strategy.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#204a87;font-weight:700>bool</span> <span style=color:#000>ok</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>sdk</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>Health</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><p>To mark the game server as <a href=/docs/guides/client-sdks/#ready>ready to receive player connections</a>, call <code>sdk->Ready()</code>.
This will return a grpc::Status object, from which we can call <code>status.ok()</code> to determine
if the function completed successfully.</p><p>For more information you can also look at the <a href=https://grpc.io/grpc/cpp/classgrpc_1_1_status.html>gRPC Status reference</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#000>grpc</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>Status</span> <span style=color:#000>status</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>sdk</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>Ready</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>status</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ok</span><span style=color:#000;font-weight:700>())</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000;font-weight:700>...</span> <span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>To mark the game server as <a href=/docs/guides/client-sdks/#allocate>allocated</a>, call <code>sdk->Allocate()</code>.
This will return a grpc::Status object, from which we can call <code>status.ok()</code> to determine
if the function completed successfully.</p><p>For more information you can also look at the <a href=https://grpc.io/grpc/cpp/classgrpc_1_1_status.html>gRPC Status reference</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#000>grpc</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>Status</span> <span style=color:#000>status</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>sdk</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>Allocate</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>status</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ok</span><span style=color:#000;font-weight:700>())</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000;font-weight:700>...</span> <span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>To mark the game server as <a href=/docs/guides/client-sdks/#reserveseconds>reserved</a>, call
<code>sdk->Reserve(seconds)</code>. This will return a grpc::Status object, from which we can call <code>status.ok()</code> to determine
if the function completed successfully.</p><p>For more information you can also look at the <a href=https://grpc.io/grpc/cpp/classgrpc_1_1_status.html>gRPC Status reference</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#000>grpc</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>Status</span> <span style=color:#000>status</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>sdk</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>Reserve</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>std</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>chrono</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>seconds</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>N</span><span style=color:#000;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>status</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ok</span><span style=color:#000;font-weight:700>())</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000;font-weight:700>...</span> <span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>To mark that the <a href=/docs/guides/client-sdks/#shutdown>game session is completed</a> and the game server should be shut down call <code>sdk->Shutdown()</code>.
This will return a grpc::Status object, from which we can call <code>status.ok()</code> to determine
if the function completed successfully.</p><p>For more information you can also look at the <a href=https://grpc.io/grpc/cpp/classgrpc_1_1_status.html>gRPC Status reference</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#000>grpc</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>Status</span> <span style=color:#000>status</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>sdk</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>Shutdown</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>status</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ok</span><span style=color:#000;font-weight:700>())</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000;font-weight:700>...</span> <span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>To <a href=/docs/guides/client-sdks/#setlabelkey-value>set a Label</a> on the backing <code>GameServer</code> call
<code>sdk->SetLabel(key, value)</code>.
This will return a grpc::Status object, from which we can call <code>status.ok()</code> to determine
if the function completed successfully.</p><p>For more information you can also look at the <a href=https://grpc.io/grpc/cpp/classgrpc_1_1_status.html>gRPC Status reference</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#000>grpc</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>Status</span> <span style=color:#000>status</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>sdk</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>SetLabel</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;test-label&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;test-value&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>status</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ok</span><span style=color:#000;font-weight:700>())</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000;font-weight:700>...</span> <span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>To <a href=/docs/guides/client-sdks/#setannotationkey-value>set an Annotation</a> on the backing <code>GameServer</code> call
<code>sdk->SetAnnotation(key, value)</code>.
This will return a grpc::Status object, from which we can call <code>status.ok()</code> to determine
if the function completed successfully.</p><p>For more information you can also look at the <a href=https://grpc.io/grpc/cpp/classgrpc_1_1_status.html>gRPC Status reference</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#000>status</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>sdk</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>SetAnnotation</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;test-annotation&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;test value&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>status</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ok</span><span style=color:#000;font-weight:700>())</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000;font-weight:700>...</span> <span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>To get the details on the <a href=/docs/guides/client-sdks/#gameserver>backing <code>GameServer</code></a> call <code>sdk->GameServer(&amp;gameserver)</code>,
passing in a <code>agones::dev::sdk::GameServer*</code> to push the results of the <code>GameServer</code> configuration into.</p><p>This function will return a grpc::Status object, from which we can call <code>status.ok()</code> to determine
if the function completed successfully.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#000>agones</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>dev</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>sdk</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>GameServer</span> <span style=color:#000>gameserver</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>grpc</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>Status</span> <span style=color:#000>status</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>sdk</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>GameServer</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>gameserver</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>status</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ok</span><span style=color:#000;font-weight:700>())</span> <span style=color:#000;font-weight:700>{...}</span>
</span></span></code></pre></div><p>To get <a href=/docs/guides/client-sdks/#watchgameserverfunctiongameserver>updates on the backing <code>GameServer</code></a> as they happen,
call <code>sdk->WatchGameServer([](const agones::dev::sdk::GameServer& gameserver){...})</code>.</p><p>This will call the passed in <code>std::function</code>
synchronously (this is a blocking function, so you may want to run it in its own thread) whenever the backing <code>GameServer</code>
is updated.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#000>sdk</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>WatchGameServer</span><span style=color:#000;font-weight:700>([](</span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>agones</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>dev</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>sdk</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>GameServer</span><span style=color:#ce5c00;font-weight:700>&amp;</span> <span style=color:#000>gameserver</span><span style=color:#000;font-weight:700>){</span>
</span></span><span style=display:flex><span>  <span style=color:#000>std</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>cout</span> <span style=color:#ce5c00;font-weight:700>&lt;&lt;</span> <span style=color:#4e9a06>&#34;GameServer Update:</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span>                                 <span style=color:#8f5902;font-style:italic>//
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>            <span style=color:#ce5c00;font-weight:700>&lt;&lt;</span> <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>\t</span><span style=color:#4e9a06>name: &#34;</span> <span style=color:#ce5c00;font-weight:700>&lt;&lt;</span> <span style=color:#000>gameserver</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>object_meta</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>name</span><span style=color:#000;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>&lt;&lt;</span> <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span>  <span style=color:#8f5902;font-style:italic>//
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>            <span style=color:#ce5c00;font-weight:700>&lt;&lt;</span> <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>\t</span><span style=color:#4e9a06>state: &#34;</span> <span style=color:#ce5c00;font-weight:700>&lt;&lt;</span> <span style=color:#000>gameserver</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>status</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>state</span><span style=color:#000;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>&lt;&lt;</span> <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#ce5c00;font-weight:700>&lt;&lt;</span> <span style=color:#000>std</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>flush</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>});</span>
</span></span></code></pre></div><h2 id=next-steps>Next Steps</h2><ul><li>Read the <a href=/docs/guides/client-sdks/>SDK Overview</a> to review all SDK functionality</li><li>Look at the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>C++ example for a full build template</a>.</li><li>Check out
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>sdk.h</a>.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-63f37ca64d7de9cc29ac4ba30acbcd56>3.4 - Go Game Server Client SDK</h1><div class=lead>This is the Go version of the Code Blind Game Server Client SDK.</div><p>Check the <a href=/docs/guides/client-sdks/>Client SDK Documentation</a> for more details on each of the SDK functions and how to run the SDK locally.</p><h2 id=sdk-functionality>SDK Functionality</h2><table><thead><tr><th>Area</th><th>Action</th><th>Implemented</th></tr></thead><tbody><tr><td>Lifecycle</td><td>Ready</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Health</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Reserve</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Allocate</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Shutdown</td><td>✔️</td></tr><tr><td>Configuration</td><td>GameServer</td><td>✔️</td></tr><tr><td>Configuration</td><td>Watch</td><td>✔️</td></tr><tr><td>Metadata</td><td>SetAnnotation</td><td>✔️</td></tr><tr><td>Metadata</td><td>SetLabel</td><td>✔️</td></tr><tr><td>Counters</td><td>GetCounterCount</td><td>✔️</td></tr><tr><td>Counters</td><td>SetCounterCount</td><td>✔️</td></tr><tr><td>Counters</td><td>IncrementCounter</td><td>✔️</td></tr><tr><td>Counters</td><td>DecrementCounter</td><td>✔️</td></tr><tr><td>Counters</td><td>SetCounterCapacity</td><td>✔️</td></tr><tr><td>Counters</td><td>GetCounterCapacity</td><td>✔️</td></tr><tr><td>Lists</td><td>AppendListValue</td><td>✔️</td></tr><tr><td>Lists</td><td>DeleteListValue</td><td>✔️</td></tr><tr><td>Lists</td><td>SetListCapacity</td><td>✔️</td></tr><tr><td>Lists</td><td>GetListCapacity</td><td>✔️</td></tr><tr><td>Lists</td><td>ListContains</td><td>✔️</td></tr><tr><td>Lists</td><td>GetListLength</td><td>✔️</td></tr><tr><td>Lists</td><td>GetListValues</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>GetConnectedPlayers</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>GetPlayerCapacity</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>GetPlayerCount</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>IsPlayerConnected</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>PlayerConnect</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>PlayerDisconnect</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>SetPlayerCapacity</td><td>✔️</td></tr></tbody></table><h2 id=installation>Installation</h2><p><code>go get</code> the source,
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>directly from GitHub</a></p><h2 id=usage>Usage</h2><p>Review the <a href=https://pkg.go.dev/agones.dev/agones/sdks/go>GoDoc</a> for usage instructions</p></div><div class=td-content style=page-break-before:always><h1 id=pg-7bcee3a1d527cbfefbcd4e6a271adb91>3.5 - C# Game Server Client SDK</h1><div class=lead>This is the C# version of the Code Blind Game Server Client SDK.</div><p>Check the <a href=/docs/guides/client-sdks/>Client SDK Documentation</a> for more details on each of the SDK functions and how to run the SDK locally.</p><h2 id=sdk-functionality>SDK Functionality</h2><table><thead><tr><th>Area</th><th>Action</th><th>Implemented</th></tr></thead><tbody><tr><td>Lifecycle</td><td>Ready</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Health</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Reserve</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Allocate</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Shutdown</td><td>✔️</td></tr><tr><td>Configuration</td><td>GetGameServer</td><td>✔️</td></tr><tr><td>Configuration</td><td>WatchGameServer</td><td>✔️</td></tr><tr><td>Metadata</td><td>SetAnnotation</td><td>✔️</td></tr><tr><td>Metadata</td><td>SetLabel</td><td>✔️</td></tr><tr><td>Counters</td><td>GetCounterCount</td><td>❌</td></tr><tr><td>Counters</td><td>SetCounterCount</td><td>❌</td></tr><tr><td>Counters</td><td>IncrementCounter</td><td>❌</td></tr><tr><td>Counters</td><td>DecrementCounter</td><td>❌</td></tr><tr><td>Counters</td><td>SetCounterCapacity</td><td>❌</td></tr><tr><td>Counters</td><td>GetCounterCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>AppendListValue</td><td>❌</td></tr><tr><td>Lists</td><td>DeleteListValue</td><td>❌</td></tr><tr><td>Lists</td><td>SetListCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>GetListCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>ListContains</td><td>❌</td></tr><tr><td>Lists</td><td>GetListLength</td><td>❌</td></tr><tr><td>Lists</td><td>GetListValues</td><td>❌</td></tr><tr><td>Player Tracking</td><td>GetConnectedPlayers</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>GetPlayerCapacity</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>GetPlayerCount</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>IsPlayerConnected</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>PlayerConnect</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>PlayerDisconnect</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>SetPlayerCapacity</td><td>✔️</td></tr></tbody></table><h2 id=download>Download</h2><p>Download the source
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>directly from GitHub</a>.</p><h2 id=install-using-nuget>Install using NuGet</h2><ul><li>Download the nuget package <a href=https://www.nuget.org/packages/AgonesSDK/>directly</a></li><li>Install the latest version using the Package Manager: <code>Install-Package AgonesSDK</code></li><li>Install the latest version using the .NET CLI: <code>dotnet add package AgonesSDK</code></li></ul><p>To select a specific version, append <code>--version</code>, for example: <code>--version 1.8.0</code> to either commands.</p><h2 id=prerequisites>Prerequisites</h2><ul><li>.Net Standard 2.0 compliant framework.</li></ul><h2 id=usage>Usage</h2><p>Reference the SDK in your project & create a new instance of the SDK wrapper:</p><h3 id=initialization>Initialization</h3><p>To use the AgonesSDK, you will need to import the namespace by adding <code>using Code Blind;</code> at the beginning of your relevant files.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>agones</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>AgonesSDK</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><h3 id=connection>Connection</h3><p>To connect to the SDK server, either locally or when running on Code Blind, run the <code>ConnectAsync()</code> method.
This will wait for up to 30 seconds if the SDK server has not yet started and the connection cannot be made,
and will return <code>false</code> if there was an issue connecting.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>bool</span> <span style=color:#000>ok</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ConnectAsync</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><h3 id=ready>Ready</h3><p>To mark the game server as <a href=/docs/guides/client-sdks/#ready>ready to receive player connections</a>, call the async method <code>ReadyAsync()</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>async</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>SomeMethod</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>status</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ReadyAsync</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=health>Health</h3><p>To send <code>Health</code> pings, call the async method <code>HealthAsync()</code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HealthAsync</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><h3 id=getgameserver>GetGameServer</h3><p>To get the details on the <a href=/docs/guides/client-sdks/#gameserver>backing <code>GameServer</code></a> call <code>GetGameServerAsync()</code>.</p><p>Will return <code>null</code> if there is an error in retrieving the <code>GameServer</code> record.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>gameserver</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GetGameServerAsync</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><h3 id=reserve>Reserve</h3><p>To mark the GameServer as <a href=/docs/guides/client-sdks/#reserveseconds>Reserved</a> for a duration call
<code>ReserveAsync(long duration)</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>long</span> <span style=color:#000>duration</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>30</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>status</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ReserveAsync</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>duration</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=shutdown>ShutDown</h3><p>To mark that the <a href=/docs/guides/client-sdks/#shutdown>game session is completed</a> and the game server should be shut down call <code>ShutdownAsync()</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>status</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ShutdownAsync</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><h3 id=setannotation---setlabel>SetAnnotation & SetLabel</h3><p>Similarly <code>SetAnnotation(string key, string value)</code> and <code>SetLabel(string key, string value)</code> are async methods that perform an action & return a <code>Status</code> object.</p><h3 id=watchgameserver>WatchGameServer</h3><p>To watch when
<a href=/docs/guides/client-sdks/#watchgameserverfunctiongameserver>the backing <code>GameServer</code> configuration changes</a>
call <code>WatchGameServer(callback)</code>, where the delegate function <code>callback</code> of type <code>Action&lt;GameServer></code> will be executed every time the <code>GameServer</code>
configuration changes.
This process is non-blocking internally.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#000>agonesSDK</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WatchGameServer</span><span style=color:#000;font-weight:700>((</span><span style=color:#000>gameServer</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>=&gt;</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>Console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WriteLine</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>$&#34;Server - Watch {gameServer}&#34;</span><span style=color:#000;font-weight:700>);});</span>
</span></span></code></pre></div><h2 id=player-tracking>Player Tracking</h2><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4><p>The Player Tracking feature is currently <strong><a href=http://localhost:1313/docs/guides/feature-stages/#alpha>Alpha</a></strong>,
not enabled by default, and may change in the future.</p><p>Use the FeatureGate <code>PlayerTracking</code>
to enable and test this feature.</p><p>See the <a href=http://localhost:1313/docs/guides/feature-stages/#feature-gates>Feature Gate documentation</a> for details on how to enable features.</p></div><h3 id=alpha-playerconnect>Alpha: PlayerConnect</h3><p>This method increases the SDK’s stored player count by one, and appends this playerID to GameServer.Status.Players.IDs.
Returns true and adds the playerID to the list of playerIDs if the playerIDs was not already in the list of connected playerIDs.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>bool</span> <span style=color:#000>ok</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Alpha</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>PlayerConnectAsync</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>playerId</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=alpha-playerdisconnect>Alpha: PlayerDisconnect</h3><p>This function decreases the SDK’s stored player count by one, and removes the playerID from GameServer.Status.Players.IDs.
Will return true and remove the supplied playerID from the list of connected playerIDs if the playerID value exists within the list.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>bool</span> <span style=color:#000>ok</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Alpha</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>PlayerDisconnectAsync</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>playerId</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=alpha-setplayercapacity>Alpha: SetPlayerCapacity</h3><p>Update the <code>GameServer.Status.Players.Capacity</code> value with a new capacity.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>capacity</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>100</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>status</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Alpha</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>SetPlayerCapacityAsync</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>capacity</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=alpha-getplayercapacity>Alpha: GetPlayerCapacity</h3><p>This function retrieves the current player capacity <code>GameServer.Status.Players.Capacity</code>.
This is always accurate from what has been set through this SDK, even if the value has yet to be updated on the GameServer status resource.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>long</span> <span style=color:#000>cap</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Alpha</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>GetPlayerCapacityAsync</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><h3 id=alpha-getplayercount>Alpha: GetPlayerCount</h3><p>Returns the current player count</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>long</span> <span style=color:#000>count</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Alpha</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>GetPlayerCountAsync</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><h3 id=alpha-isplayerconnected>Alpha: IsPlayerConnected</h3><p>This returns if the playerID is currently connected to the GameServer.
This is always accurate, even if the value hasn’t been updated to the GameServer status yet.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>playerId</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;player1&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>bool</span> <span style=color:#000>isConnected</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agones</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Alpha</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>IsPlayerConnectedAsync</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>playerId</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><h2 id=remarks>Remarks</h2><ul><li>All requests other than <code>ConnectAsync</code> will wait for up to 15 seconds before giving up, time to wait can also be set in the constructor.</li><li>Default host & port are <code>localhost:9357</code></li><li>Methods that do not return a data object such as <code>GameServer</code> will return a gRPC <code>Grpc.Core.Status</code> object. To check the state of the request, check <code>Status.StatusCode</code> & <code>Status.Detail</code>.
Ex:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>status</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusCode</span> <span style=color:#000;font-weight:700>==</span> <span style=color:#000>StatusCode</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>OK</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//do stuff</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-f8485ce33aea4cc5839759a0e6cfb78e>3.6 - Node.js Game Server Client SDK</h1><div class=lead>This is the Node.js version of the Code Blind Game Server Client SDK.</div><p>Check the <a href=/docs/guides/client-sdks/>Client SDK Documentation</a> for more details on each of the SDK functions and how to run the SDK locally.</p><h2 id=sdk-functionality>SDK Functionality</h2><table><thead><tr><th>Area</th><th>Action</th><th>Implemented</th></tr></thead><tbody><tr><td>Lifecycle</td><td>Ready</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Health</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Reserve</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Allocate</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Shutdown</td><td>✔️</td></tr><tr><td>Configuration</td><td>GetGameServer</td><td>✔️</td></tr><tr><td>Configuration</td><td>WatchGameServer</td><td>✔️</td></tr><tr><td>Metadata</td><td>SetAnnotation</td><td>✔️</td></tr><tr><td>Metadata</td><td>SetLabel</td><td>✔️</td></tr><tr><td>Counters</td><td>GetCounterCount</td><td>❌</td></tr><tr><td>Counters</td><td>SetCounterCount</td><td>❌</td></tr><tr><td>Counters</td><td>IncrementCounter</td><td>❌</td></tr><tr><td>Counters</td><td>DecrementCounter</td><td>❌</td></tr><tr><td>Counters</td><td>SetCounterCapacity</td><td>❌</td></tr><tr><td>Counters</td><td>GetCounterCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>AppendListValue</td><td>❌</td></tr><tr><td>Lists</td><td>DeleteListValue</td><td>❌</td></tr><tr><td>Lists</td><td>SetListCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>GetListCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>ListContains</td><td>❌</td></tr><tr><td>Lists</td><td>GetListLength</td><td>❌</td></tr><tr><td>Lists</td><td>GetListValues</td><td>❌</td></tr><tr><td>Player Tracking</td><td>GetConnectedPlayers</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>GetPlayerCapacity</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>GetPlayerCount</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>IsPlayerConnected</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>PlayerConnect</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>PlayerDisconnect</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>SetPlayerCapacity</td><td>✔️</td></tr></tbody></table><h2 id=prerequisites>Prerequisites</h2><ul><li>Node.js >= 10.13.0</li></ul><h2 id=usage>Usage</h2><p>Add the agones dependency to your project:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>npm install @google-cloud/agones-sdk
</span></span></code></pre></div><p>If you need to download the source, rather than install from NPM, you can find it on
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>GitHub</a>.</p><p>To begin working with the SDK, create an instance of it.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>AgonesSDK</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>require</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;@google-cloud/agones-sdk&#39;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>let</span> <span style=color:#000>agonesSDK</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>AgonesSDK</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><p>To connect to the SDK server, either local or when running on Code Blind, run the <code>async</code> method <code>sdk.connect()</code>, which will
<code>resolve</code> once connected or <code>reject</code> on error or if no connection can be made after 30 seconds.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agonesSDK</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>connect</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><p>To send a <a href=/docs/guides/client-sdks/#health>health check</a> ping call <code>health(errorCallback)</code>. The error callback is optional and if provided will receive an error whenever emitted from the health check stream.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>agonesSDK</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>health</span><span style=color:#000;font-weight:700>((</span><span style=color:#000>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>=&gt;</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>error</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;error&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>error</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>});</span>
</span></span></code></pre></div><p>To mark the game server as <a href=/docs/guides/client-sdks/#ready>ready to receive player connections</a>, call the async method <code>ready()</code>. The result will be an empty object in this case.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#204a87;font-weight:700>let</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agonesSDK</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ready</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><p>Similarly <code>shutdown()</code>, <code>allocate()</code>, <code>setAnnotation(key, value)</code> and <code>setLabel(key, value)</code> are async methods that perform an action and return an empty result.</p><p>To get <a href=/docs/guides/client-sdks/#gameserver>details of the backing GameServer</a> call the async method
<code>getGameServer()</code>. The result will be an object representing <code>GameServer</code> defined
in
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>`sdk.proto`</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#204a87;font-weight:700>let</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>await</span> <span style=color:#000>agonesSDK</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>getGameServer</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><p>To get <a href=/docs/guides/client-sdks/#watchgameserverfunctiongameserver>updates on the backing GameServer</a> as they happen, call <code>watchGameServer(callback, errorCallback)</code>. The callback will be called with a parameter matching the result of <code>getGameServer()</code>. The error callback is optional and if provided will receive an error whenever emitted from the watch stream.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000>agonesSDK</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>watchGameServer</span><span style=color:#000;font-weight:700>((</span><span style=color:#000>result</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>=&gt;</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;watch&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>result</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>},</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>=&gt;</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>error</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;error&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>error</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>});</span>
</span></span></code></pre></div><p>To mark the game server as <a href=/docs/guides/client-sdks/#reserveseconds>reserved</a> for a period of time, call the async method <code>reserve(seconds)</code>. The result will be an empty object.</p><p>For more information, please read the <a href=/docs/guides/client-sdks/>SDK Overview</a>, check out
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>agonesSDK.js</a> and also look at the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>Node.js example</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-24d1a13fcc983c347c4d6e93b5c781b0>3.7 - Rust Game Server Client SDK</h1><div class=lead>This is the Rust version of the Code Blind Game Server Client SDK.</div><p>Check the <a href=/docs/guides/client-sdks/>Client SDK Documentation</a> for more details on each of the SDK functions and how to run the SDK locally.</p><h2 id=sdk-functionality>SDK Functionality</h2><table><thead><tr><th>Area</th><th>Action</th><th>Implemented</th></tr></thead><tbody><tr><td>Lifecycle</td><td>Ready</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Health</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Reserve</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Allocate</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Shutdown</td><td>✔️</td></tr><tr><td>Configuration</td><td>GameServer</td><td>✔️</td></tr><tr><td>Configuration</td><td>Watch</td><td>✔️</td></tr><tr><td>Metadata</td><td>SetAnnotation</td><td>✔️</td></tr><tr><td>Metadata</td><td>SetLabel</td><td>✔️</td></tr><tr><td>Counters</td><td>GetCounterCount</td><td>❌</td></tr><tr><td>Counters</td><td>SetCounterCount</td><td>❌</td></tr><tr><td>Counters</td><td>IncrementCounter</td><td>❌</td></tr><tr><td>Counters</td><td>DecrementCounter</td><td>❌</td></tr><tr><td>Counters</td><td>SetCounterCapacity</td><td>❌</td></tr><tr><td>Counters</td><td>GetCounterCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>AppendListValue</td><td>❌</td></tr><tr><td>Lists</td><td>DeleteListValue</td><td>❌</td></tr><tr><td>Lists</td><td>SetListCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>GetListCapacity</td><td>❌</td></tr><tr><td>Lists</td><td>ListContains</td><td>❌</td></tr><tr><td>Lists</td><td>GetListLength</td><td>❌</td></tr><tr><td>Lists</td><td>GetListValues</td><td>❌</td></tr><tr><td>Player Tracking</td><td>GetConnectedPlayers</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>GetPlayerCapacity</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>GetPlayerCount</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>IsPlayerConnected</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>PlayerConnect</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>PlayerDisconnect</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>SetPlayerCapacity</td><td>✔️</td></tr></tbody></table><h2 id=prerequisites>Prerequisites</h2><ul><li><a href=https://www.rust-lang.org/tools/install>Rust >= 1.50</a></li></ul><h2 id=usage>Usage</h2><p>Add <a href=https://crates.io/crates/agones data-proofer-ignore>this crate</a> to <code>dependencies</code> section in your Cargo.toml.</p><p>Also note that the SDK is <a href=https://doc.rust-lang.org/std/keyword.async.html><code>async</code></a> only, so you will need an async runtime to execute the futures exposed by the SDK. It is recommended to use <a href=https://docs.rs/tokio>tokio</a> as the SDK already depends on tokio due to its choice of gRPC library, <a href=https://docs.rs/tonic>tonic</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=display:flex><span><span style=color:#000;font-weight:700>[</span><span style=color:#000>dependencies</span><span style=color:#000;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#000>agones</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;1.34.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000>tokio</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>version</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;1.32.0&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>features</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;macros&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;sync&#34;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>To begin working with the SDK, create an instance of it.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#204a87;font-weight:700>use</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>std</span>::<span style=color:#000>time</span>::<span style=color:#000>Duration</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#8f5902;font-style:italic>#[tokio::main]</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>async</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>fn</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>let</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>mut</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>sdk</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>agones</span>::<span style=color:#000>Sdk</span>::<span style=color:#000>new</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87>None</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>/* default port */</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>None</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>/* keep_alive */</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000;font-weight:700>.</span><span style=color:#204a87;font-weight:700>await</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000;font-weight:700>.</span><span style=color:#000>expect</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;failed to connect to SDK server&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>To send <a href=/docs/guides/client-sdks/#health>health checks</a>, call <code>sdk.health_check</code>, which will return a <a href=https://docs.rs/tokio/1.7.0/tokio/sync/mpsc/struct.Sender.html><code>tokio::sync::mpsc::Sender::&lt;()></code></a> which will send a health check every time a message is posted to the channel.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#204a87;font-weight:700>let</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>health</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>sdk</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>health_check</span><span style=color:#000;font-weight:700>();</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>if</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>health</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>send</span><span style=color:#000;font-weight:700>(()).</span><span style=color:#204a87;font-weight:700>await</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>is_err</span><span style=color:#000;font-weight:700>()</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>eprintln!</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;the health receiver was closed&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>To mark the <a href=/docs/guides/client-sdks/#ready>game session as ready</a> call <code>sdk.ready()</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#000>sdk</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ready</span><span style=color:#000;font-weight:700>().</span><span style=color:#204a87;font-weight:700>await</span><span style=color:#ce5c00;font-weight:700>?</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>To mark the game server as <a href=/docs/guides/client-sdks/#reserveseconds>reserved</a> for a period of time, call <code>sdk.reserve(duration)</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#000>sdk</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>reserve</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Duration</span>::<span style=color:#000>new</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>)).</span><span style=color:#204a87;font-weight:700>await</span><span style=color:#ce5c00;font-weight:700>?</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>To mark that the <a href=/docs/guides/client-sdks/#shutdown>game session is completed</a> and the game server should be shut down call <code>sdk.shutdown()</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>let</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87>Err</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>e</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>sdk</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>shutdown</span><span style=color:#000;font-weight:700>().</span><span style=color:#204a87;font-weight:700>await</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>eprintln!</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Could not run Shutdown: </span><span style=color:#4e9a06>{}</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>e</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>To <a href=/docs/guides/client-sdks/#setlabelkey-value>set a Label</a> on the backing <code>GameServer</code> call <code>sdk.set_label(key, value)</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#000>sdk</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>set_label</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;test-label&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;test-value&#34;</span><span style=color:#000;font-weight:700>).</span><span style=color:#204a87;font-weight:700>await</span><span style=color:#ce5c00;font-weight:700>?</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>To <a href=/docs/guides/client-sdks/#setannotationkey-value>set an Annotation</a> on the backing <code>GameServer</code> call <code>sdk.set_annotation(key, value)</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#000>sdk</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>set_annotation</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;test-annotation&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;test value&#34;</span><span style=color:#000;font-weight:700>).</span><span style=color:#204a87;font-weight:700>await</span><span style=color:#ce5c00;font-weight:700>?</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>To get <a href=/docs/guides/client-sdks/#gameserver>details of the backing <code>GameServer</code></a> call <code>sdk.get_gameserver()</code>.</p><p>The function will return an instance of <code>agones::types::GameServer</code> including <code>GameServer</code> configuration info.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#204a87;font-weight:700>let</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>gameserver</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>sdk</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>get_gameserver</span><span style=color:#000;font-weight:700>().</span><span style=color:#204a87;font-weight:700>await</span><span style=color:#ce5c00;font-weight:700>?</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>To get <a href=/docs/guides/client-sdks/#watchgameserverfunctiongameserver>updates on the backing <code>GameServer</code></a> as they happen, call <code>sdk.watch_gameserver</code>.</p><p>This will stream updates and endlessly until the stream is closed, so it is recommended to push this into its own async task.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#204a87;font-weight:700>let</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>_watch</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>// We need to clone the SDK as we are moving it to another task
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>let</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>mut</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>watch_client</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>sdk</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>clone</span><span style=color:#000;font-weight:700>();</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>// We use a simple oneshot to signal to the task when we want it to shutdown
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic>// and stop watching the gameserver update stream
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>let</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>tx</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>mut</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rx</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>tokio</span>::<span style=color:#000>sync</span>::<span style=color:#000>oneshot</span>::<span style=color:#000>channel</span>::<span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000;font-weight:700>()</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>();</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>tokio</span>::<span style=color:#000>task</span>::<span style=color:#000>spawn</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>async</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>move</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000>println!</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Starting to watch GameServer updates...&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>match</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>watch_client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>watch_gameserver</span><span style=color:#000;font-weight:700>().</span><span style=color:#204a87;font-weight:700>await</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87>Err</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>e</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>eprintln!</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Failed to watch for GameServer updates: </span><span style=color:#4e9a06>{}</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>e</span><span style=color:#000;font-weight:700>),</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87>Ok</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>mut</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>stream</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>loop</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000>tokio</span>::<span style=color:#000>select!</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#8f5902;font-style:italic>// We&#39;ve received a new update, or the stream is shutting down
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#000>gs</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>stream</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>message</span><span style=color:#000;font-weight:700>()</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                        </span><span style=color:#204a87;font-weight:700>match</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>gs</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                            </span><span style=color:#204a87>Ok</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87>Some</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>gs</span><span style=color:#000;font-weight:700>))</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                                </span><span style=color:#000>println!</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;GameServer Update, name: </span><span style=color:#4e9a06>{}</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>gs</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>object_meta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>unwrap</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>name</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                                </span><span style=color:#000>println!</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;GameServer Update, state: </span><span style=color:#4e9a06>{}</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>gs</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>status</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>unwrap</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>state</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                            </span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                            </span><span style=color:#204a87>Ok</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87>None</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                                </span><span style=color:#000>println!</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Server closed the GameServer watch stream&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                                </span><span style=color:#204a87;font-weight:700>break</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                            </span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                            </span><span style=color:#204a87>Err</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>e</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                                </span><span style=color:#000>eprintln!</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;GameServer Update stream encountered an error: </span><span style=color:#4e9a06>{}</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>e</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                            </span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                        </span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#8f5902;font-style:italic>// The watch is being dropped so we&#39;re going to shutdown the task
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#8f5902;font-style:italic>// and the watch stream
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#000>_</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#204a87;font-weight:700>mut</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>rx</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#ce5c00;font-weight:700>=&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                        </span><span style=color:#000>println!</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Shutting down GameServer watch loop&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                        </span><span style=color:#204a87;font-weight:700>break</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                    </span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#000;font-weight:700>},</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000;font-weight:700>});</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>tx</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>};</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>For more information, please read the <a href=/docs/guides/client-sdks/>SDK Overview</a>, check out
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>agones sdk implementation</a> and also look at the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>Rust example</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-dd2771f8169b00ae8809eb9b01e73547>3.8 - REST Game Server Client API</h1><div class=lead>This is the REST version of the Code Blind Game Server Client SDK.</div><p>Check the <a href=/docs/guides/client-sdks/>Client SDK Documentation</a> for more details on each of the SDK functions and how to run the SDK locally.</p><h2 id=sdk-functionality>SDK Functionality</h2><table><thead><tr><th>Area</th><th>Action</th><th>Implemented</th></tr></thead><tbody><tr><td>Lifecycle</td><td>Ready</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Health</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Reserve</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Allocate</td><td>✔️</td></tr><tr><td>Lifecycle</td><td>Shutdown</td><td>✔️</td></tr><tr><td>Configuration</td><td>GetGameServer</td><td>✔️</td></tr><tr><td>Configuration</td><td>WatchGameServer</td><td>✔️</td></tr><tr><td>Metadata</td><td>SetAnnotation</td><td>✔️</td></tr><tr><td>Metadata</td><td>SetLabel</td><td>✔️</td></tr><tr><td>Counters</td><td>GetCounter</td><td>✔️</td></tr><tr><td>Counters</td><td>UpdateCounter</td><td>✔️</td></tr><tr><td>Lists</td><td>GetList</td><td>✔️</td></tr><tr><td>Lists</td><td>UpdateList</td><td>✔️</td></tr><tr><td>Lists</td><td>AddListValue</td><td>✔️</td></tr><tr><td>Lists</td><td>RemoveListValue</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>GetPlayerCapacity</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>SetPlayerCapacity</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>PlayerConnect</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>GetConnectedPlayers</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>IsPlayerConnected</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>GetPlayerCount</td><td>✔️</td></tr><tr><td>Player Tracking</td><td>PlayerDisconnect</td><td>✔️</td></tr></tbody></table><p>The REST API can be accessed from <code>http://localhost:${AGONES_SDK_HTTP_PORT}/</code> from the game server process.
<code>AGONES_SDK_HTTP_PORT</code> is an environment variable automatically set for the game server process by Code Blind to
support binding the REST API to a dynamic port. It is advised to use the environment variable rather than a
hard coded port; otherwise your game server will not be able to contact the SDK server if it is configured to
use a non-default port.</p><p>Generally the REST interface gets used if gRPC isn&rsquo;t well supported for a given language or platform.</p><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4>The SDK Server sidecar process may startup after your game server binary. So your REST SDK API calls should
contain some retry logic to take this into account.</div><h2 id=generating-clients>Generating clients</h2><p>While you can hand write REST integrations, we also have a set
of
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>generated OpenAPI/Swagger definitions</a> available.
This means you can use OpenAPI/Swagger tooling to generate clients as well, if you need them.</p><p>For example, to create a cpp client for the stable sdk endpoints (to be run in the <code>agones</code> home directory):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker run --rm -v <span style=color:#4e9a06>${</span><span style=color:#000>PWD</span><span style=color:#4e9a06>}</span>:/local swaggerapi/swagger-codegen-cli generate -i /local/sdks/swagger/sdk.swagger.json  -l cpprest -o /local/out/cpp
</span></span></code></pre></div><p>The same could be run for <code>alpha.swagger.json</code> and <code>beta.swagger.json</code> as required.</p><p>You can read more about OpenAPI/Swagger code generation in their <a href=https://swagger.io/docs/open-source-tools/swagger-codegen/>Command Line Tool Documentation</a></p><h2 id=reference>Reference</h2><h3 id=lifecycle-management>Lifecycle Management</h3><h4 id=ready>Ready</h4><p>Call when the GameServer is ready to accept connections</p><ul><li>Path: <code>/ready</code></li><li>Method: <code>POST</code></li><li>Body: <code>{}</code></li></ul><h5 id=example>Example</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#34;{}&#34;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X POST http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/ready
</span></span></code></pre></div><h4 id=health>Health</h4><p>Send a Empty every d Duration to declare that this GameServer is healthy</p><ul><li>Path: <code>/health</code></li><li>Method: <code>POST</code></li><li>Body: <code>{}</code></li></ul><h5 id=example-1>Example</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#34;{}&#34;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X POST http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/health
</span></span></code></pre></div><h4 id=reserve>Reserve</h4><p>Move Gameserver into a Reserved state for a certain amount of seconds for the future allocation.</p><ul><li>Path: <code>/reserve</code></li><li>Method: <code>POST</code></li><li>Body: <code>{"seconds": "5"}</code></li></ul><h5 id=example-2>Example</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#39;{&#34;seconds&#34;: &#34;5&#34;}&#39;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X POST http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/reserve
</span></span></code></pre></div><h4 id=allocate>Allocate</h4><p>With some matchmakers and game matching strategies, it can be important for game servers to mark themselves as <code>Allocated</code>.
For those scenarios, this SDK functionality exists.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>Using a <a href=http://localhost:1313/docs/reference/gameserverallocation/>GameServerAllocation</a> is preferred in all other scenarios,
as it gives Code Blind control over how packed <code>GameServers</code> are scheduled within a cluster, whereas with <code>Allocate()</code> you
relinquish control to an external service which likely doesn&rsquo;t have as much information as Code Blind.</div><h5 id=example-3>Example</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#34;{}&#34;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X POST http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/allocate
</span></span></code></pre></div><h4 id=shutdown>Shutdown</h4><p>Call when the GameServer session is over and it&rsquo;s time to shut down</p><ul><li>Path: <code>/shutdown</code></li><li>Method: <code>POST</code></li><li>Body: <code>{}</code></li></ul><h5 id=example-4>Example</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#34;{}&#34;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X POST http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/shutdown
</span></span></code></pre></div><h3 id=configuration-retrieval>Configuration Retrieval</h3><h4 id=gameserver>GameServer</h4><p>Call when you want to retrieve the backing <code>GameServer</code> configuration details</p><ul><li>Path: <code>/gameserver</code></li><li>Method: <code>GET</code></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X GET http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/gameserver
</span></span></code></pre></div><p>Response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;object_meta&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;local&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;namespace&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;default&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;uid&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;1234&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;resource_version&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;v1&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;generation&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;creation_timestamp&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;1531795395&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;annotations&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;annotation&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;true&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;labels&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&#34;islocal&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;true&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;status&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;state&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Ready&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;address&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;127.0.0.1&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&#34;ports&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;default&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&#34;port&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>7777</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>]</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=watch-gameserver>Watch GameServer</h4><p>Call this when you want to get updates of when the backing <code>GameServer</code> configuration is updated.</p><p>These updates will come as newline delimited JSON, send on each update. To that end, you will
want to keep the http connection open, and read lines from the result stream and and process as they
come in.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X GET http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/watch/gameserver
</span></span></code></pre></div><p>Response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;result&#34;</span><span style=color:#000;font-weight:700>:{</span><span style=color:#204a87;font-weight:700>&#34;object_meta&#34;</span><span style=color:#000;font-weight:700>:{</span><span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;local&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;namespace&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;default&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;uid&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;1234&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;resource_version&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;v1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;generation&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;creation_timestamp&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;1533766607&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;annotations&#34;</span><span style=color:#000;font-weight:700>:{</span><span style=color:#204a87;font-weight:700>&#34;annotation&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#000;font-weight:700>},</span><span style=color:#204a87;font-weight:700>&#34;labels&#34;</span><span style=color:#000;font-weight:700>:{</span><span style=color:#204a87;font-weight:700>&#34;islocal&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#000;font-weight:700>}},</span><span style=color:#204a87;font-weight:700>&#34;status&#34;</span><span style=color:#000;font-weight:700>:{</span><span style=color:#204a87;font-weight:700>&#34;state&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Ready&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;address&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;127.0.0.1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;ports&#34;</span><span style=color:#000;font-weight:700>:[{</span><span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;default&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;port&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#0000cf;font-weight:700>7777</span><span style=color:#000;font-weight:700>}]}}}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;result&#34;</span><span style=color:#000;font-weight:700>:{</span><span style=color:#204a87;font-weight:700>&#34;object_meta&#34;</span><span style=color:#000;font-weight:700>:{</span><span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;local&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;namespace&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;default&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;uid&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;1234&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;resource_version&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;v1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;generation&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;creation_timestamp&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;1533766607&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;annotations&#34;</span><span style=color:#000;font-weight:700>:{</span><span style=color:#204a87;font-weight:700>&#34;annotation&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#000;font-weight:700>},</span><span style=color:#204a87;font-weight:700>&#34;labels&#34;</span><span style=color:#000;font-weight:700>:{</span><span style=color:#204a87;font-weight:700>&#34;islocal&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#000;font-weight:700>}},</span><span style=color:#204a87;font-weight:700>&#34;status&#34;</span><span style=color:#000;font-weight:700>:{</span><span style=color:#204a87;font-weight:700>&#34;state&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Ready&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;address&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;127.0.0.1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;ports&#34;</span><span style=color:#000;font-weight:700>:[{</span><span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;default&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;port&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#0000cf;font-weight:700>7777</span><span style=color:#000;font-weight:700>}]}}}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;result&#34;</span><span style=color:#000;font-weight:700>:{</span><span style=color:#204a87;font-weight:700>&#34;object_meta&#34;</span><span style=color:#000;font-weight:700>:{</span><span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;local&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;namespace&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;default&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;uid&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;1234&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;resource_version&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;v1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;generation&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;creation_timestamp&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;1533766607&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;annotations&#34;</span><span style=color:#000;font-weight:700>:{</span><span style=color:#204a87;font-weight:700>&#34;annotation&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#000;font-weight:700>},</span><span style=color:#204a87;font-weight:700>&#34;labels&#34;</span><span style=color:#000;font-weight:700>:{</span><span style=color:#204a87;font-weight:700>&#34;islocal&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;true&#34;</span><span style=color:#000;font-weight:700>}},</span><span style=color:#204a87;font-weight:700>&#34;status&#34;</span><span style=color:#000;font-weight:700>:{</span><span style=color:#204a87;font-weight:700>&#34;state&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Ready&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;address&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;127.0.0.1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;ports&#34;</span><span style=color:#000;font-weight:700>:[{</span><span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;default&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#204a87;font-weight:700>&#34;port&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#0000cf;font-weight:700>7777</span><span style=color:#000;font-weight:700>}]}}}</span>
</span></span></code></pre></div><p>The Watch GameServer stream is also exposed as a WebSocket endpoint on the same URL and port as the HTTP <code>watch/gameserver</code> API. This endpoint is provided as a convienence for streaming data to clients such as Unreal that support WebSocket but not HTTP streaming, and HTTP streaming should be used instead if possible.</p><p>An example command that uses the WebSocket endpoint instead of streaming over HTTP is:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -N -H <span style=color:#4e9a06>&#34;Connection: Upgrade&#34;</span> -H <span style=color:#4e9a06>&#34;Upgrade: websocket&#34;</span> -H <span style=color:#4e9a06>&#34;Sec-WebSocket-Key: ExampleKey1234567890===&#34;</span> -H <span style=color:#4e9a06>&#34;Sec-WebSocket-Version: 13&#34;</span> -X GET http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/watch/gameserver
</span></span></code></pre></div><p>The data returned from this endpoint is delimited by the boundaries of a WebSocket payload as defined by <a href=https://tools.ietf.org/html/rfc6455#section-5.2>RFC 6455, section 5.2</a>. When reading from this endpoint, if your WebSocket client does not automatically handle frame reassembly (e.g. Unreal), make sure to read to the end of the WebSocket payload (as defined by the FIN bit) before attempting to parse the data returned. This is transparent in most clients.</p><h3 id=metadata-management>Metadata Management</h3><h4 id=set-label>Set Label</h4><p>Apply a Label with the prefix &ldquo;agones.dev/sdk-&rdquo; to the backing <code>GameServer</code> metadata.</p><p>See the SDK <a href=http://localhost:1313/docs/guides/client-sdks/#setlabelkey-value>SetLabel</a> documentation for restrictions.</p><h5 id=example-5>Example</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#39;{&#34;key&#34;: &#34;foo&#34;, &#34;value&#34;: &#34;bar&#34;}&#39;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X PUT http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/metadata/label
</span></span></code></pre></div><h4 id=set-annotation>Set Annotation</h4><p>Apply an Annotation with the prefix &ldquo;agones.dev/sdk-&rdquo; to the backing <code>GameServer</code> metadata</p><h5 id=example-6>Example</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#39;{&#34;key&#34;: &#34;foo&#34;, &#34;value&#34;: &#34;bar&#34;}&#39;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X PUT http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/metadata/annotation
</span></span></code></pre></div><h3 id=counters-and-lists>Counters and Lists</h3><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4><p>The Counters and Lists feature is currently <strong><a href=http://localhost:1313/docs/guides/feature-stages/#alpha>Alpha</a></strong>,
not enabled by default, and may change in the future.</p><p>Use the FeatureGate <code>CountsAndLists</code>
to enable and test this feature.</p><p>See the <a href=http://localhost:1313/docs/guides/feature-stages/#feature-gates>Feature Gate documentation</a> for details on how to enable features.</p></div><h4 id=counters>Counters</h4><p>In all the Counter examples, we retrieve the counter under the key <code>rooms</code> as if it was previously defined in <a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerSpec><code>GameServer.Spec.counters[room]</code></a>.</p><p>For your own Counter REST requests, replace the value <code>rooms</code> with your own key in the path.</p><h5 id=alpha-getcounter>Alpha: GetCounter</h5><p>This function retrieves a specified counter by its key, <code>rooms</code>, and returns its information.</p><h6 id=example-7>Example</h6><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X GET http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/v1alpha1/counters/rooms
</span></span></code></pre></div><p>Response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;rooms&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>&#34;count&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>&#34;capacity&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;10&#34;</span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h5 id=alpha-updatecounter>Alpha: UpdateCounter</h5><p>This function updates the properties of the counter with the key <code>rooms</code>, such as its count and capacity, and returns the updated counter details.</p><h6 id=example-8>Example</h6><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#39;{&#34;count&#34;: &#34;5&#34;, &#34;capacity&#34;: &#34;11&#34;}&#39;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X PATCH http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/v1alpha1/counters/rooms
</span></span></code></pre></div><p>Response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;rooms&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>&#34;count&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;5&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>&#34;capacity&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;11&#34;</span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=lists>Lists</h4><p>In all the List examples, we retrieve the list under the key <code>players</code> as if it was previously defined in <a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.GameServerSpec><code>GameServer.Spec.lists[players]</code></a>.</p><p>For your own List REST based requests, replace the value <code>players</code> with your own key in the path.</p><h5 id=alpha-getlist>Alpha: GetList</h5><p>This function retrieves the list&rsquo;s properties with the key <code>players</code>, returns the list&rsquo;s information.</p><h6 id=example-9>Example</h6><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X GET http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/v1alpha1/lists/players
</span></span></code></pre></div><p>Response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;players&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>&#34;capacity&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;100&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>&#34;values&#34;</span><span style=color:#000;font-weight:700>:[</span><span style=color:#4e9a06>&#34;player0&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;player1&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;player2&#34;</span><span style=color:#000;font-weight:700>]}</span>     
</span></span></code></pre></div><h5 id=alpha-updatelist>Alpha: UpdateList</h5><p>This function updates the list&rsquo;s properties with the key <code>players</code>, such as its capacity and values, returns the updated list details. This will overwrite all existing List.Values with the update list request values. Use addValue or removeValue for modifying the List.Values field.</p><h6 id=example-10>Example</h6><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#39;{&#34;capacity&#34;: &#34;120&#34;, &#34;values&#34;: [&#34;player3&#34;, &#34;player4&#34;]}&#39;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X PATCH http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/v1alpha1/lists/players
</span></span></code></pre></div><p>Response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;players&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>&#34;capacity&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;120&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>&#34;values&#34;</span><span style=color:#000;font-weight:700>:[</span><span style=color:#4e9a06>&#34;player3&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;player4&#34;</span><span style=color:#000;font-weight:700>]}</span>
</span></span></code></pre></div><h5 id=alpha-addlistvalue>Alpha: AddListValue</h5><p>This function adds a new value to a list with the key <code>players</code> and returns the list with this addition.</p><h6 id=example-11>Example</h6><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#39;{&#34;value&#34;: &#34;player9&#34;}&#39;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X POST http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/v1alpha1/lists/players:addValue
</span></span></code></pre></div><p>Response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;players&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>&#34;capacity&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;120&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>&#34;values&#34;</span><span style=color:#000;font-weight:700>:[</span><span style=color:#4e9a06>&#34;player3&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;player4&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;player9&#34;</span><span style=color:#000;font-weight:700>]}</span>
</span></span></code></pre></div><h5 id=alpha-removelistvalue>Alpha: RemoveListValue</h5><p>This function removes a value from the list with the key <code>players</code> and returns updated list.</p><h6 id=example-12>Example</h6><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#39;{&#34;value&#34;: &#34;player3&#34;}&#39;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X POST http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/v1alpha1/lists/players:removeValue
</span></span></code></pre></div><p>Response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;players&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>&#34;capacity&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;120&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>&#34;values&#34;</span><span style=color:#000;font-weight:700>:[</span><span style=color:#4e9a06>&#34;player4&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;player9&#34;</span><span style=color:#000;font-weight:700>]}</span>
</span></span></code></pre></div><h3 id=player-tracking>Player Tracking</h3><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4><p>The Player Tracking feature is currently <strong><a href=http://localhost:1313/docs/guides/feature-stages/#alpha>Alpha</a></strong>,
not enabled by default, and may change in the future.</p><p>Use the FeatureGate <code>PlayerTracking</code>
to enable and test this feature.</p><p>See the <a href=http://localhost:1313/docs/guides/feature-stages/#feature-gates>Feature Gate documentation</a> for details on how to enable features.</p></div><h4 id=alpha-playerconnect>Alpha: PlayerConnect</h4><p>This function increases the SDK’s stored player count by one, and appends this playerID to
<code>GameServer.Status.Players.IDs</code>.</p><h5 id=example-13>Example</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#39;{&#34;playerID&#34;: &#34;uzh7i&#34;}&#39;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X POST http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/alpha/player/connect
</span></span></code></pre></div><p>Response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;bool&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=alpha-playerdisconnect>Alpha: PlayerDisconnect</h4><p>This function decreases the SDK’s stored player count by one, and removes the playerID from
<a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.PlayerStatus><code>GameServer.Status.Players.IDs</code></a>.</p><h5 id=example-14>Example</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#39;{&#34;playerID&#34;: &#34;uzh7i&#34;}&#39;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X POST http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/alpha/player/disconnect
</span></span></code></pre></div><p>Response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;bool&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=alpha-setplayercapacity>Alpha: SetPlayerCapacity</h4><p>Update the <a href=http://localhost:1313/docs/reference/agones_crd_api_reference/#agones.dev/v1.PlayerStatus><code>GameServer.Status.Players.Capacity</code></a> value with a new capacity.</p><h5 id=example-15>Example</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#39;{&#34;count&#34;: 5}&#39;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X PUT http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/alpha/player/capacity
</span></span></code></pre></div><h4 id=alpha-getplayercapacity>Alpha: GetPlayerCapacity</h4><p>This function retrieves the current player capacity. This is always accurate from what has been set through this SDK,
even if the value has yet to be updated on the GameServer status resource.</p><h5 id=example-16>Example</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#39;{}&#39;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X GET http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/alpha/player/capacity
</span></span></code></pre></div><p>Response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;count&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;5&#34;</span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=alpha-getplayercount>Alpha: GetPlayerCount</h4><p>This function retrieves the current player count.
This is always accurate from what has been set through this SDK, even if the value has yet to be updated on the GameServer status resource.</p><h5 id=example-17>Example</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X GET http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/alpha/player/count
</span></span></code></pre></div><p>Response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;count&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;2&#34;</span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=alpha-isplayerconnected>Alpha: IsPlayerConnected</h4><p>This function returns if the playerID is currently connected to the GameServer. This is always accurate from what has
been set through this SDK,
even if the value has yet to be updated on the GameServer status resource.</p><h5 id=example-18>Example</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X GET http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/alpha/player/connected/uzh7i
</span></span></code></pre></div><p>Response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;bool&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=alpha-getconnectedplayers>Alpha: GetConnectedPlayers</h4><p>This function returns the list of the currently connected player ids. This is always accurate from what has been set
through this SDK, even if the value has yet to be updated on the GameServer status resource.</p><h5 id=example-19>Example</h5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X GET http://localhost:<span style=color:#4e9a06>${</span><span style=color:#000>AGONES_SDK_HTTP_PORT</span><span style=color:#4e9a06>}</span>/alpha/player/connected
</span></span></code></pre></div><p>Response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;list&#34;</span><span style=color:#000;font-weight:700>:[</span><span style=color:#4e9a06>&#34;uzh7i&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;3zh7i&#34;</span><span style=color:#000;font-weight:700>]}</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-556057b2ca01a14c9507c51a6c2ec979>3.9 - Local Development</h1><div class=lead>Working against the SDK without having to run a full kubernetes stack</div><p>When the game server is running on Code Blind, the SDK communicates over TCP to a small
gRPC server that Code Blind coordinated to run in a container in the same network
namespace as it - usually referred to in Kubernetes terms as a &ldquo;sidecar&rdquo;.</p><p>Therefore, when developing locally, we also need a process for the SDK to connect to!</p><p>To do this, we can run the same binary (the SDK Server) that runs inside Code Blind, but pass in a flag
to run it in &ldquo;local mode&rdquo;. Local mode means that the sidecar binary
will not try to connect to anything, and will just send log messages to stdout and persist local state in memory so
that you can see exactly what the SDK in your game server is doing, and can
confirm everything works.</p><h2 id=running-the-sdk-server>Running the SDK Server</h2><p>To run the SDK Server, you will need a copy of the binary.
This can either be done by downloading a prebuilt binary or running from source code.
This guide will focus on running from the prebuilt binary, but details about running from source code can be found <a href=/docs/guides/client-sdks/local/#running-from-source-code-instead-of-prebuilt-binary>below</a>.</p><p>To run the prebuilt binary, for the latest release, you will need to download
<a href=https://github.com/josephbarnett/codeblind.ai/releases/download/v1.38.0/agonessdk-server-1.38.0.zip data-proofer-ignore>agonessdk-server-1.38.0.zip</a>
, and unzip it.
You will find the executables for the SDK server, for each type of operating system.</p><ul><li>MacOS<ul><li>sdk-server.darwin.amd64</li><li>sdk-server.darwin.arm64</li></ul></li><li>Linux<ul><li>sdk-server.linux.amd64</li><li>sdk-server.linux.arm64</li></ul></li><li>Windows<ul><li>sdk-server.windows.amd64.exe</li></ul></li></ul><h3 id=running-in-local-mode>Running In &ldquo;Local Mode&rdquo;</h3><p>To run in local mode, pass the flag <code>--local</code> to the executable.</p><p>For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./sdk-server.linux.amd64 --local
</span></span></code></pre></div><p>You should see output similar to the following:</p><pre tabindex=0><code>{&#34;ctlConf&#34;:{&#34;Address&#34;:&#34;localhost&#34;,&#34;IsLocal&#34;:true,&#34;LocalFile&#34;:&#34;&#34;,&#34;Delay&#34;:0,&#34;Timeout&#34;:0,&#34;Test&#34;:&#34;&#34;,&#34;GRPCPort&#34;:9357,&#34;HTTPPort&#34;:9358},&#34;message&#34;:&#34;Starting sdk sidecar&#34;,&#34;severity&#34;:&#34;info&#34;,&#34;source&#34;:&#34;main&#34;,&#34;time&#34;:&#34;2019-10-30T21:44:37.973139+03:00&#34;,&#34;version&#34;:&#34;1.1.0&#34;}
{&#34;grpcEndpoint&#34;:&#34;localhost:9357&#34;,&#34;message&#34;:&#34;Starting SDKServer grpc service...&#34;,&#34;severity&#34;:&#34;info&#34;,&#34;source&#34;:&#34;main&#34;,&#34;time&#34;:&#34;2019-10-30T21:44:37.974585+03:00&#34;}
{&#34;httpEndpoint&#34;:&#34;localhost:9358&#34;,&#34;message&#34;:&#34;Starting SDKServer grpc-gateway...&#34;,&#34;severity&#34;:&#34;info&#34;,&#34;source&#34;:&#34;main&#34;,&#34;time&#34;:&#34;2019-10-30T21:44:37.975086+03:00&#34;}
{&#34;message&#34;:&#34;Ready request has been received!&#34;,&#34;severity&#34;:&#34;info&#34;,&#34;time&#34;:&#34;2019-10-30T21:45:47.031989+03:00&#34;}
{&#34;message&#34;:&#34;gameserver update received&#34;,&#34;severity&#34;:&#34;info&#34;,&#34;time&#34;:&#34;2019-10-30T21:45:47.03225+03:00&#34;}
{&#34;message&#34;:&#34;Shutdown request has been received!&#34;,&#34;severity&#34;:&#34;info&#34;,&#34;time&#34;:&#34;2019-10-30T21:46:18.179341+03:00&#34;}
{&#34;message&#34;:&#34;gameserver update received&#34;,&#34;severity&#34;:&#34;info&#34;,&#34;time&#34;:&#34;2019-10-30T21:46:18.179459+03:00&#34;}
</code></pre><h3 id=enabling-feature-gates>Enabling Feature Gates</h3><p>For development and testing purposes, you might want to enable specific <a href=http://localhost:1313/docs/guides/feature-stages/#feature-gates>features gates</a> in the local SDK Server.</p><p>To do this, you can either set the <code>FEATURE_GATES</code> environment variable or use the <code>--feature-gates</code> command line parameter like so, with the same format as utilised when <a href=http://localhost:1313/docs/installation/install-agones/helm/#configuration>configuring it on a Helm install</a>.</p><p>For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./sdk-server.linux.amd64 --local --feature-gates <span style=color:#000>Example</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>
</span></span></code></pre></div><p>or</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#000>FEATURE_GATES</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>Example</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> ./sdk-server.linux.amd64 --local
</span></span></code></pre></div><h2 id=providing-your-own-gameserver-configuration-for-local-development>Providing your own <code>GameServer</code> configuration for local development</h2><p>By default, the local sdk-server will create a default <code>GameServer</code> configuration that is used for <code>GameServer()</code>
and <code>WatchGameServer()</code> SDK calls. If you wish to provide your own configuration, as either yaml or json, this
can be passed through as either <code>--file</code> or <code>-f</code> along with the <code>--local</code> flag.</p><p>If the <code>GamerServer</code> configuration file is changed while the local server is running,
this will be picked up by the local server, and will change the current active configuration, as well as sending out
events for <code>WatchGameServer()</code>. This is a useful way of testing functionality, such as changes of state from <code>Ready</code> to
<code>Allocated</code> in your game server code.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>File modification events can fire more than one for each save (for a variety of reasons),
but it&rsquo;s best practice to ensure handlers that implement <code>WatchGameServer()</code> be idempotent regardless, as repeats can
happen when live as well.</div><p>For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/simple-game-server/gameserver.yaml
</span></span><span style=display:flex><span>./sdk-server.linux.amd64 --local -f ./gameserver.yaml
</span></span></code></pre></div><pre tabindex=0><code>{&#34;ctlConf&#34;:{&#34;Address&#34;:&#34;localhost&#34;,&#34;IsLocal&#34;:true,&#34;LocalFile&#34;:&#34;./gameserver.yaml&#34;,&#34;Delay&#34;:0,&#34;Timeout&#34;:0,&#34;Test&#34;:&#34;&#34;,&#34;GRPCPort&#34;:9357,&#34;HTTPPort&#34;:9358},&#34;message&#34;:&#34;Starting sdk sidecar&#34;,&#34;severity&#34;:&#34;info&#34;,&#34;source&#34;:&#34;main&#34;,&#34;time&#34;:&#34;2019-10-30T21:47:45.742776+03:00&#34;,&#34;version&#34;:&#34;1.1.0&#34;}
{&#34;filePath&#34;:&#34;/Users/alexander.apalikov/Downloads/agonessdk-server-1.1.0/gameserver.yaml&#34;,&#34;message&#34;:&#34;Reading GameServer configuration&#34;,&#34;severity&#34;:&#34;info&#34;,&#34;time&#34;:&#34;2019-10-30T21:47:45.743369+03:00&#34;}
{&#34;grpcEndpoint&#34;:&#34;localhost:9357&#34;,&#34;message&#34;:&#34;Starting SDKServer grpc service...&#34;,&#34;severity&#34;:&#34;info&#34;,&#34;source&#34;:&#34;main&#34;,&#34;time&#34;:&#34;2019-10-30T21:47:45.759692+03:00&#34;}
{&#34;httpEndpoint&#34;:&#34;localhost:9358&#34;,&#34;message&#34;:&#34;Starting SDKServer grpc-gateway...&#34;,&#34;severity&#34;:&#34;info&#34;,&#34;source&#34;:&#34;main&#34;,&#34;time&#34;:&#34;2019-10-30T21:47:45.760312+03:00&#34;}
</code></pre><h2 id=changing-state-of-a-local-gameserver>Changing State of a Local GameServer</h2><p>Some SDK calls would change the GameServer state according to <a href=http://localhost:1313/docs/reference/gameserver/#gameserver-state-diagram>GameServer State Diagram</a>. Also local SDK server would persist labels and annotations updates.</p><p>Here is a complete list of these commands: ready, allocate, setlabel, setannotation, shutdown, reserve.</p><p>For example call to Reserve() for 30 seconds would change the GameServer state to Reserve and if no call to Allocate() occurs it would return back to Ready state after this period.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>All state transitions are supported for local SDK server, however not all of them are valid in the real scenario. For instance, you cannot make a transition of a GameServer from Shutdown to a Ready state, but can do using local SDK server.</div><p>All changes to the GameServer state could be observed and retrieved using Watch() or GameServer() methods using GameServer SDK.</p><p>Example of using HTTP gateway locally:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -X POST <span style=color:#4e9a06>&#34;http://localhost:9358/ready&#34;</span> -H <span style=color:#4e9a06>&#34;accept: application/json&#34;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#4e9a06>&#34;{}&#34;</span>
</span></span></code></pre></div><pre tabindex=0><code>{}
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -GET <span style=color:#4e9a06>&#34;http://localhost:9358/gameserver&#34;</span> -H <span style=color:#4e9a06>&#34;accept: application/json&#34;</span>
</span></span></code></pre></div><pre tabindex=0><code>{&#34;object_meta&#34;:{&#34;creation_timestamp&#34;:&#34;-62135596800&#34;},&#34;spec&#34;:{&#34;health&#34;:{}},&#34;status&#34;:{&#34;state&#34;:&#34;Ready&#34;}}
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -X PUT <span style=color:#4e9a06>&#34;http://localhost:9358/metadata/label&#34;</span> -H <span style=color:#4e9a06>&#34;accept: application/json&#34;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#4e9a06>&#34;{ \&#34;key\&#34;: \&#34;foo\&#34;, \&#34;value\&#34;: \&#34;bar\&#34;}&#34;</span>
</span></span><span style=display:flex><span>curl -GET <span style=color:#4e9a06>&#34;http://localhost:9358/gameserver&#34;</span> -H <span style=color:#4e9a06>&#34;accept: application/json&#34;</span>
</span></span></code></pre></div><pre tabindex=0><code>{&#34;object_meta&#34;:{&#34;creation_timestamp&#34;:&#34;-62135596800&#34;,&#34;labels&#34;:{&#34;agones.dev/sdk-foo&#34;:&#34;bar&#34;}},&#34;spec&#34;:{&#34;health&#34;:{}},&#34;status&#34;:{&#34;state&#34;:&#34;Ready&#34;}}
</code></pre><h2 id=running-local-mode-in-a-container>Running Local Mode in a Container</h2><p>Once you have your game server process in a container, you may also want to test the container build locally as well.</p><p>Since the production agones-sdk binary has the <code>--local</code> mode built in, you can also use the production container image
locally as well!</p><p>Since the SDK and your game server container need to share a port on <code>localhost</code>, one of the easiest ways to do that
is to have them both run using the host network, like so:</p><p>In one shell run:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker run --network<span style=color:#ce5c00;font-weight:700>=</span>host --rm us-docker.pkg.dev/agones-images/release/agones-sdk:1.38.0 --local
</span></span></code></pre></div><p>You should see a similar output to what you would if you were running the binary directly, i.e. outside a container.</p><p>Then in another shell, start your game server container:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker run --network<span style=color:#ce5c00;font-weight:700>=</span>host --rm &lt;your image here&gt;
</span></span></code></pre></div><p>If you want to <a href=/docs/guides/client-sdks/local/#providing-your-own-gameserver-configuration-for-local-development>mount a custom <code>gameserver.yaml</code></a>,
this is also possible:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/simple-game-server/gameserver.yaml
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># required so that the `agones` user in the container can read the file</span>
</span></span><span style=display:flex><span>chmod o+r gameserver.yaml
</span></span><span style=display:flex><span>docker run --network<span style=color:#ce5c00;font-weight:700>=</span>host --rm -v <span style=color:#204a87;font-weight:700>$(</span><span style=color:#204a87>pwd</span><span style=color:#204a87;font-weight:700>)</span>/gameserver.yaml:/tmp/gameserver.yaml us-docker.pkg.dev/agones-images/release/agones-sdk:1.38.0 --local -f /tmp/gameserver.yaml
</span></span></code></pre></div><p>If you run Docker on a OS that doesn&rsquo;t run Docker natively or in a VM, such as on Windows or macOS, you may want to to run the ClientSDK and your game server container together with <a href=https://docs.docker.com/compose/>Docker Compose</a>. To do so, create a <code>docker-compose.yaml</code> file setup with a network overlay shared between them:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;3&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>services</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>gameserver</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>build</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>.</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># &lt;path to build context&gt;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>ports</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#4e9a06>&#34;127.0.0.1:7777:7777/udp&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>sdk-server</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>image</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;us-docker.pkg.dev/agones-images/release/agones-sdk:1.38.0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>command</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>--<span style=color:#000>local -f /gs_config</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>network_mode</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>service:gameserver</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># &lt;shared network between sdk and game server&gt;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>configs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#000>gs_config</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>configs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>gs_config</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>file</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>./gameserver.yaml</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Run <code>docker-compose</code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker-compose up --build
</span></span></code></pre></div><h2 id=running-from-source-code-instead-of-prebuilt-binary>Running from source code instead of prebuilt binary</h2><p>If you wish to run from source rather than pre-built binaries, that is an available alternative.
You will need <a href=https://go.dev/doc/install>Go installed</a> and will need to clone the <a href=https://github.com/googleforgames/agones>Code Blind GitHub repo</a>.</p><p><strong>Disclaimer:</strong> Code Blind is run and tested with the version of Go specified by the <code>GO_VERSION</code> variable in the project&rsquo;s <a href=https://github.com/googleforgames/agones/blob/main/build/build-image/Dockerfile>build Dockerfile</a>. Other versions are not supported, but may still work.</p><p>Your cloned repository is best switched to the latest specific release&rsquo;s branch/tag. For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/googleforgames/agones.git
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> agones
</span></span><span style=display:flex><span>git checkout release-1.38.0
</span></span></code></pre></div><p>With Go installed and the Code Blind repository cloned, the SDK Server can be run with the following command (from the Code Blind clone directory):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>go run cmd/sdk-server/main.go --local
</span></span></code></pre></div><p>Commandline flags (e.g. <code>--local</code>) are exactly the same as command line flags when utilising a pre-built binary.</p><h2 id=next-steps>Next Steps:</h2><ul><li>Learn how to connect your local development game server binary into a running Code Blind Kubernetes cluster for even more live development options with an <a href=http://localhost:1313/docs/advanced/out-of-cluster-dev-server/>out of cluster dev server</a>.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-5e516fa2b9ffa121bddad09db5bc4c2c>4 - Windows Gameservers</h1><div class=lead>Run <code>GameServers</code> on Kubernetes nodes with the Windows operating system.</div><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4>Running <code>GameServers</code> on Windows nodes is currently Alpha, and any feedback
would be appreciated.</div><h2 id=prerequisites>Prerequisites</h2><p>The following prerequisites are required to create a GameServer:</p><ol><li>A Kubernetes cluster with the UDP port range 7000-8000 open on each node.</li><li>Code Blind controller installed in the targeted cluster</li><li>kubectl properly configured</li><li>Netcat which is already installed on most Linux/macOS distributions, for windows you can use <a href=https://docs.microsoft.com/en-us/windows/wsl/install-win10>WSL</a>.</li></ol><p>If you don’t have a Kubernetes cluster you can follow <a href=/docs/installation/>these instructions</a> to create a cluster on Google Kubernetes Engine (GKE), Minikube or Azure Kubernetes Service (AKS), and install Code Blind.</p><p>For the purpose of this guide we’re going to use the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/examples/simple-game-server/ target=_blank data-proofer-ignore>simple-game-server</a>
example as the GameServer container. This example is a very simple UDP server written in Go. Don’t hesitate to look at the code of this example for more information.</p><p>Ensure that you have some nodes to your cluster that are running Windows.</p><h2 id=objectives>Objectives</h2><ul><li>Create a GameServer on a Windows node.</li><li>Connect to the GameServer.</li></ul><h3 id=1-create-a-gameserver>1. Create a GameServer</h3><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>Starting with version 0.3, the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>simple-game-server</a> example is compiled as a multi-arch docker image that will run on both Linux and Windows. To ensure that the game server runs on a Windows node, a nodeSelector of <code>"kubernetes.io/os": windows</code> must be added to the game server specification.</div><p>Create a GameServer using the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/simple-game-server/gameserver-windows.yaml
</span></span></code></pre></div><p>You should see a successful output similar to this:</p><pre tabindex=0><code>gameserver.agones.dev/simple-game-server-4ss4j created
</code></pre><p>Verify that the GameServer becomes Ready by running:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get gameservers
</span></span></code></pre></div><p>It should look something like this:</p><pre tabindex=0><code>NAME                       STATE     ADDRESS       PORT   NODE     AGE
simple-game-server-7pjrq   Ready   35.233.183.43   7190   agones   3m
</code></pre><p>Take a note of the Game Server IP address and ports.</p><p>For the full details of the YAML file head to the <a href=http://localhost:1313/docs/reference/gameserver/>GameServer Specification Guide</a></p><h3 id=2-connect-to-the-gameserver>2. Connect to the GameServer</h3><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>If you have Code Blind installed on Google Kubernetes Engine, and are using
Cloud Shell for your terminal, UDP is blocked. For this step, we recommend
SSH&rsquo;ing into a running VM in your project, such as a Kubernetes node.
You can click the &lsquo;SSH&rsquo; button on the <a href=https://console.cloud.google.com/compute/instances>Google Compute Engine Instances</a>
page to do this.
Run <code>toolbox</code> on GKE Node to run docker container with tools and then <code>nc</code> command would be available.</div><p>You can now communicate with the Game Server:</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4><p>If you do not have netcat installed
(i.e. you get a response of <code>nc: command not found</code>),
you can install netcat by running <code>sudo apt install netcat</code>.</p><p>If you are on Windows, you can alternatively install netcat on
<a href=https://docs.microsoft.com/en-us/windows/wsl/install-win10>WSL</a>,
or download a version of netcat for Windows from <a href=https://nmap.org/ncat/>nmap.org</a>.</p></div><pre tabindex=0><code>nc -u {IP} {PORT}
Hello World !
ACK: Hello World !
EXIT
</code></pre><p>You can finally type <code>EXIT</code> which tells the SDK to run the <a href=http://localhost:1313/docs/guides/client-sdks/#shutdown>Shutdown command</a>, and therefore shuts down the <code>GameServer</code>.</p><p>If you run <code>kubectl describe gameserver</code> again - either the GameServer will be gone completely, or it will be in <code>Shutdown</code> state, on the way to being deleted.</p><h2 id=next-steps>Next Steps</h2><ul><li>Make a local copy of the simple-game-server
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>fleet configuration</a>,
modify it to include a node selector, and use it to go through the <a href=http://localhost:1313/docs/getting-started/create-fleet/>Quickstart: Create a Game Server Fleet</a>.</li><li>If you want to use your own GameServer container make sure you have properly integrated the <a href=http://localhost:1313/docs/guides/client-sdks/>Code Blind SDK</a>.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-02f8cd51bf4cf97802ded5bc598c3392>5 - Fleet Updates</h1><div class=lead>Common patterns and approaches for updating Fleets with newer and/or different versions of your <code>GameServer</code> configuration.</div><h2 id=rolling-update-strategy>Rolling Update Strategy</h2><p>When Fleets are edited and updated, the default strategy of Code Blind is to roll the new version of the <code>GameServer</code>
out to the entire <code>Fleet</code>, in a step by step increment and decrement by adding a chunk of the new version and removing
a chunk of the current set of <code>GameServers</code>.</p><p>This is done while ensuring that <code>Allocated</code> <code>GameServers</code> are not deleted
until they are specifically shutdown through the game servers SDK, as they are expected to have players on them.</p><p>You can see this in the <code>Fleet.Spec.Strategy</code> <a href=http://localhost:1313/docs/reference/fleet/>reference</a>, with controls for how
much of the <code>Fleet</code> is incremented and decremented at one time:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RollingUpdate</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>rollingUpdate</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxSurge</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>25</span><span style=color:#000>%</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>maxUnavailable</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>25</span><span style=color:#000>%</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>So when a Fleet is edited (any field other than <code>replicas</code>, see note below), either through <code>kubectl</code> <code>edit</code>/<code>apply</code> or via the Kubernetes API, this performs the following operations:</p><ol><li>Adds the <code>maxSurge</code> number of <code>GameServers</code> to the Fleet.</li><li>Shutdown the <code>maxUnavailable</code> number of <code>GameServers</code> in the Fleet, skipping <code>Allocated</code> <code>GameServers</code>.</li><li>Repeat above steps until all the previous <code>GameServer</code> configurations have been <code>Shutdown</code> and deleted.</li></ol><p>By default, a Fleet will wait for new <code>GameSevers</code> to become <code>Ready</code> during a Rolling Update before continuing to shutdown additional <code>GameServers</code>, only counting <code>GameServers</code> that are <code>Ready</code> as being available when calculating the current <code>maxUnavailable</code> value which controls the rate at which <code>GameServers</code> are updated.
This ensures that a Fleet cannot accidentally have zero <code>GameServers</code> in the <code>Ready</code> state if something goes wrong during a Rolling Update or if <code>GameServers</code> have a long delay before moving to the <code>Ready</code> state.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4><p>When <code>Fleet</code> update contains only changes to the <code>replicas</code> parameter, then new GameServers will be created/deleted straight away,
which means in that case <code>maxSurge</code> and <code>maxUnavailable</code> parameters for a RollingUpdate will not be used.
The RollingUpdate strategy takes place when you update <code>spec</code> parameters other than <code>replicas</code>.</p><p>If you are using a Fleet which is scaled by a FleetAutoscaler, <a href=/docs/getting-started/create-fleetautoscaler/#7-change-autoscaling-parameters>read the Fleetautoscaler guide</a> for more details on how RollingUpdates with FleetAutoscalers need to be implemented.</p><p>You could also check the behaviour of the Fleet with a RollingUpdate strategy on a test <code>Fleet</code> to preview your upcoming updates.
Use <code>kubectl describe fleet</code> to track scaling events in a Fleet.</p></div><h2 id=recreate-strategy>Recreate Strategy</h2><p>This is an optimal <code>Fleet</code> update strategy if you want to replace all <code>GameServers</code> that are not <code>Allocated</code>
with a new version as quickly as possible.</p><p>You can see this in the <code>Fleet.Spec.Strategy</code> <a href=http://localhost:1313/docs/reference/fleet/>reference</a>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>strategy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Recreate</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>So when a Fleet is edited, either through <code>kubectl</code> <code>edit</code>/<code>apply</code> or via the Kubernetes API, this performs the following operations:</p><ol><li><code>Shutdown</code> all <code>GameServers</code> in the Fleet that are not currently <code>Allocated</code>.</li><li>Create the same number of the new version of the <code>GameServers</code> that were previously deleted.</li><li>Repeat above steps until all the previous <code>GameServer</code> configurations have been <code>Shutdown</code> and deleted.</li></ol><h2 id=two-or-more-fleets-strategy>Two (or more) Fleets Strategy</h2><p>If you want very fine-grained control over the rate that new versions of a <code>GameServer</code> configuration is rolled out, or
if you want to do some version of A/B testing or smoke test between different versions, running two (or more) <code>Fleets</code> at the same time is a
good solution for this.</p><p>To do this, create a second <code>Fleet</code> inside your cluster, starting with zero replicas. From there you can scale this newer <code>Fleet</code>
up and the older <code>Fleet</code> down as required by your specific rollout strategy.</p><p>This also allows you to rollback if issues arise with the newer version, as you can delete the newer <code>Fleet</code>
and scale up the old Fleet to its previous levels, resulting in minimal impact to the players.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>For GameServerAllocation, you will need to have at least a single shared label between the <code>GameServers</code> in each
Fleet.</div><h3 id=gameserverallocation-across-fleets>GameServerAllocation Across Fleets</h3><p>Since <code>GameServerAllocation</code> is powered by label selectors, it is possible to allocate across multiple fleets, and/or
give preference to particular sets of <code>GameServers</code> over others. You can see details of this in
the <code>GameServerAllocation</code> <a href=http://localhost:1313/docs/reference/gameserverallocation/>reference</a>.</p><p>In a scenario where a new <code>v2</code> version of a <code>Fleet</code> is being slowly scaled up in a separate Fleet from the previous <code>v1</code>
Fleet, we can specify that we <code>prefer</code> allocation to occur from the <code>v2</code> Fleet, and if none are available, fallback to
the <code>v1</code> Fleet, like so:</p><ul class="nav nav-tabs" id=tabs-5 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-05-00-tab data-bs-toggle=tab data-bs-target=#tabs-05-00 role=tab data-td-tp-persist=yaml aria-controls=tabs-05-00 aria-selected=true>
selectors</button></li><li class=nav-item><button class=nav-link id=tabs-05-01-tab data-bs-toggle=tab data-bs-target=#tabs-05-01 role=tab aria-controls=tabs-05-01 aria-selected=false>
required & preferred (deprecated)</button></li></ul><div class=tab-content id=tabs-5-content><div class="tab-pane fade show active" id=tabs-05-00 role=tabpanel aria-labelled-by=tabs-05-00-tab tabindex=5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;allocation.agones.dev/v1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>GameServerAllocation</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selectors</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>agones.dev/fleet</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>game</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>my-awesome-game</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span></span></span></code></pre></div></div><div class="tab-pane fade" id=tabs-05-01 role=tabpanel aria-labelled-by=tabs-05-01-tab tabindex=5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;allocation.agones.dev/v1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>GameServerAllocation</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic># Deprecated, use field selectors instead.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>required</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>game</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>my-awesome-game</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic># Deprecated, use field selectors instead.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>preferred</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>agones.dev/fleet</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>v2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span></span></span></code></pre></div></div></div><p>In this example, all <code>GameServers</code> have the label <code>game: my-awesome-game</code>, so the Allocation will search across both
Fleets through that mechanism. The <code>selectors</code> label matching selector tells the allocation system to first search
all <code>GameServers</code> with the <code>v2</code> <code>Fleet</code> label, and if not found, search through the rest of the set.</p><p>The above <code>GameServerAllocation</code> can then be used while you scale up the <code>v2</code> Fleet and scale down the original Fleet at
the rate that you deem fit for your specific rollout.</p><h2 id=notifying-gameservers-on-fleet-updatedownscale>Notifying GameServers on Fleet Update/Downscale</h2><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4><p>The Allocated GameSever Overflow Notification feature is currently <strong><a href=http://localhost:1313/docs/guides/feature-stages/#beta>Beta</a></strong>,
and while it is enabled by default it may change in the future.</p><p>Use the Feature Gate <code>FleetAllocationOverflow</code> to disable this feature.</p><p>See the <a href=http://localhost:1313/docs/guides/feature-stages/#feature-gates>Feature Gate documentation</a> for details on how to disable features.</p></div><p>When <code>Allocated</code> <code>GameServers</code> are utilised for a long time, such as a Lobby <code>GameServer</code>,
or a <code>GameServer</code> that is being reused multiple times in a row, it can be useful
to notify an <code>Allocated</code> <code>GameServer</code> process when its backing Fleet has been updated.
When an update occurs, the <code>Allocated</code> <code>GameServer</code>, may want to actively perform a graceful shutdown and release its
resources such that it can be replaced by a new version, or similar actions.</p><p>To do this, we provide the ability to apply a user-provided set of labels and/or annotations to the <code>Allocated</code>
<code>GameServers</code> when a <code>Fleet</code> update occurs that updates its <code>GameServer</code> template, or generally
causes the <code>Fleet</code> replica count to drop below the number of currently <code>Allocated</code> <code>GameServers</code>.</p><p>This provides two useful capabilities:</p><ol><li>The <code>GameServer</code> <a href=/docs/guides/client-sdks/#watchgameserverfunctiongameserver><code>SDK.WatchGameServer()</code></a>
command can be utilised to react to this annotation and/or label change to
indicate the Fleet system change, and the game server binary could execute code accordingly.</li><li>This can also be used to proactively update <code>GameServer</code> labels, to effect change in allocation strategy - such as
preferring the newer <code>GameServers</code> when allocating, but falling back to the older version if there aren&rsquo;t enough
of the new ones yet spun up.</li></ol><p>The labels and/or annotations are applied to <code>GameServers</code> in a <code>Fleet</code> in the order designated by their configured <a href=http://localhost:1313/docs/advanced/scheduling-and-autoscaling/#fleet-scheduling>Fleet scheduling</a>.</p><p>Example yaml configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;agones.dev/v1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Fleet</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>simple-game-server</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>replicas</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>allocationOverflow</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># This specifies which annotations and/or labels are applied</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>mykey</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>myvalue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>version</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># empty an existing label value, so it&#39;s no longer in the allocation selection</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>event</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>overflow</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>template</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>ports</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>default</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>containerPort</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>7654</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>template</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>containers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>simple-game-server</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>image</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>us-docker.pkg.dev/agones-images/examples/simple-game-server:0.27</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>See the <a href=/docs/reference/fleet/>Fleet reference</a> for more details.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>This works the same across Fleet resizing and Rolling/Recreate Updates, in that the implementation responds to the
underlying <code>GameServerSet</code>&rsquo;s replicas being shrunk to a value smaller than the number of <code>Allocated</code>
<code>GameServers</code> it controls. Therefore, this functionality works equally well with a rolling update as it does with an
update strategy that requires at least two <code>Fleets</code>.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-92d27aa55ec2fc72cebf70399bffad86>6 - GameServer Health Checking</h1><div class=lead>Health checking exists to track the overall healthy state of the GameServer, such that action can be taken when a something goes wrong or a GameServer drops into an Unhealthy state</div><h2 id=disabling-health-checking>Disabling Health Checking</h2><p>By default, health checking is enabled, but it can be turned off by setting the <code>spec.health.disabled</code> property to
true.</p><h2 id=sdk-api>SDK API</h2><p>The <code>Health()</code> function on the <a href=/docs/guides/client-sdks/>SDK object</a> needs to be called at an
interval less than the <code>spec.health.periodSeconds</code>
threshold time to be considered before it will be considered a <code>failure</code>.</p><p>The health check will also need to have not been called a consecutive number of times (<code>spec.health.failureThreshold</code>),
giving it a chance to heal if it there is an issue.</p><h2 id=health-failure-strategy>Health Failure Strategy</h2><p>The following is the process for what happens to a <code>GameServer</code> when it is unhealthy.</p><ol><li>If the <code>GameServer</code> container exits with an error before the <code>GameServer</code> moves to <code>Ready</code> then,
it is restarted as per the <code>restartPolicy</code> (which defaults to &ldquo;Always&rdquo;).</li><li>If the <code>GameServer</code> fails health checking at any point, then it doesn&rsquo;t restart,
but moves to an <code>Unhealthy</code> state.</li><li>If the <code>GameServer</code> container exits while in <code>Ready</code>, <code>Allocated</code> or <code>Reserved</code> state, it will be restarted
as per the <code>restartPolicy</code> (which defaults to &ldquo;Always&rdquo;, since <code>RestartPolicy</code> is a <code>Pod</code> wide setting),
but will immediately move to an <code>Unhealthy</code> state.</li><li>If the SDK sidecar fails, then it will be restarted, assuming the <code>RestartPolicy</code> is Always/OnFailure.</li></ol><h2 id=fleet-management-of-unhealthy-gameservers>Fleet Management of Unhealthy GameServers</h2><p>If a <code>GameServer</code> moves into an <code>Unhealthy</code> state when it is not part of a Fleet, the <code>GameServer</code> will remain in the
Unhealthy state until explicitly deleted. This is useful for debugging <code>Unhealthy</code> <code>GameServers</code>, or if you are
creating your own <code>GameServer</code> management layer, you can explicitly choose what to do if a <code>GameServer</code> becomes
<code>Unhealthy</code>.</p><p>If a <code>GameServer</code> is part of a <code>Fleet</code>, the <code>Fleet</code> management system will <em>delete</em> any <code>Unhealthy</code> <code>GameServers</code> and
immediately replace them with a brand new <code>GameServer</code> to ensure it has the configured number of Replicas.</p><h2 id=configuration-reference>Configuration Reference</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic># Health checking for the running game server</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>health</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic># Disable health checking. defaults to false, but can be set to true</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>disabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic># Number of seconds after the container has started before health check is initiated. Defaults to 5 seconds</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>initialDelaySeconds</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic># If the `Health()` function doesn&#39;t get called at least once every period (seconds), then</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic># the game server is not healthy. Defaults to 5</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>periodSeconds</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic># Minimum consecutive failures for the health probe to be considered failed after having succeeded.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic># Defaults to 3. Minimum value is 1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>failureThreshold</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>See the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>full GameServer example</a> for more details</p><h2 id=example>Example</h2><h3 id=c>C++</h3><p>For a configuration that requires a health ping every 5 seconds, the example below sends a request every 2 seconds
to be sure that the GameServer is under the threshold.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>doHealth</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>agones</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>SDK</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>sdk</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>while</span> <span style=color:#000;font-weight:700>(</span><span style=color:#204a87>true</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>sdk</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>Health</span><span style=color:#000;font-weight:700>())</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#000>std</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>cout</span> <span style=color:#ce5c00;font-weight:700>&lt;&lt;</span> <span style=color:#4e9a06>&#34;Health ping failed&#34;</span> <span style=color:#ce5c00;font-weight:700>&lt;&lt;</span> <span style=color:#000>std</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>endl</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#000>std</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>cout</span> <span style=color:#ce5c00;font-weight:700>&lt;&lt;</span> <span style=color:#4e9a06>&#34;Health ping sent&#34;</span> <span style=color:#ce5c00;font-weight:700>&lt;&lt;</span> <span style=color:#000>std</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>endl</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#000>std</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>this_thread</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>sleep_for</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>std</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>chrono</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>seconds</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>));</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>agones</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>SDK</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>sdk</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>agones</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>SDK</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>bool</span> <span style=color:#000>connected</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>sdk</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>Connect</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>connected</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000>std</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#204a87;font-weight:700>thread</span> <span style=color:#000>health</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>doHealth</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>sdk</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// ...  run the game server code
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=full-game-server>Full Game Server</h3><p>Also look in the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>examples</a> directory.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a08db3b081cafbd3d70d9f298bfcb5a4>7 - Player Tracking</h1><div class=lead>Track player connections, disconnections, counts and capacities through the Code Blind SDK</div><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4><p>The Player Tracking feature is currently <strong><a href=http://localhost:1313/docs/guides/feature-stages/#alpha>Alpha</a></strong>,
not enabled by default, and may change in the future.</p><p>Use the FeatureGate <code>PlayerTracking</code>
to enable and test this feature.</p><p>See the <a href=http://localhost:1313/docs/guides/feature-stages/#feature-gates>Feature Gate documentation</a> for details on how to enable features.</p></div><h2 id=managing-gameserver-capacities>Managing GameServer Capacities</h2><p>To track your <code>GameServer</code> current player capacity, Code Blind gives you the ability to both set an initial capacity at
<code>GameServer</code> creation, as well be able to change it during the lifecycle of the <code>GameServer</code> through the Code Blind SDK.</p><p>To set the initial capacity, you can do so via <code>GameServer.Spec.Players.InitialCapacity</code> like so:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;agones.dev/v1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>GameServer</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;gs-example&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic># ...</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>players</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic># set this GameServer&#39;s initial player capacity to 10</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>initialCapacity</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>From there, if you need to change the capacity of the GameSever as gameplay is in progress, you can also do so via
<a href=http://localhost:1313/docs/guides/client-sdks/#alphasetplayercapacitycount><code>SDK.Alpha().SetPlayerCapacity(count)</code></a></p><p>The current player capacity is represented in <code>GameServer.Status.Players.Capacity</code> resource value.</p><p>We can see this in action, when we look at the Status section of a GameServer resource
, wherein the capacity has been set to 20:</p><pre tabindex=0><code>...
Status:
  Address:    14.81.195.72
  Node Name:  gke-test-cluster-default-6cd0ba67-1mps
  Players:
    Capacity:  20
    Count:     0
    Ids:       &lt;nil&gt;
  Ports:
    Name:          gameport
    Port:          7983
  Reserved Until:  &lt;nil&gt;
  State:           Ready
</code></pre><p>From the SDK, the game server binary can also retrieve the current player capacity
via <a href=http://localhost:1313/docs/guides/client-sdks/#alphagetplayercapacity><code>SDK.Alpha().GetPlayerCapacity()</code></a>.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4><p>Changing the capacity value here has no impact on players actually
connected to or trying to connect to your server, as that is not a responsibility of Code Blind.</p><p>This functionality is for tracking purposes only.</p></div><h2 id=connecting-and-disconnecting-players>Connecting and Disconnecting Players</h2><p>As players connect and disconnect from your game, the Player Tracking functions enable you to track which players
are currently connected.</p><p>It assumed that each player that connects has a unique token that identifies them as a player.</p><p>When a player connects to the game server binary,
calling <a href=http://localhost:1313/docs/guides/client-sdks/#alphaplayerconnectplayerid><code>SDK.Alpha().PlayerConnect(playerID)</code></a>
with the unique player token will register them as connected, and store their player id.</p><p>At disconnection time,
call <a href=http://localhost:1313/docs/guides/client-sdks/#alphaplayerdisconnectplayerid><code>SDK.Alpha().PlayerDisconnect(playerID)</code></a>
, which will deregister them and remove their player id from the list.</p><p>Each of these <code>playerIDs</code> is stored on <code>GameServer.Status.Players.IDs</code>, and the current count of connected players
can be seen in <code>GameServer.Status.Players.Count</code>.</p><p>You can see this in action below in the <code>GameServer</code> Status section, where there are 4 players connected:</p><pre tabindex=0><code>...
Status:
  Address:    39.82.196.74
  Node Name:  gke-test-cluster-default-6cd0ba77-1mps
  Players:
    Capacity:  10
    Count:     4
    Ids:
      xy8a
      m0ux
      71nj
      lpq5
  Ports:
    Name:          gameport
    Port:          7166
  Reserved Until:  &lt;nil&gt;
  State:           Ready
</code></pre><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4><p>Calling <code>PlayerConnect</code> or <code>PlayerDisconnect</code> functions will not
connect or disconnect players, as that is not under the control of Code Blind.</p><p>This functionality is for tracking purposes only.</p></div><h2 id=checking-player-data>Checking Player Data</h2><p>Not only is the connected player data stored on the <code>GameServer</code> resource, it is also stored in memory within the
SDK, so that it can be used from within the game server binary as a realtime, thread safe, registry of connected
players.</p><p>Therefore, if you want to:</p><ul><li>Get the current player count, call <a href=http://localhost:1313/docs/guides/client-sdks/#alphagetplayercount><code>SDK.Alpha().GetPlayerCount()</code></a></li><li>Check if a specific player is connected, call <a href=http://localhost:1313/docs/guides/client-sdks/#alphaisplayerconnectedplayerid><code>SDK.Alpha().IsPlayerConnected(playerID)</code></a></li><li>Retrieve the full list of connected players, call <a href=http://localhost:1313/docs/guides/client-sdks/#alphagetconnectedplayers><code>SDK.Alpha().GetConnectedPlayers()</code></a></li></ul><h2 id=next-steps>Next Steps</h2><ul><li>Review the <a href=http://localhost:1313/docs/guides/client-sdks/#player-tracking>Player Tracking SDK Reference</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-23757d70ae51993a62d84d8b6ff8f736>8 - Local Game Server</h1><div class=lead>Register your local game server with Code Blind.</div><p>You can register a local game server with Code Blind. This means you can run an experimental build of your game server in the Code Blind environment without the need of packaging and deploying it to a fleet. This allows you to quickly iterate on your game server code while still being able to plugin to your Code Blind environment.</p><h2 id=register-your-server-with-code-blind>Register your server with Code Blind</h2><p>To register your local game server you&rsquo;ll need to know the IP address of the machine running it and the port. With that you&rsquo;ll create a game server config like the one below.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;agones.dev/v1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>GameServer</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>my-local-server</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>annotations</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic># Causes Code Blind to register your local game server at 192.1.1.2, replace with your server&#39;s IP address.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>agones.dev/dev-address</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;192.1.1.2&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>ports</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>default</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>portPolicy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Static</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>hostPort</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>17654</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>containerPort</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>17654</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic># The following is ignored but required due to validation.</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>template</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>containers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>simple-game-server</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>image</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>us-docker.pkg.dev/codeblind/examples/simple-server:0.27</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Once you save this to a file make sure you have <code>kubectl</code> configured to point to your Code Blind cluster and then run <code>kubectl apply -f dev-gameserver.yaml</code>. This will register your server with Code Blind.</p><p>Local Game Servers has a few limitations:</p><ul><li>PortPolicy must be <code>Static</code>.</li><li>The game server is not managed by Code Blind. Features like autoscaling, replication, etc are not available.</li></ul><p>When you are finished working with your server, you can remove the registration with <code>kubectl delete -f dev-gameserver.yaml</code></p><h2 id=next-steps>Next Steps:</h2><ul><li>Review the specification of <a href=http://localhost:1313/docs/reference/gameserver/>GameServer</a>.</li><li>Read about <code>GameServer</code> allocation.<ul><li>Review the flow of how <a href=http://localhost:1313/docs/integration-patterns/allocation-from-fleet/>allocation</a> is done.</li><li>Review the specification of <a href=http://localhost:1313/docs/reference/gameserverallocation/>GameServerAllocation</a>.</li><li>Check out the <a href=http://localhost:1313/docs/advanced/allocator-service/>Allocator Service</a> as a richer alternative to <code>GameServerAllocation</code>.</li></ul></li><li>Learn how to connect your local development game server binary into a running Code Blind Kubernetes cluster for even more live development options with an <a href=http://localhost:1313/docs/advanced/out-of-cluster-dev-server/>out of cluster dev server</a>.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-d09d57ab1b4977b31173571cab22eba4>9 - Latency Testing with Multiple Clusters</h1><div class=lead>When running multiple Code Blind clusters around the world, you may need to have clients determine which cluster to connect to based on latency.</div><p>To make latency testing easier, Code Blind installs with a simple ping service with both HTTP and UDP services that can be called
for the purpose of timing how long the roundtrip takes for information to be returned from either of these services.</p><h2 id=installing>Installing</h2><p>By default, Code Blind installs <a href=https://kubernetes.io/docs/concepts/services-networking/service/>Kubernetes Services</a> for
both HTTP and the UDP ping endpoints. These can be disabled entirely,
or disabled individually. See the <a href=http://localhost:1313/docs/installation/install-agones/helm/>Helm install guide</a> for the parameters to
pass through,
as well as configuration options.</p><p>The ping services as all installed under the <code>agones-system</code> namespace.</p><h2 id=http-service>HTTP Service</h2><p>This exposes an endpoint that returns a simple text HTTP response on request to the root &ldquo;/&rdquo; path. By default this is <code>ok</code>, but
it can be configured via the <code>agones.ping.http.response</code> parameter.</p><p>This could be useful for providing clusters
with unique lookup names, such that clients are able to identify clusters from their responses.</p><p>To lookup the details of this service, run <code>kubectl describe service agones-ping-http-service --namespace=agones-system</code></p><h2 id=udp-service>UDP Service</h2><p>The UDP ping service is a rate limited UDP echo service that returns the udp packet that it receives to its designated
sender.</p><p>Since UDP sender details can be spoofed, this service is rate limited to 20 requests per second,
per sender address, per running instance (default is 2).</p><p>This rate limit can be raised or lowered via the Helm install parameter <code>agones.ping.udp.rateLimit</code>.</p><p>UDP packets are also limited to 1024 bytes in size.</p><p>To lookup the details of this service, run <code>kubectl describe service agones-ping-udp-service --namespace=agones-system</code></p><h2 id=client-side-tooling>Client side tooling</h2><p>We deliberately didn&rsquo;t provide any game client libraries, as all major languages and engines have capabilities
to send HTTP requests as well as UDP packets.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-9346aaa1ce9cead47412256db81fcfb4>10 - Metrics</h1><p>Code Blind controller exposes metrics via <a href=https://opencensus.io/>OpenCensus</a>. OpenCensus is a single distribution of libraries that collect metrics and distributed traces from your services, we only use it for metrics but it will allow us to support multiple exporters in the future.</p><p>We choose to start with <a href=https://prometheus.io/>Prometheus</a> as this is the most popular with Kubernetes but it is also compatible with Cloud Monitoring.
If you need another exporter, check the <a href=https://opencensus.io/exporters/supported-exporters/go/>list of supported</a> exporters. It should be pretty straightforward to register a new one. (GitHub PRs are more than welcome.)</p><p>We plan to support multiple exporters in the future via environment variables and helm flags.</p><h2 id=backend-integrations>Backend integrations</h2><h3 id=prometheus>Prometheus</h3><p>If you are running a <a href=https://prometheus.io/>Prometheus</a> instance you just need to ensure that metrics and kubernetes service discovery are enabled. (helm chart values <code>agones.metrics.prometheusEnabled</code> and <code>agones.metrics.prometheusServiceDiscovery</code>). This will automatically add annotations required by Prometheus to discover Code Blind metrics and start collecting them. (see <a href=https://github.com/prometheus/prometheus/tree/main/documentation/examples/kubernetes-rabbitmq>example</a>)</p><p>If your Prometheus metrics collection agent requires that you scrape from the pods directly(such as with <a href=https://cloud.google.com/stackdriver/docs/managed-prometheus>Google Cloud Managed Prometheus</a>), then the metrics ports for the controller and allocator will both be named <code>http</code> and exposed on <code>8080</code>. In the case of the allocator, the port name and number can be overriden with the <code>agones.allocator.serviceMetrics.http.portName</code> and <code>agones.allocator.serviceMetrics.http.port</code> helm chart values.</p><h3 id=prometheus-operator>Prometheus Operator</h3><p>If you have <a href=https://github.com/coreos/prometheus-operator>Prometheus operator</a> installed in your cluster, just enable ServiceMonitor installation in values:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>agones</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>metrics</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>serviceMonitor</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>enabled</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=google-cloud-managed-service-for-prometheus>Google Cloud Managed Service for Prometheus</h3><p><a href=https://cloud.google.com/stackdriver/docs/managed-prometheus>Google Cloud Managed Service for Prometheus</a> is a fully managed multi-cloud solution for <a href=https://prometheus.io/>Prometheus</a>.
If you wish to use Managed Prometheus with Code Blind, follow the <a href=/docs/guides/metrics/#google-cloud-managed-service-for-prometheus-installation>Google Cloud Managed Service for Prometheus installation steps</a>.</p><h3 id=google-cloud-monitoring-formerly-stackdriver>Google Cloud Monitoring (formerly Stackdriver)</h3><p>We support the <a href=https://opencensus.io/exporters/supported-exporters/go/stackdriver/>OpenCensus Stackdriver exporter</a>.
In order to use it you should enable <a href=https://cloud.google.com/monitoring/api/enable-api>Cloud Monitoring API</a> in Google Cloud Console.
Follow the <a href=/docs/guides/metrics/#google-cloud-monitoring-installation>Google Cloud Monitoring installation steps</a> to see your metrics in Cloud Monitoring.</p><h2 id=metrics-available>Metrics available</h2><table><thead><tr><th>Name</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>agones_gameservers_count</td><td>The number of gameservers per fleet and status</td><td>gauge</td></tr><tr><td>agones_gameserver_allocations_duration_seconds</td><td>The distribution of gameserver allocation requests latencies</td><td>histogram</td></tr><tr><td>agones_gameservers_total</td><td>The total of gameservers per fleet and status</td><td>counter</td></tr><tr><td>agones_gameserver_player_connected_total</td><td>The total number of players connected to gameservers (Only available when <a href=/docs/guides/player-tracking/>player tracking</a> is enabled)</td><td>gauge</td></tr><tr><td>agones_gameserver_player_capacity_total</td><td>The available capacity for players on gameservers (Only available when <a href=/docs/guides/player-tracking/>player tracking</a> is enabled)</td><td>gauge</td></tr><tr><td>agones_fleets_replicas_count</td><td>The number of replicas per fleet (total, desired, ready, reserved, allocated)</td><td>gauge</td></tr><tr><td>agones_fleet_autoscalers_able_to_scale</td><td>The fleet autoscaler can access the fleet to scale</td><td>gauge</td></tr><tr><td>agones_fleet_autoscalers_buffer_limits</td><td>The limits of buffer based fleet autoscalers (min, max)</td><td>gauge</td></tr><tr><td>agones_fleet_autoscalers_buffer_size</td><td>The buffer size of fleet autoscalers (count or percentage)</td><td>gauge</td></tr><tr><td>agones_fleet_autoscalers_current_replicas_count</td><td>The current replicas count as seen by autoscalers</td><td>gauge</td></tr><tr><td>agones_fleet_autoscalers_desired_replicas_count</td><td>The desired replicas count as seen by autoscalers</td><td>gauge</td></tr><tr><td>agones_fleet_autoscalers_limited</td><td>The fleet autoscaler is outside the limits set by MinReplicas and MaxReplicas.</td><td>gauge</td></tr><tr><td>agones_gameservers_node_count</td><td>The distribution of gameservers per node</td><td>histogram</td></tr><tr><td>agones_nodes_count</td><td>The count of nodes empty and with gameservers</td><td>gauge</td></tr><tr><td>agones_gameservers_state_duration</td><td>The distribution of gameserver state duration in seconds. Note: this metric could have some missing samples by design. Do not use the <code>_total</code> counter as the real value for state changes.</td><td>histogram</td></tr><tr><td>agones_k8s_client_http_request_total</td><td>The total of HTTP requests to the Kubernetes API by status code</td><td>counter</td></tr><tr><td>agones_k8s_client_http_request_duration_seconds</td><td>The distribution of HTTP requests latencies to the Kubernetes API by status code</td><td>histogram</td></tr><tr><td>agones_k8s_client_cache_list_total</td><td>The total number of list operations for client-go caches</td><td>counter</td></tr><tr><td>agones_k8s_client_cache_list_duration_seconds</td><td>Duration of a Kubernetes list API call in seconds</td><td>histogram</td></tr><tr><td>agones_k8s_client_cache_list_items</td><td>Count of items in a list from the Kubernetes API</td><td>histogram</td></tr><tr><td>agones_k8s_client_cache_watches_total</td><td>The total number of watch operations for client-go caches</td><td>counter</td></tr><tr><td>agones_k8s_client_cache_last_resource_version</td><td>Last resource version from the Kubernetes API</td><td>gauge</td></tr><tr><td>agones_k8s_client_workqueue_depth</td><td>Current depth of the work queue</td><td>gauge</td></tr><tr><td>agones_k8s_client_workqueue_latency_seconds</td><td>How long an item stays in the work queue</td><td>histogram</td></tr><tr><td>agones_k8s_client_workqueue_items_total</td><td>Total number of items added to the work queue</td><td>counter</td></tr><tr><td>agones_k8s_client_workqueue_work_duration_seconds</td><td>How long processing an item from the work queue takes</td><td>histogram</td></tr><tr><td>agones_k8s_client_workqueue_retries_total</td><td>Total number of items retried to the work queue</td><td>counter</td></tr><tr><td>agones_k8s_client_workqueue_longest_running_processor</td><td>How long the longest running workqueue processor has been running in microseconds</td><td>gauge</td></tr><tr><td>agones_k8s_client_workqueue_unfinished_work_seconds</td><td>How long unfinished work has been sitting in the workqueue in seconds</td><td>gauge</td></tr></tbody></table><h3 id=dropping-metric-labels>Dropping Metric Labels</h3><p>When a Fleet or FleetAutoscaler is deleted from the system, Code Blind will automatically clear metrics that utilise
their name as a label from the exported metrics, so the metrics exported do not continuously grow in size over the
lifecycle of the Code Blind installation.</p><h2 id=dashboard>Dashboard</h2><h3 id=grafana-dashboards>Grafana Dashboards</h3><p>We provide a set of useful <a href=https://grafana.com/>Grafana</a> dashboards to monitor Code Blind workload, they are located under the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/main/ target=_blank data-proofer-ignore>grafana folder</a>:</p><ul><li><p><a href=https://github.com/josephbarnett/codeblind.ai/blob/main/ target=_blank data-proofer-ignore>Code Blind Autoscalers</a> allows you to monitor your current autoscalers replicas request as well as fleet replicas allocation and readyness statuses. You can only select one autoscaler at the time using the provided dropdown.</p></li><li><p><a href=https://github.com/josephbarnett/codeblind.ai/blob/main/ target=_blank data-proofer-ignore>Code Blind GameServers</a> displays your current game servers workload status (allocations, game servers statuses, fleets replicas) with optional fleet name filtering.</p></li><li><p><a href=https://github.com/josephbarnett/codeblind.ai/blob/main/ target=_blank data-proofer-ignore>Code Blind GameServer Allocations</a> displays Code Blind gameservers allocations rates and counts per fleet.</p></li><li><p><a href=https://github.com/josephbarnett/codeblind.ai/blob/main/ target=_blank data-proofer-ignore>Code Blind Allocator Resource</a> displays Code Blind Allocators CPU, memory usage and also some useful Golang runtime metrics.</p></li><li><p><a href=https://github.com/josephbarnett/codeblind.ai/blob/main/ target=_blank data-proofer-ignore>Code Blind Status</a> displays Code Blind controller health status.</p></li><li><p><a href=https://github.com/josephbarnett/codeblind.ai/blob/main/ target=_blank data-proofer-ignore>Code Blind Controller Resource Usage</a> displays Code Blind Controller CPU and memory usage and also some Golang runtime metrics.</p></li><li><p><a href=https://github.com/josephbarnett/codeblind.ai/blob/main/ target=_blank data-proofer-ignore>Code Blind Controller go-client requests</a> displays Code Blind Controller Kubernetes API consumption.</p></li><li><p><a href=https://github.com/josephbarnett/codeblind.ai/blob/main/ target=_blank data-proofer-ignore>Code Blind Controller go-client caches</a> displays Code Blind Controller Kubernetes Watches/Lists operations used.</p></li><li><p><a href=https://github.com/josephbarnett/codeblind.ai/blob/main/ target=_blank data-proofer-ignore>Code Blind Controller go-client workqueues</a> displays Code Blind Controller workqueue processing time and rates.</p></li><li><p><a href=https://github.com/josephbarnett/codeblind.ai/blob/main/ target=_blank data-proofer-ignore>Code Blind Controller API Server requests</a> displays your current API server request rate, errors rate and request latencies with optional CustomResourceDefinition filtering by Types: fleets, gameserversets, gameservers, gameserverallocations.</p></li></ul><p>Dashboard screenshots :</p><p><img alt="grafana dashboard autoscalers" src=../../../images/grafana-dashboard-autoscalers.png></p><p><img alt="grafana dashboard controller" src=../../../images/grafana-dashboard-controller.png></p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>You can import our dashboards by copying the json content from
<a href=https://github.com/josephbarnett/codeblind.ai/blob/main/ target=_blank data-proofer-ignore>each config map</a> into your own instance of Grafana (+ > Create > Import > Or paste json) or follow the <a href=/#installation>installation</a> guide.</div><h2 id=installation>Installation</h2><p>When operating a live multiplayer game you will need to observe performances, resource usage and availability to learn more about your system. This guide will explain how you can setup Prometheus and Grafana into your own Kubernetes cluster to monitor your Code Blind workload.</p><p>Before attemping this guide you should make sure you have <a href=https://kubernetes.io/docs/tasks/tools/install-kubectl/>kubectl</a> and <a href=https://docs.helm.sh/using_helm/>helm</a> installed and configured to reach your kubernetes cluster.</p><h3 id=prometheus-installation>Prometheus installation</h3><p>Prometheus is an open source monitoring solution, we will use it to store Code Blind controller metrics and query back the data.</p><p>Let&rsquo;s install Prometheus using the <a href=https://prometheus-community.github.io/helm-charts/>Prometheus Community Kubernetes Helm Charts</a> repository.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
</span></span><span style=display:flex><span>helm repo update
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>helm upgrade --install --wait prom prometheus-community/prometheus --namespace metrics --create-namespace <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set server.global.scrape_interval<span style=color:#ce5c00;font-weight:700>=</span>30s <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set server.persistentVolume.enabled<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    --set server.persistentVolume.size<span style=color:#ce5c00;font-weight:700>=</span>64Gi <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>    -f ./build/prometheus.yaml
</span></span></code></pre></div><p>For resiliency it is recommended to run Prometheus on a dedicated node which is separate from nodes where Game Servers
are scheduled. If you use the above command, with our
<a href=https://github.com/josephbarnett/codeblind.ai/blob/main/ target=_blank data-proofer-ignore>prometheus.yaml</a> to set up Prometheus, it will schedule Prometheus pods on nodes
tainted with <code>agones.dev/agones-metrics=true:NoExecute</code> and labeled with <code>agones.dev/agones-metrics=true</code> if available.</p><p>As an example, to set up a dedicated node pool for Prometheus on GKE, run the following command before installing Prometheus. Alternatively you can taint and label nodes manually.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gcloud container node-pools create agones-metrics --cluster<span style=color:#ce5c00;font-weight:700>=</span>... --zone<span style=color:#ce5c00;font-weight:700>=</span>... <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>  --node-taints agones.dev/agones-metrics<span style=color:#ce5c00;font-weight:700>=</span>true:NoExecute <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>  --node-labels agones.dev/agones-metrics<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>  --num-nodes<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1</span> <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>  --machine-type<span style=color:#ce5c00;font-weight:700>=</span>e2-standard-4
</span></span></code></pre></div><p>By default we will disable the push gateway (we don&rsquo;t need it for Code Blind) and other exporters.</p><p>The helm chart supports
<a href=https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#nodeselector>nodeSelector</a>,
<a href=https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity>affinity</a> and <a href=https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/>toleration</a>, you can use them to schedule Prometheus deployments on an isolated node(s) to have an homogeneous game servers workload.</p><p>This will install a Prometheus Server in your current cluster with <a href=https://kubernetes.io/docs/concepts/storage/persistent-volumes/>Persistent Volume Claim</a> (Deactivated for Minikube and Kind) for storing and querying time series, it will automatically start collecting metrics from Code Blind Controller.</p><p>Finally, to access Prometheus metrics, rules and alerts explorer use</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl port-forward deployments/prom-prometheus-server <span style=color:#0000cf;font-weight:700>9090</span> -n metrics
</span></span></code></pre></div><p>Now you can access the prometheus dashboard <a href=http://localhost:9090>http://localhost:9090</a>.</p><p>On the landing page you can start exploring metrics by creating <a href=https://prometheus.io/docs/prometheus/latest/querying/basics/>queries</a>. You can also verify what <a href=http://localhost:9090/targets>targets</a> Prometheus currently monitors (Header Status > Targets), you should see Code Blind controller pod in the <code>kubernetes-pods</code> section.</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>Metrics will be first registered when you will start using Code Blind.</div><p>Now let&rsquo;s install some Grafana dashboards.</p><h3 id=grafana-installation>Grafana installation</h3><p>Grafana is a open source time series analytics platform which supports Prometheus data source. We can also easily import pre-built dashboards.</p><p>First we will install <a href=/docs/guides/metrics/#grafana-dashboards>Code Blind dashboard</a> as <a href=https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/>config maps</a> in our cluster.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f ./build/grafana/
</span></span></code></pre></div><p>Now we can install the
<a href=https://grafana.github.io/helm-charts/>Grafana Community Kubernetes Helm Charts</a> from
their repository. (Replace <code>&lt;your-admin-password></code> with the admin password of your choice)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>helm repo add grafana https://grafana.github.io/helm-charts
</span></span><span style=display:flex><span>helm repo update
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>helm upgrade --install --wait grafana grafana/grafana --namespace metrics <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>  --set <span style=color:#000>adminPassword</span><span style=color:#ce5c00;font-weight:700>=</span>&lt;your-admin-password&gt; -f ./build/grafana.yaml
</span></span></code></pre></div><p>This will install Grafana with our prepopulated dashboards and prometheus datasource <a href=/docs/guides/metrics/#prometheus-installation>previously installed</a></p><p>Finally to access dashboards run</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl port-forward deployments/grafana <span style=color:#0000cf;font-weight:700>3000</span> -n metrics
</span></span></code></pre></div><p>Open a web browser to <a href=http://localhost:3000>http://localhost:3000</a>, you should see Code Blind <a href=/docs/guides/metrics/#grafana-dashboards>dashboards</a> after login as admin.</p><h3 id=google-cloud-managed-service-for-prometheus-installation>Google Cloud Managed Service for Prometheus installation</h3><p>To collect Code Blind metrics using <a href=https://cloud.google.com/stackdriver/docs/managed-prometheus>Managed Prometheus</a>:</p><ul><li><p>Follow the instructions to enable managed collection for a <a href=https://cloud.google.com/stackdriver/docs/managed-prometheus/setup-managed#enable-mgdcoll-gke>GKE cluster</a> or <a href=https://cloud.google.com/stackdriver/docs/managed-prometheus/setup-managed#enable-mgdcoll-non-gke>non-GKE cluster</a>.</p></li><li><p>Configure Managed Prometheus to scrape Code Blind by creating a <code>PodMonitoring</code> resource:</p></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -n agones-system -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/build/prometheus-google-managed.yaml
</span></span></code></pre></div><ul><li>Confirm that you can see <a href=https://cloud.google.com/monitoring/promql>Prometheus metrics in Cloud Monitoring</a>. If that&rsquo;s all you need, you can stop here.</li></ul><p>To install Grafana using a Managed Prometheus backend:</p><ul><li>Complete the <a href=https://cloud.google.com/stackdriver/docs/managed-prometheus/query#begin>Before you begin</a>. To align with the Code Blind <a href=/docs/guides/metrics/#grafana-installation>Grafana installation</a>, we&rsquo;ll be installing in the <code>metrics</code> namespace, which you&rsquo;ll need to create.<ul><li>If your cluster has Workload Identity enabled, which is enabled on GKE Autopilot by default, follow <a href=https://cloud.google.com/stackdriver/docs/managed-prometheus/query#gmp-wli-svcacct>Configure a service account for Workload Identity</a> to ensure that you have appropriately authorized the default Kubernetes service account in the <code>metrics</code> namespace.</li></ul></li><li>Install the <a href=https://cloud.google.com/stackdriver/docs/managed-prometheus/query#ui-prometheus>Standalone Prometheus frontend UI</a> in the <code>metrics</code> namespace - this will act as your authentication proxy for PromQL queries.</li><li><a href=/docs/guides/metrics/#grafana-installation>Install Grafana as above</a>, using <code>-f ./build/grafana-frontend.yaml</code> instead of <code>-f ./build/grafana.yaml</code>.</li></ul><h3 id=google-cloud-monitoring-installation>Google Cloud Monitoring installation</h3><p>In order to use <a href=https://console.cloud.google.com/monitoring>Google Cloud Monitoring</a> you must <a href=https://cloud.google.com/monitoring/api/enable-api>enable the Monitoring API</a> in the Google Cloud Console. The Cloud Monitoring exporter uses a strategy called Application Default Credentials (ADC) to find your application&rsquo;s credentials. Details can be found in <a href=https://cloud.google.com/docs/authentication/production>Setting Up Authentication for Server to Server Production Applications</a>.</p><p>You need to grant all the necessary permissions to the users (see <a href=https://cloud.google.com/monitoring/access-control>Access Control Guide</a>). The predefined role Monitoring Metric Writer contains those permissions. Use the following command to assign the role to your default service account.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gcloud projects add-iam-policy-binding <span style=color:#ce5c00;font-weight:700>[</span>PROJECT_ID<span style=color:#ce5c00;font-weight:700>]</span> --member serviceAccount:<span style=color:#ce5c00;font-weight:700>[</span>PROJECT_NUMBER<span style=color:#ce5c00;font-weight:700>]</span>-compute@developer.gserviceaccount.com --role roles/monitoring.metricWriter
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>Cloud Operations for GKE (including Cloud Monitoring) is enabled by default on GKE clusters, however you can follow this <a href=https://cloud.google.com/stackdriver/docs/solutions/gke/installing#upgrade-instructions>guide</a> if it is currently disabled in your GKE cluster.</div><p>Before proceeding, ensure you have created a metrics node pool as mentioned in the Google Cloud <a href=http://localhost:1313/docs/installation/creating-cluster/gke/>installation guide</a>.</p><p>The default metrics exporter installed with Code Blind is Prometheus. If you are using the <a href=http://localhost:1313/docs/installation/install-agones/helm/>Helm installation</a>, you can install or upgrade Code Blind to use Cloud Monitoring, using the following chart parameters:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>helm upgrade --install --wait --set agones.metrics.stackdriverEnabled<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> --set agones.metrics.prometheusEnabled<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span> --set agones.metrics.prometheusServiceDiscovery<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span> my-release-name agones/agones --namespace<span style=color:#ce5c00;font-weight:700>=</span>agones-system
</span></span></code></pre></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>If you are using the <a href=http://localhost:1313/docs/installation/install-agones/yaml/>YAML installation</a>, follow the instructions on the page to change the above parameters by using helm to generate a custom YAML file locally.</div><p>With this configuration only the Cloud Monitoring exporter would be used instead of Prometheus exporter.</p><h4 id=using-cloud-monitoring-with-workload-identity>Using Cloud Monitoring with Workload Identity</h4><p>If you would like to enable Cloud Monitoring in conjunction with <a href=https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity>Workload Identity</a>, there are a few extra steps you need to follow:</p><ol><li><p>When setting up the Google service account following the instructions for <a href=https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity#authenticating_to>Authenticating to Google Cloud</a>, create two IAM policy bindings, one for <code>serviceAccount:PROJECT_ID.svc.id.goog[agones-system/agones-controller]</code> and one for <code>serviceAccount:PROJECT_ID.svc.id.goog[agones-system/agones-allocator]</code>.</p></li><li><p>Pass parameters to helm when installing Code Blind to add annotations to the <code>agones-controller</code> and <code>agones-allocator</code> Kubernetes service accounts:</p></li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>helm install my-release --namespace agones-system --create-namespace agones/agones --set agones.metrics.stackdriverEnabled<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span> --set agones.metrics.prometheusEnabled<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span> --set agones.metrics.prometheusServiceDiscovery<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span> --set agones.serviceaccount.allocator.annotations.<span style=color:#4e9a06>&#34;iam\.gke\.io/gcp-service-account&#34;</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;GSA_NAME@PROJECT_ID\.iam\.gserviceaccount\.com&#34;</span> --set agones.serviceaccount.allocator.labels.<span style=color:#4e9a06>&#34;iam\.gke\.io/gcp-service-account&#34;</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;GSA_NAME@PROJECT_ID\.iam\.gserviceaccount\.com&#34;</span> --set agones.serviceaccount.controller.annotations.<span style=color:#4e9a06>&#34;iam\.gke\.io/gcp-service-account&#34;</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;GSA_NAME@PROJECT_ID\.iam\.gserviceaccount\.com&#34;</span>
</span></span></code></pre></div><p>To verify that metrics are being sent to Cloud Monitoring, create a Fleet or a Gameserver and look for the metrics to show up in the Cloud Monitoring dashboard. Navigate to the <a href=https://console.cloud.google.com/monitoring/metrics-explorer>Metrics explorer</a> and search for metrics with the prefix <code>agones/</code>. Select a metric and look for data to be plotted in the graph to the right.</p><p>An example of a custom dashboard is:</p><p><img alt="cloud monitoring dashboard" src=../../../images/stackdriver-metrics-dashboard.png></p><p>Currently there exists only manual way of configuring Cloud Monitoring Dashboard. So it is up to you to set an Alignment Period (minimal is 1 minute), GroupBy, Filter parameters and other graph settings.</p><h4 id=troubleshooting>Troubleshooting</h4><p>If you can&rsquo;t see Code Blind metrics you should have a look at the controller logs for connection errors. Also ensure that your cluster has the necessary credentials to interact with Cloud Monitoring. You can configure <code>stackdriverProjectID</code> manually, if the automatic discovery is not working.</p><p>Permissions problem example from controller logs:</p><pre tabindex=0><code>Failed to export to Stackdriver: rpc error: code = PermissionDenied desc = Permission monitoring.metricDescriptors.create denied (or the resource may not exist).
</code></pre><p>If you receive this error, ensure your service account has the role or corresponding permissions mentioned above.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-35cc8c47e6283062d03d8cced1728ff8>11 - Access Code Blind via the Kubernetes API</h1><div class=lead>It&rsquo;s likely that we will want to programmatically interact with Code Blind. Everything that can be done via the <code>kubectl</code> and yaml configurations can also be done via the <a href=https://kubernetes.io/docs/concepts/overview/kubernetes-api/>Kubernetes API</a>.</div><p>Installing Code Blind creates several <a href=https://kubernetes.io/docs/concepts/api-extension/custom-resources>Custom Resource Definitions (CRD)</a>,
which can be accessed and manipulated through the Kubernetes API.</p><p>The detailed list of Code Blind CRDs with their parameters could be found here - <a href=../../reference/agones_crd_api_reference/>Code Blind CRD API Reference</a>.</p><p>Kubernetes has multiple <a href=https://kubernetes.io/docs/reference/using-api/client-libraries/>client libraries</a>, however,
at time of writing, only
the <a href=https://github.com/kubernetes/client-go>Go</a> and
<a href=https://github.com/kubernetes-client/python/>Python</a> clients are documented to support accessing CRDs.</p><p>This can be found in the <a href=https://kubernetes.io/docs/concepts/api-extension/custom-resources/#accessing-a-custom-resource>Accessing a custom resource</a>
section of the Kubernetes documentation.</p><p>At this time, we recommend interacting with Code Blind through the Go client that has been generated in this repository,
but other methods may also work as well.</p><h2 id=go-client>Go Client</h2><p>Kubernetes Go Client tooling generates a Client for Code Blind that we can use to interact with the Code Blind
installation on our Kubernetes cluster.</p><ul><li><a href=https://pkg.go.dev/agones.dev/agones/pkg/client/clientset/versioned>Godoc for the Code Blind Client</a></li><li><a href=https://pkg.go.dev/k8s.io/client-go/kubernetes>Godoc for the standard Kubernetes Client</a></li></ul><h3 id=authentication>Authentication</h3><p>This client uses the same authentication mechanisms as the Kubernetes API.</p><p>If you plan to run your code in the same cluster as the Code Blind install, have a look at the
<a href=https://github.com/kubernetes/client-go/tree/master/examples/in-cluster-client-configuration>in cluster configuration</a>
example from the Kubernetes Client.</p><p>If you plan to run your code outside the Kubernetes cluster as your Code Blind install,
look at the <a href=https://github.com/kubernetes/client-go/tree/master/examples/out-of-cluster-client-configuration>out of cluster configuration</a>
example from the Kubernetes client.</p><h3 id=example>Example</h3><p>The following is an example of a in-cluster configuration, that creates a <code>Clientset</code> for Code Blind
and then creates a <code>GameServer</code>.</p><p>A full example code is available in the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>example folder</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>	<span style=color:#4e9a06>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#4e9a06>&#34;context&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>agonesv1</span> <span style=color:#4e9a06>&#34;agones.dev/agones/pkg/apis/agones/v1&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#4e9a06>&#34;agones.dev/agones/pkg/client/clientset/versioned&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#4e9a06>&#34;agones.dev/agones/pkg/util/runtime&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#000>corev1</span> <span style=color:#4e9a06>&#34;k8s.io/api/core/v1&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#000>metav1</span> <span style=color:#4e9a06>&#34;k8s.io/apimachinery/pkg/apis/meta/v1&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#4e9a06>&#34;k8s.io/client-go/kubernetes&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#4e9a06>&#34;k8s.io/client-go/rest&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>config</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>rest</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>InClusterConfig</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>	<span style=color:#000>logger</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>runtime</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewLoggerWithSource</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;main&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Could not create in cluster config&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Access to standard Kubernetes resources through the Kubernetes Clientset
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#8f5902;font-style:italic>// We don&#39;t actually need this for this example, but it&#39;s just here for
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#8f5902;font-style:italic>// illustrative purposes
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>kubeClient</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>kubernetes</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewForConfig</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>config</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Could not create the kubernetes clientset&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Access to the Code Blind resources through the Code Blind Clientset
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#8f5902;font-style:italic>// Note that we reuse the same config as we used for the Kubernetes Clientset
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>agonesClient</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>versioned</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewForConfig</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>config</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Could not create the agones api clientset&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Create a GameServer
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>gs</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>agonesv1</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GameServer</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>ObjectMeta</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>metav1</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ObjectMeta</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>GenerateName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;simple-game-server&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Namespace</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;default&#34;</span><span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Spec</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>agonesv1</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GameServerSpec</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>Container</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;simple-game-server&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#000>Ports</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#000>agonesv1</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GameServerPort</span><span style=color:#000;font-weight:700>{{</span>
</span></span><span style=display:flex><span>				<span style=color:#000>ContainerPort</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>7654</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>				<span style=color:#000>HostPort</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>7654</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>				<span style=color:#000>Name</span><span style=color:#000;font-weight:700>:</span>          <span style=color:#4e9a06>&#34;gameport&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>				<span style=color:#000>PortPolicy</span><span style=color:#000;font-weight:700>:</span>    <span style=color:#000>agonesv1</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Static</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>				<span style=color:#000>Protocol</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#000>corev1</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ProtocolUDP</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>			<span style=color:#000;font-weight:700>}},</span>
</span></span><span style=display:flex><span>			<span style=color:#000>Template</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>corev1</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>PodTemplateSpec</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>				<span style=color:#000>Spec</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>corev1</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>PodSpec</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>					<span style=color:#000>Containers</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#000>corev1</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Container</span><span style=color:#000;font-weight:700>{{</span><span style=color:#000>Name</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;simple-game-server&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Image</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;us-docker.pkg.dev/codeblind/examples/simple-server:0.27&#34;</span><span style=color:#000;font-weight:700>}},</span>
</span></span><span style=display:flex><span>				<span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>			<span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#000>newGS</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>agonesClient</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>AgonesV1</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>GameServers</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;default&#34;</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>Create</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>TODO</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#000>gs</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>metav1</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>CreateOptions</span><span style=color:#000;font-weight:700>{})</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;New game servers&#39; name is: %s&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>newGS</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ObjectMeta</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Name</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>In order to create GS using provided example, you can run it as a Kubernetes Job:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/crd-client/create-gs.yaml --namespace agones-system
</span></span><span style=display:flex><span>kubectl get pods --namespace agones-system
</span></span></code></pre></div><pre tabindex=0><code>NAME                                 READY   STATUS      RESTARTS   AGE
create-gs-6wz86-7qsm5                0/1     Completed   0          6s
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl logs create-gs-6wz86-7qsm5  --namespace agones-system
</span></span></code></pre></div><pre tabindex=0><code>{&#34;message&#34;:&#34;\u0026{0xc0001dde00 default}&#34;,&#34;severity&#34;:&#34;info&#34;,&#34;source&#34;:&#34;main&#34;,&#34;time&#34;:&#34;2020-04-21T11:14:00.477576428Z&#34;}
{&#34;message&#34;:&#34;New GameServer name is: helm-test-server-fxfgg&#34;,&#34;severity&#34;:&#34;info&#34;,&#34;time&#34;:&#34;2020-04-21T11:14:00.516024697Z&#34;}
</code></pre><p>You have just created a GameServer using Kubernetes Go Client.</p><h2 id=best-practice-using-informers-and-listers>Best Practice: Using Informers and Listers</h2><p>Almost all Kubernetes&rsquo; controllers and custom controllers utilise <code>Informers</code> and <code>Listers</code>
to reduce the load on the Kubernetes&rsquo;s control plane.</p><p>Repetitive, direct access of the Kubernetes control plane API can significantly
reduce the performance of the cluster &ndash; and Informers and Listers help resolving that issue.</p><p>Informers and Listers reduce the load on the Kubernetes control plane
by creating, using and maintaining an eventually consistent an in-memory cache.
This can be watched and also queried with zero cost, since it will only read against
its in-memory model of the Kubernetes resources.</p><p>Informer&rsquo;s role and Lister&rsquo;s role are different.</p><p>An Informer is the mechanism for watching a Kubernetes object&rsquo;s event,
such that when a Kubernetes object changes(e.g. CREATE,UPDATE,DELETE), the Informer is informed,
and can execute a callback with the relevant object as an argument.</p><p>This can be very useful for building event based systems against the Kubernetes API.</p><p>A Lister is the mechanism for querying Kubernetes object&rsquo;s against the client side in-memory cache.
Since the Lister stores objects in an in-memory cache, queries against a come at practically no cost.</p><p>Of course, Code Blind itself also uses Informers and Listers in its codebase.</p><h3 id=example-1>Example</h3><p>The following is an example of Informers and Listers,
that show the GameServer&rsquo;s name & status & IPs in the Kubernetes cluster.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>	<span style=color:#4e9a06>&#34;context&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#4e9a06>&#34;time&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#4e9a06>&#34;agones.dev/agones/pkg/client/clientset/versioned&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#4e9a06>&#34;agones.dev/agones/pkg/client/informers/externalversions&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#4e9a06>&#34;agones.dev/agones/pkg/util/runtime&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#4e9a06>&#34;k8s.io/apimachinery/pkg/labels&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#4e9a06>&#34;k8s.io/client-go/informers&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#4e9a06>&#34;k8s.io/client-go/kubernetes&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#4e9a06>&#34;k8s.io/client-go/tools/cache&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>config</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>rest</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>InClusterConfig</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>	<span style=color:#000>logger</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>runtime</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewLoggerWithSource</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;main&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Could not create in cluster config&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#000>kubeClient</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>kubernetes</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewForConfig</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>config</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000>agonesClient</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>versioned</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewForConfig</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>config</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Could not create the agones api clientset&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Create InformerFactory which create the informer
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>informerFactory</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>informers</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewSharedInformerFactory</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>kubeClient</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#0000cf;font-weight:700>30</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000>agonesInformerFactory</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>externalversions</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewSharedInformerFactory</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>agonesClient</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#0000cf;font-weight:700>30</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Create Pod informer by informerFactory
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>podInformer</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>informerFactory</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Core</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>V1</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>Pods</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Create GameServer informer by informerFactory
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>gameServers</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>agonesInformerFactory</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Code</span> <span style=color:#000>Blind</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>V1</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>GameServers</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>	<span style=color:#000>gsInformer</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>gameServers</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Informer</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Add EventHandler to informer
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#8f5902;font-style:italic>// When the object&#39;s event happens, the function will be called
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#8f5902;font-style:italic>// For example, when the pod is added, &#39;AddFunc&#39; will be called and put out the &#34;Pod Added&#34;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>podInformer</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Informer</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>AddEventHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>cache</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ResourceEventHandlerFuncs</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>AddFunc</span><span style=color:#000;font-weight:700>:</span>    <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>new</span> <span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{})</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Pod Added&#34;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>		<span style=color:#000>UpdateFunc</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>old</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>new</span> <span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{})</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Pod Updated&#34;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>		<span style=color:#000>DeleteFunc</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>old</span> <span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{})</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Pod Deleted&#34;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span>	<span style=color:#000>gsInformer</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>AddEventHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>cache</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ResourceEventHandlerFuncs</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>AddFunc</span><span style=color:#000;font-weight:700>:</span>    <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>new</span> <span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{})</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;GameServer Added&#34;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>		<span style=color:#000>UpdateFunc</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>old</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>new</span> <span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{})</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;GameServer Updated&#34;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>		<span style=color:#000>DeleteFunc</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>old</span> <span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{})</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;GameServer Deleted&#34;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Background</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Start Go routines for informer
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>informerFactory</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Start</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Done</span><span style=color:#000;font-weight:700>())</span>
</span></span><span style=display:flex><span>	<span style=color:#000>agonesInformerFactory</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Start</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Done</span><span style=color:#000;font-weight:700>())</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Wait until finish caching with List API
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>informerFactory</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WaitForCacheSync</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Done</span><span style=color:#000;font-weight:700>())</span>
</span></span><span style=display:flex><span>	<span style=color:#000>agonesInformerFactory</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WaitForCacheSync</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Done</span><span style=color:#000;font-weight:700>())</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// Create Lister which can list objects from the in-memory-cache
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>podLister</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>podInformer</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Lister</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>	<span style=color:#000>gsLister</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>gameServers</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Lister</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>for</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>// Get List objects of Pods from Pod Lister
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>p</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>podLister</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Pods</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;default&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>// Get List objects of GameServers from GameServer Lister
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#000>gs</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>gsLister</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>List</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>labels</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Everything</span><span style=color:#000;font-weight:700>())</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#8f5902;font-style:italic>// Show GameServer&#39;s name &amp; status &amp; IPs
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>		<span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>_</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>g</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87;font-weight:700>range</span> <span style=color:#000>gs</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>p</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Get</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>g</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GetName</span><span style=color:#000;font-weight:700>())</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>			<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>			<span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;------------------------------&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>			<span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Name: %s&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>g</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GetName</span><span style=color:#000;font-weight:700>())</span>
</span></span><span style=display:flex><span>			<span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Status: %s&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>g</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Status</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>State</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>			<span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;External IP: %s&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>g</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Status</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Address</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>			<span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Internal IP: %s&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>a</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Status</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>PodIP</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>		<span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Sleep</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#0000cf;font-weight:700>25</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>You can list GameServer&rsquo;s name and status and IPs using Kubernetes Informers and Listers.</p><h2 id=direct-access-to-the-rest-api-via-kubectl>Direct Access to the REST API via Kubectl</h2><p>If there isn&rsquo;t a client written in your preferred language, it is always possible to communicate
directly with Kubernetes API to interact with Code Blind.</p><p>The Kubernetes API can be authenticated and exposed locally through the
<a href=https://kubernetes.io/docs/tasks/extend-kubernetes/http-proxy-access-api/><code>kubectl proxy</code></a></p><p>For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl proxy <span style=color:#000;font-weight:700>&amp;</span>
</span></span></code></pre></div><pre tabindex=0><code>Starting to serve on 127.0.0.1:8001
</code></pre><h3 id=list-all-code-blind-endpoints>List all Code Blind endpoints</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl http://localhost:8001/apis <span style=color:#000;font-weight:700>|</span> grep agones -A <span style=color:#0000cf;font-weight:700>5</span> -B <span style=color:#0000cf;font-weight:700>5</span>
</span></span></code></pre></div><pre tabindex=0><code>{
    &#34;name&#34;: &#34;agones.dev&#34;,
    &#34;versions&#34;: [
    {
        &#34;groupVersion&#34;: &#34;agones.dev/v1&#34;,
        &#34;version&#34;: &#34;v1&#34;
    }
    ],
    &#34;preferredVersion&#34;: {
    &#34;groupVersion&#34;: &#34;agones.dev/v1&#34;,
    &#34;version&#34;: &#34;v1&#34;
    },
    &#34;serverAddressByClientCIDRs&#34;: null
}
</code></pre><h3 id=list-code-blind-resources>List Code Blind resources</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl http://localhost:8001/apis/agones.dev/v1
</span></span></code></pre></div><pre tabindex=0><code>{
  &#34;kind&#34;: &#34;APIResourceList&#34;,
  &#34;apiVersion&#34;: &#34;v1&#34;,
  &#34;groupVersion&#34;: &#34;agones.dev/v1&#34;,
  &#34;resources&#34;: [
    {
      &#34;name&#34;: &#34;gameservers&#34;,
      &#34;singularName&#34;: &#34;gameserver&#34;,
      &#34;namespaced&#34;: true,
      &#34;kind&#34;: &#34;GameServer&#34;,
      &#34;verbs&#34;: [
        &#34;delete&#34;,
        &#34;deletecollection&#34;,
        &#34;get&#34;,
        &#34;list&#34;,
        &#34;patch&#34;,
        &#34;create&#34;,
        &#34;update&#34;,
        &#34;watch&#34;
      ],
      &#34;shortNames&#34;: [
        &#34;gs&#34;
      ]
    }
  ]
}
</code></pre><h3 id=list-all-gameservers-in-the-default-namespace>List all gameservers in the default namespace</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl http://localhost:8001/apis/agones.dev/v1/namespaces/default/gameservers
</span></span></code></pre></div><pre tabindex=0><code>{
    &#34;apiVersion&#34;: &#34;agones.dev/v1&#34;,
    &#34;items&#34;: [
        {
            &#34;apiVersion&#34;: &#34;agones.dev/v1&#34;,
            &#34;kind&#34;: &#34;GameServer&#34;,
            &#34;metadata&#34;: {
                &#34;annotations&#34;: {
                    &#34;kubectl.kubernetes.io/last-applied-configuration&#34;: &#34;{\&#34;apiVersion\&#34;:\&#34;agones.dev/v1\&#34;,\&#34;kind\&#34;:\&#34;GameServer\&#34;,\&#34;metadata\&#34;:{\&#34;annotations\&#34;:{},\&#34;name\&#34;:\&#34;simple-game-server\&#34;,\&#34;namespace\&#34;:\&#34;default\&#34;},\&#34;spec\&#34;:{\&#34;containerPort\&#34;:7654,\&#34;hostPort\&#34;:7777,\&#34;portPolicy\&#34;:\&#34;static\&#34;,\&#34;template\&#34;:{\&#34;spec\&#34;:{\&#34;containers\&#34;:[{\&#34;image\&#34;:\&#34;us-docker.pkg.dev/codeblind/examples/simple-server:0.27\&#34;,\&#34;name\&#34;:\&#34;simple-game-server\&#34;}]}}}}\n&#34;
                },
                &#34;clusterName&#34;: &#34;&#34;,
                &#34;creationTimestamp&#34;: &#34;2018-03-02T21:41:05Z&#34;,
                &#34;finalizers&#34;: [
                    &#34;agones.dev&#34;
                ],
                &#34;generation&#34;: 0,
                &#34;name&#34;: &#34;simple-game-server&#34;,
                &#34;namespace&#34;: &#34;default&#34;,
                &#34;resourceVersion&#34;: &#34;760&#34;,
                &#34;selfLink&#34;: &#34;/apis/agones.dev/v1/namespaces/default/gameservers/simple-game-server&#34;,
                &#34;uid&#34;: &#34;692beea6-1e62-11e8-beb2-080027637781&#34;
            },
            &#34;spec&#34;: {
                &#34;PortPolicy&#34;: &#34;Static&#34;,
                &#34;container&#34;: &#34;simple-game-server&#34;,
                &#34;containerPort&#34;: 7654,
                &#34;health&#34;: {
                    &#34;failureThreshold&#34;: 3,
                    &#34;initialDelaySeconds&#34;: 5,
                    &#34;periodSeconds&#34;: 5
                },
                &#34;hostPort&#34;: 7777,
                &#34;protocol&#34;: &#34;UDP&#34;,
                &#34;template&#34;: {
                    &#34;metadata&#34;: {
                        &#34;creationTimestamp&#34;: null
                    },
                    &#34;spec&#34;: {
                        &#34;containers&#34;: [
                            {
                                &#34;image&#34;: &#34;us-docker.pkg.dev/codeblind/examples/simple-server:0.27&#34;,
                                &#34;name&#34;: &#34;simple-game-server&#34;,
                                &#34;resources&#34;: {}
                            }
                        ]
                    }
                }
            },
            &#34;status&#34;: {
                &#34;address&#34;: &#34;192.168.99.100&#34;,
                &#34;nodeName&#34;: &#34;agones&#34;,
                &#34;port&#34;: 7777,
                &#34;state&#34;: &#34;Ready&#34;
            }
        }
    ],
    &#34;kind&#34;: &#34;GameServerList&#34;,
    &#34;metadata&#34;: {
        &#34;continue&#34;: &#34;&#34;,
        &#34;resourceVersion&#34;: &#34;1062&#34;,
        &#34;selfLink&#34;: &#34;/apis/agones.dev/v1/namespaces/default/gameservers&#34;
    }
}
</code></pre><h3 id=allocate-a-gameserver-from-a-fleet-named-simple-game-server-with-gameserverallocation>Allocate a gameserver from a fleet named &lsquo;simple-game-server&rsquo;, with GameServerAllocation</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#39;{&#34;apiVersion&#34;:&#34;allocation.agones.dev/v1&#34;,&#34;kind&#34;:&#34;GameServerAllocation&#34;,&#34;spec&#34;:{&#34;required&#34;:{&#34;matchLabels&#34;:{&#34;agones.dev/fleet&#34;:&#34;simple-game-server&#34;}}}}&#39;</span> -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X POST http://localhost:8001/apis/allocation.agones.dev/v1/namespaces/default/gameserverallocations
</span></span></code></pre></div><pre tabindex=0><code>{
    &#34;kind&#34;: &#34;GameServerAllocation&#34;,
    &#34;apiVersion&#34;: &#34;allocation.agones.dev/v1&#34;,
    &#34;metadata&#34;: {
        &#34;name&#34;: &#34;simple-game-server-v6jwb-cmdcv&#34;,
        &#34;namespace&#34;: &#34;default&#34;,
        &#34;creationTimestamp&#34;: &#34;2019-07-03T17:19:47Z&#34;
    },
    &#34;spec&#34;: {
        &#34;multiClusterSetting&#34;: {
            &#34;policySelector&#34;: {}
        },
        &#34;required&#34;: {
            &#34;matchLabels&#34;: {
                &#34;agones.dev/fleet&#34;: &#34;simple-game-server&#34;
            }
        },
        &#34;scheduling&#34;: &#34;Packed&#34;,
        &#34;metadata&#34;: {}
    },
    &#34;status&#34;: {
        &#34;state&#34;: &#34;Allocated&#34;,
        &#34;gameServerName&#34;: &#34;simple-game-server-v6jwb-cmdcv&#34;,
        &#34;ports&#34;: [
            {
                &#34;name&#34;: &#34;default&#34;,
                &#34;port&#34;: 7445
            }
        ],
        &#34;address&#34;: &#34;34.94.118.237&#34;,
        &#34;nodeName&#34;: &#34;gke-test-cluster-default-f11755a7-5km3&#34;
    }
}
</code></pre><p>You may wish to review the <a href=http://localhost:1313/docs/reference/agones_crd_api_reference/>Code Blind Kubernetes API</a> for the full data structure reference.</p><p>The <a href=https://kubernetes.io/docs/reference/using-api/api-concepts/>Kubernetes API Concepts</a>
section may also provide the more details on the API conventions that are used in the Kubernetes API.</p><h2 id=next-steps>Next Steps</h2><ul><li>Learn how to use <a href=/docs/advanced/allocator-service/>Allocator Service</a> for single and multi-cluster Allocation.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-48e070a0265c9a00bbcc2563e96ed22c>12 - Troubleshooting</h1><div class=lead>Troubleshooting guides and steps.</div><h2 id=something-went-wrong-with-my-gameserver>Something went wrong with my GameServer</h2><p>If there is something going wrong with your GameServer, there are a few approaches to determining the cause:</p><h3 id=run-with-the-local-sdk-server>Run with the local SDK server</h3><p>A good first step for seeing what may be going wrong is replicating the issue locally. To do this you can take
advantage of the Code Blind <a href=http://localhost:1313/docs/guides/local-game-server/>local SDK server</a>
, with the following troubleshooting steps:</p><ol><li>Run your game server as a local binary against the local SDK server</li><li>Run your game server container against the local SDK server. It&rsquo;s worth noting that running with
<code>docker run --network=host ...</code> can be an easy way to allow your game server container(s) access to the local SDK
server)</li></ol><p>At each stage, keep an eye on the logs of your game server binary, and the local SDK server, and ensure there are no system
errors.</p><h3 id=run-as-a-gameserver-rather-than-a-fleet>Run as a <code>GameServer</code> rather than a <code>Fleet</code></h3><p>A <code>Fleet</code> will automatically replace any unhealthy <code>GameServer</code> under its control - which can make it hard to catch
all the details to determine the cause.</p><p>To work around this, instantiate a single instance of your game server as a<br><a href=http://localhost:1313/docs/reference/gameserver/>GameServer</a> within your Code Blind cluster.</p><p>This <code>GameServer</code> will not be replaced if it moves to an Unhealthy state, giving you time to introspect what is
going wrong.</p><h3 id=introspect-with-kubernetes-tooling>Introspect with Kubernetes tooling</h3><p>There are many Kubernetes tools that will help with determining where things have potentially gone wrong for your
game server. Here are a few you may want to try.</p><h4 id=kubectl-describe>kubectl describe</h4><p>Depending on what is happening, you may want to run <code>kubectl describe &lt;gameserver name></code> to view the events
that are associated with that particular <code>GameServer</code> resource. This can give you insight into the lifecycle of the
<code>GameServer</code> and if anything has gone wrong.</p><p>For example, here we can see where the simple-game-server example has been moved to the <code>Unhealthy</code> state
due to a crash in the backing <code>GameServer</code> Pod container&rsquo;s binary.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe gs simple-game-server-zqppv
</span></span></code></pre></div><pre tabindex=0><code>Name:         simple-game-server-zqppv
Namespace:    default
Labels:       &lt;none&gt;
Annotations:  agones.dev/sdk-version: 1.0.0-dce1546
API Version:  agones.dev/v1
Kind:         GameServer
Metadata:
  Creation Timestamp:  2019-08-16T21:25:44Z
  Finalizers:
    agones.dev
  Generate Name:     simple-game-server-
  Generation:        1
  Resource Version:  1378575
  Self Link:         /apis/agones.dev/v1/namespaces/default/gameservers/simple-game-server-zqppv
  UID:               6818adc7-c06c-11e9-8dbd-42010a8a0109
Spec:
  Container:  simple-game-server
  Health:
    Failure Threshold:      3
    Initial Delay Seconds:  5
    Period Seconds:         5
  Ports:
    Container Port:  7654
    Host Port:       7058
    Name:            default
    Port Policy:     Dynamic
    Protocol:        UDP
  Scheduling:        Packed
  Template:
    Metadata:
      Creation Timestamp:  &lt;nil&gt;
    Spec:
      Containers:
        Image:  us-docker.pkg.dev/codeblind/examples/simple-server:0.27
        Name:   simple-game-server
        Resources:
          Limits:
            Cpu:     20m
            Memory:  32Mi
          Requests:
            Cpu:     20m
            Memory:  32Mi
Status:
  Address:    35.230.59.117
  Node Name:  gke-test-cluster-default-590db5e4-4s6r
  Ports:
    Name:          default
    Port:          7058
  Reserved Until:  &lt;nil&gt;
  State:           Unhealthy
Events:
  Type     Reason          Age   From                   Message
  ----     ------          ----  ----                   -------
  Normal   PortAllocation  72s   gameserver-controller  Port allocated
  Normal   Creating        72s   gameserver-controller  Pod simple-game-server-zqppv created
  Normal   Scheduled       72s   gameserver-controller  Address and port populated
  Normal   RequestReady    67s   gameserver-sidecar     SDK state change
  Normal   Ready           66s   gameserver-controller  SDK.Ready() complete
  Warning  Unhealthy       34s   health-controller      Issue with Gameserver pod
</code></pre><p>The backing Pod has the same name as the <code>GameServer</code> - so it&rsquo;s also worth looking at the
details and events for the Pod to see if there are any issues there, such as restarts due to binary crashes etc.</p><p>For example, you can see the restart count on the us-docker.pkg.dev/codeblind/examples/simple-server:0.27 container
is set to <code>1</code>, due to the game server binary crash</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe pod simple-game-server-zqppv
</span></span></code></pre></div><pre tabindex=0><code>Name:               simple-game-server-zqppv
Namespace:          default
Priority:           0
PriorityClassName:  &lt;none&gt;
Node:               gke-test-cluster-default-590db5e4-4s6r/10.138.0.23
Start Time:         Fri, 16 Aug 2019 21:25:44 +0000
Labels:             agones.dev/gameserver=simple-game-server-zqppv
                    agones.dev/role=gameserver
Annotations:        agones.dev/container: simple-game-server
                    agones.dev/sdk-version: 1.0.0-dce1546
                    cluster-autoscaler.kubernetes.io/safe-to-evict: false
Status:             Running
IP:                 10.48.1.80
Controlled By:      GameServer/simple-game-server-zqppv
Containers:
  simple-game-server:
    Container ID:   docker://69eacd03cc89b0636b78abe47926b02183ba84d18fa20649ca443f5232511661
    Image:          us-docker.pkg.dev/codeblind/examples/simple-server:0.27
    Image ID:       docker-pullable://gcr.io/agones-images/simple-game-server@sha256:6a60eff5e68b88b5ce75ae98082d79cff36cda411a090f3495760e5c3b6c3575
    Port:           7654/UDP
    Host Port:      7058/UDP
    State:          Running
      Started:      Fri, 16 Aug 2019 21:26:22 +0000
    Last State:     Terminated
      Reason:       Completed
      Exit Code:    0
      Started:      Fri, 16 Aug 2019 21:25:45 +0000
      Finished:     Fri, 16 Aug 2019 21:26:22 +0000
    Ready:          True
    Restart Count:  1
    Limits:
      cpu:     20m
      memory:  32Mi
    Requests:
      cpu:        20m
      memory:     32Mi
    Liveness:     http-get http://:8080/gshealthz delay=5s timeout=1s period=5s #success=1 #failure=3
    Environment:  &lt;none&gt;
    Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from empty (ro)
  agones-gameserver-sidecar:
    Container ID:   docker://f3c475c34d26232e19b60be65b03bc6ce41931f4c37e00770d3ab4a36281d31c
    Image:          gcr.io/agones-mark/agones-sdk:1.0.0-dce1546
    Image ID:       docker-pullable://gcr.io/agones-mark/agones-sdk@sha256:4b5693e95ee3023a2b2e2099d102bb6bac58d4ce0ac472e58a09cee6d160cd19
    Port:           &lt;none&gt;
    Host Port:      &lt;none&gt;
    State:          Running
      Started:      Fri, 16 Aug 2019 21:25:48 +0000
    Ready:          True
    Restart Count:  0
    Requests:
      cpu:     30m
    Liveness:  http-get http://:8080/healthz delay=3s timeout=1s period=3s #success=1 #failure=3
    Environment:
      GAMESERVER_NAME:  simple-game-server-zqppv
      POD_NAMESPACE:    default (v1:metadata.namespace)
    Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from agones-sdk-token-vr6qq (ro)
Conditions:
  Type              Status
  Initialized       True
  Ready             True
  ContainersReady   True
  PodScheduled      True
Volumes:
  empty:
    Type:    EmptyDir (a temporary directory that shares a pod&#39;s lifetime)
    Medium:
  agones-sdk-token-vr6qq:
    Type:        Secret (a volume populated by a Secret)
    SecretName:  agones-sdk-token-vr6qq
    Optional:    false
QoS Class:       Burstable
Node-Selectors:  &lt;none&gt;
Tolerations:     node.kubernetes.io/not-ready:NoExecute for 300s
                 node.kubernetes.io/unreachable:NoExecute for 300s
Events:
  Type    Reason     Age                   From                                             Message
  ----    ------     ----                  ----                                             -------
  Normal  Scheduled  2m32s                 default-scheduler                                Successfully assigned default/simple-game-server-zqppv to gke-test-cluster-default-590db5e4-4s6r
  Normal  Pulling    2m31s                 kubelet, gke-test-cluster-default-590db5e4-4s6r  pulling image &#34;gcr.io/agones-mark/agones-sdk:1.0.0-dce1546&#34;
  Normal  Started    2m28s                 kubelet, gke-test-cluster-default-590db5e4-4s6r  Started container
  Normal  Pulled     2m28s                 kubelet, gke-test-cluster-default-590db5e4-4s6r  Successfully pulled image &#34;gcr.io/agones-mark/agones-sdk:1.0.0-dce1546&#34;
  Normal  Created    2m28s                 kubelet, gke-test-cluster-default-590db5e4-4s6r  Created container
  Normal  Created    114s (x2 over 2m31s)  kubelet, gke-test-cluster-default-590db5e4-4s6r  Created container
  Normal  Started    114s (x2 over 2m31s)  kubelet, gke-test-cluster-default-590db5e4-4s6r  Started container
  Normal  Pulled     114s (x2 over 2m31s)  kubelet, gke-test-cluster-default-590db5e4-4s6r  Container image &#34;us-docker.pkg.dev/codeblind/examples/simple-server:0.27&#34; already present on machine
</code></pre><p>Finally, you can also get the logs of your <code>GameServer</code> <code>Pod</code> as well via <code>kubectl logs &lt;pod name> -c &lt;game server container name></code>, for example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl logs simple-game-server-zqppv -c simple-game-server
</span></span></code></pre></div><pre tabindex=0><code>2019/08/16 21:26:23 Creating SDK instance
2019/08/16 21:26:24 Starting Health Ping
2019/08/16 21:26:24 Starting UDP server, listening on port 7654
2019/08/16 21:26:24 Marking this server as ready
</code></pre><p>The above commands will only give the most recent container&rsquo;s logs (so we won&rsquo;t get the previous crash), but
you can use <code>kubectl logs --previous=true simple-game-server-zqppv -c simple-game-server</code> to get the previous instance of the containers logs, or
use your Kubernetes platform of choice&rsquo;s logging aggregation tools to view the crash details.</p><h4 id=kubectl-events>kubectl events</h4><p>The &ldquo;Events&rdquo; section that is seen at the bottom of a <code>kubectl describe</code> is backed an actual <code>Event</code> record in
Kubernetes, which can be queried - and is general persistent for an hour after it is created.</p><p>Therefore, even a <code>GameServer</code> or <code>Pod</code> resource is no longer available in the system, its <code>Events</code> may well be.</p><p><code>kubectl get events</code> can be used to see all these events. This can also be grepped with the GameServer name to see
all events across both the <code>GameServer</code> and its backing <code>Pod</code>, like so:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get events <span style=color:#000;font-weight:700>|</span> grep simple-game-server-v992s-jwpx2
</span></span></code></pre></div><pre tabindex=0><code>2m47s       Normal   PortAllocation          gameserver/simple-game-server-v992s-jwpx2   Port allocated
2m47s       Normal   Creating                gameserver/simple-game-server-v992s-jwpx2   Pod simple-game-server-v992s-jwpx2 created
2m47s       Normal   Scheduled               pod/simple-game-server-v992s-jwpx2          Successfully assigned default/simple-game-server-v992s-jwpx2 to gke-test-cluster-default-77e7f57d-j1mp
2m47s       Normal   Scheduled               gameserver/simple-game-server-v992s-jwpx2   Address and port populated
2m46s       Normal   Pulled                  pod/simple-game-server-v992s-jwpx2          Container image &#34;us-docker.pkg.dev/codeblind/examples/simple-server:0.27&#34; already present on machine
2m46s       Normal   Created                 pod/simple-game-server-v992s-jwpx2          Created container simple-game-server
2m45s       Normal   Started                 pod/simple-game-server-v992s-jwpx2          Started container simple-game-server
2m45s       Normal   Pulled                  pod/simple-game-server-v992s-jwpx2          Container image &#34;gcr.io/agones-images/agones-sdk:1.7.0&#34; already present on machine
2m45s       Normal   Created                 pod/simple-game-server-v992s-jwpx2          Created container agones-gameserver-sidecar
2m45s       Normal   Started                 pod/simple-game-server-v992s-jwpx2          Started container agones-gameserver-sidecar
2m45s       Normal   RequestReady            gameserver/simple-game-server-v992s-jwpx2   SDK state change
2m45s       Normal   Ready                   gameserver/simple-game-server-v992s-jwpx2   SDK.Ready() complete
2m47s       Normal   SuccessfulCreate        gameserverset/simple-game-server-v992s      Created gameserver: simple-game-server-v992s-jwpx2
</code></pre><h4 id=other-techniques>Other techniques</h4><p>For more tips and tricks, the <a href=https://kubernetes.io/docs/reference/kubectl/cheatsheet/#interacting-with-running-pods>Kubernetes Cheatsheet: Interactive with Pods</a>
also provides more troubleshooting techniques.</p><h2 id=how-do-i-see-the-logs-for-code-blind>How do I see the logs for Code Blind?</h2><p>If something is going wrong, and you want to see the logs for Code Blind, there are potentially two places you will want to
check:</p><ol><li>The controller: assuming you installed Code Blind in the <code>agones-system</code> namespace, you will find that there
is a single pod called <code>agones-controller-&lt;hash></code> (where hash is the unique code that Kubernetes generates)
that exists there, that you can get the logs from. This is the main
controller for Code Blind, and should be the first place to check when things go wrong.<ol><li>To get the logs from this controller run:<br><code>kubectl logs --namespace=agones-system agones-controller-&lt;hash></code></li></ol></li><li>The SDK server sidecar: Code Blind runs a small <a href=https://grpc.io/>gRPC</a> + http server for the SDK in a container in the
same network namespace as the game server container to connect to via the SDK.<br>The logs from this SDK server are also useful for tracking down issues, especially if you are having trouble with a
particular <code>GameServer</code>.<ol><li>To find the <code>Pod</code> for the <code>GameServer</code> look for the pod with a name that is prefixed with the name of the
owning <code>GameServer</code>. For example if you have a <code>GameServer</code> named <code>simple-game-server</code>, it&rsquo;s pod could potentially be named
<code>simple-game-server-dnbwj</code>.</li><li>To get the logs from that <code>Pod</code>, we need to specify that we want the logs from the <code>agones-gameserver-sidecar</code>
container. To do that, run the following:<br><code>kubectl logs simple-game-server-dnbwj -c agones-gameserver-sidecar</code></li></ol></li></ol><p>Code Blind uses JSON structured logging, therefore errors will be visible through the <code>"severity":"info"</code> key and value.</p><h3 id=enable-debug-level-logging-for-the-sdk-server>Enable Debug Level Logging for the SDK Server</h3><p>By default, the SDK Server binary is set to an <code>Info</code> level of logging.</p><p>You can use the <code>sdkServer.logLevel</code> to increase this to <code>Debug</code> levels, and see extra information about what is
happening with the SDK Server that runs alonside your game server container(s).</p><p>See the <a href=http://localhost:1313/docs/reference/gameserver/>GameServer reference</a> for configuration details.</p><h3 id=enable-debug-level-logging-for-the-code-blind-controller>Enable Debug Level Logging for the Code Blind Controller</h3><p>By default, the log level for the Code Blind controller is &ldquo;info&rdquo;. To get a more verbose log output, switch this to &ldquo;debug&rdquo;
via the <code>agones.controller.logLevel</code>
<a href=http://localhost:1313/docs/installation/install-agones/helm/#configuration>Helm Configuration parameters</a>
at installation.</p><h2 id=the-feature-flag-i-enableddisabled-isnt-working-as-expected>The Feature Flag I enabled/disabled isn&rsquo;t working as expected</h2><p>It&rsquo;s entirely possible that Alpha features may still have bugs in them (They are <em>alpha</em> after all 😃), but the first
thing to check is what the actual <a href=/docs/guides/feature-stages/#feature-gates>Feature Flags</a> states
were passed to Code Blind are, and that they were set correctly.</p><p>The easiest way is to check the top <code>info</code> level log lines from the Code Blind controller.</p><p>For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ kubectl logs -n agones-system agones-controller-7575dc59-7p2rg  <span style=color:#000;font-weight:700>|</span> head
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>{</span><span style=color:#4e9a06>&#34;filename&#34;</span>:<span style=color:#4e9a06>&#34;/home/agones/logs/agones-controller-20220615_211540.log&#34;</span>,<span style=color:#4e9a06>&#34;message&#34;</span>:<span style=color:#4e9a06>&#34;logging to file&#34;</span>,<span style=color:#4e9a06>&#34;numbackups&#34;</span>:99,<span style=color:#4e9a06>&#34;severity&#34;</span>:<span style=color:#4e9a06>&#34;info&#34;</span>,<span style=color:#4e9a06>&#34;source&#34;</span>:<span style=color:#4e9a06>&#34;main&#34;</span>,<span style=color:#4e9a06>&#34;time&#34;</span>:<span style=color:#4e9a06>&#34;2022-06-15T21:15:40.309349789Z&#34;</span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>{</span><span style=color:#4e9a06>&#34;logLevel&#34;</span>:<span style=color:#4e9a06>&#34;info&#34;</span>,<span style=color:#4e9a06>&#34;message&#34;</span>:<span style=color:#4e9a06>&#34;Setting LogLevel configuration&#34;</span>,<span style=color:#4e9a06>&#34;severity&#34;</span>:<span style=color:#4e9a06>&#34;info&#34;</span>,<span style=color:#4e9a06>&#34;source&#34;</span>:<span style=color:#4e9a06>&#34;main&#34;</span>,<span style=color:#4e9a06>&#34;time&#34;</span>:<span style=color:#4e9a06>&#34;2022-06-15T21:15:40.309403296Z&#34;</span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>{</span><span style=color:#4e9a06>&#34;ctlConf&#34;</span>:<span style=color:#ce5c00;font-weight:700>{</span><span style=color:#4e9a06>&#34;MinPort&#34;</span>:7000,<span style=color:#4e9a06>&#34;MaxPort&#34;</span>:8000,<span style=color:#4e9a06>&#34;SidecarImage&#34;</span>:<span style=color:#4e9a06>&#34;gcr.io/agones-images/agones-sdk:1.23.0&#34;</span>,<span style=color:#4e9a06>&#34;SidecarCPURequest&#34;</span>:<span style=color:#4e9a06>&#34;30m&#34;</span>,<span style=color:#4e9a06>&#34;SidecarCPULimit&#34;</span>:<span style=color:#4e9a06>&#34;0&#34;</span>,<span style=color:#4e9a06>&#34;SidecarMemoryRequest&#34;</span>:<span style=color:#4e9a06>&#34;0&#34;</span>,<span style=color:#4e9a06>&#34;SidecarMemoryLimit&#34;</span>:<span style=color:#4e9a06>&#34;0&#34;</span>,<span style=color:#4e9a06>&#34;SdkServiceAccount&#34;</span>:<span style=color:#4e9a06>&#34;agones-sdk&#34;</span>,<span style=color:#4e9a06>&#34;AlwaysPullSidecar&#34;</span>:false,<span style=color:#4e9a06>&#34;PrometheusMetrics&#34;</span>:true,<span style=color:#4e9a06>&#34;Stackdriver&#34;</span>:false,<span style=color:#4e9a06>&#34;StackdriverLabels&#34;</span>:<span style=color:#4e9a06>&#34;&#34;</span>,<span style=color:#4e9a06>&#34;KeyFile&#34;</span>:<span style=color:#4e9a06>&#34;/home/agones/certs/server.key&#34;</span>,<span style=color:#4e9a06>&#34;CertFile&#34;</span>:<span style=color:#4e9a06>&#34;/home/agones/certs/server.crt&#34;</span>,<span style=color:#4e9a06>&#34;KubeConfig&#34;</span>:<span style=color:#4e9a06>&#34;&#34;</span>,<span style=color:#4e9a06>&#34;GCPProjectID&#34;</span>:<span style=color:#4e9a06>&#34;&#34;</span>,<span style=color:#4e9a06>&#34;NumWorkers&#34;</span>:100,<span style=color:#4e9a06>&#34;APIServerSustainedQPS&#34;</span>:400,<span style=color:#4e9a06>&#34;APIServerBurstQPS&#34;</span>:500,<span style=color:#4e9a06>&#34;LogDir&#34;</span>:<span style=color:#4e9a06>&#34;/home/agones/logs&#34;</span>,<span style=color:#4e9a06>&#34;LogLevel&#34;</span>:<span style=color:#4e9a06>&#34;info&#34;</span>,<span style=color:#4e9a06>&#34;LogSizeLimitMB&#34;</span>:10000<span style=color:#ce5c00;font-weight:700>}</span>,<span style=color:#4e9a06>&#34;featureGates&#34;</span>:<span style=color:#4e9a06>&#34;Example=true\u0026NodeExternalDNS=true\u0026PlayerAllocationFilter=false\u0026PlayerTracking=false&#34;</span>,<span style=color:#4e9a06>&#34;message&#34;</span>:<span style=color:#4e9a06>&#34;starting gameServer operator...&#34;</span>,<span style=color:#4e9a06>&#34;severity&#34;</span>:<span style=color:#4e9a06>&#34;info&#34;</span>,<span style=color:#4e9a06>&#34;source&#34;</span>:<span style=color:#4e9a06>&#34;main&#34;</span>,<span style=color:#4e9a06>&#34;time&#34;</span>:<span style=color:#4e9a06>&#34;2022-06-15T21:15:40.309528802Z&#34;</span>,<span style=color:#4e9a06>&#34;version&#34;</span>:<span style=color:#4e9a06>&#34;1.23.0&#34;</span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>The <code>ctlConf</code> section has the full configuration for Code Blind as it was passed to the controller. Within that log line
there is a <code>featureGates</code> key, that has the full Feature Gate configuration as a URL Query String (<code>\u0026</code>
is JSON for <code>&</code>), so you can see if the Feature Gates are set as expected.</p><h2 id=i-uninstalled-code-blind-before-deleted-all-my-gameservers-and-now-they-wont-delete>I uninstalled Code Blind before deleted all my <code>GameServers</code> and now they won&rsquo;t delete</h2><p>Code Blind <code>GameServers</code> use <a href=https://kubernetes.io/docs/tasks/access-kubernetes-api/custom-resources/custom-resource-definitions/#finalizers>Finalizers</a>
to manage garbage collection of the <code>GameServers</code>. This means that if the Code Blind controller
doesn&rsquo;t remove the finalizer for you (i.e. if it has been uninstalled), it can be tricky to remove them all.</p><p>Thankfully, if we create a patch to remove the finalizers from all GameServers, we can delete them with impunity.</p><p>A quick one liner to do this:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get gameserver -o name <span style=color:#000;font-weight:700>|</span> xargs -n1 -P1 -I<span style=color:#ce5c00;font-weight:700>{}</span> kubectl patch <span style=color:#ce5c00;font-weight:700>{}</span> --type<span style=color:#ce5c00;font-weight:700>=</span>merge -p <span style=color:#4e9a06>&#39;{&#34;metadata&#34;: {&#34;finalizers&#34;: []}}&#39;</span>
</span></span></code></pre></div><p>Once this is done, you can <code>kubectl delete gs --all</code> and clean everything up (if it&rsquo;s not gone already).</p><h2 id=im-getting-forbidden-errors-when-trying-to-install-code-blind>I&rsquo;m getting Forbidden errors when trying to install Code Blind</h2><p>Ensure that you are running Kubernetes 1.12 or later, which does not require any special
clusterrolebindings to install Code Blind.</p><p>If you want to install Code Blind on an older version of Kubernetes, you need to create a
clusterrolebinding to add your identity as a cluster admin, e.g.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Kubernetes Engine</span>
</span></span><span style=display:flex><span>kubectl create clusterrolebinding cluster-admin-binding <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>  --clusterrole cluster-admin --user <span style=color:#4e9a06>`</span>gcloud config get-value account<span style=color:#4e9a06>`</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Minikube</span>
</span></span><span style=display:flex><span>kubectl create clusterrolebinding cluster-admin-binding <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>  --clusterrole<span style=color:#ce5c00;font-weight:700>=</span>cluster-admin --serviceaccount<span style=color:#ce5c00;font-weight:700>=</span>kube-system:default
</span></span></code></pre></div><p>On GKE, <code>gcloud config get-value accounts</code> will return a lowercase email address, so if
you are using a CamelCase email, you may need to type it in manually.</p><h2 id=im-getting-stuck-in-terminating-when-i-uninstall-code-blind>I&rsquo;m getting stuck in &ldquo;Terminating&rdquo; when I uninstall Code Blind</h2><p>If you try to uninstall the <code>agones-system</code> namespace before you have removed all of the components in the namespace you may
end up in a <code>Terminating</code> state.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get ns
</span></span></code></pre></div><pre tabindex=0><code>NAME              STATUS        AGE                                                                                                                                                    
agones-system     Terminating   4d
</code></pre><p>Fixing this up requires us to bypass the finalizer in Kubernetes (<a href=https://www.ibm.com/support/knowledgecenter/en/SSBS6K_3.1.1/troubleshoot/ns_terminating.html>article link</a>), by manually changing the namespace details:</p><p>First get the current state of the namespace:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get namespace agones-system -o json &gt;tmp.json
</span></span></code></pre></div><p>Edit the response <code>tmp.json</code> to remove the finalizer data, for example remove the following:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#4e9a06>&#34;spec&#34;</span><span style=color:#a40000>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;finalizers&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;kubernetes&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>,</span>
</span></span></code></pre></div><p>Open a new terminal to proxy traffic:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> kubectl proxy
</span></span></code></pre></div><pre tabindex=0><code>Starting to serve on 127.0.0.1:8001
</code></pre><p>Now make an API call to send the altered namespace data:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> curl -k -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> -X PUT --data-binary @tmp.json http://127.0.0.1:8001/api/v1/namespaces/agones-system/finalize
</span></span></code></pre></div><p>You may need to clean up any other Code Blind related resources you have in your cluster at this point.</p></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Discord aria-label=Discord><a target=_blank rel=noopener href=https://join.discord.com/t/codeblind/shared_invite/12345 aria-label=Discord><i class="fab fa-discord"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="User mailing list" aria-label="User mailing list"><a target=_blank rel=noopener href=https://groups.google.com/forum/#!forum/codeblind-discuss aria-label="User mailing list"><i class="fa fa-envelope"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=X aria-label=X><a target=_blank rel=noopener href=https://twitter.com/codeblind aria-label=X><i class="fab fa-x-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="Community Meetings" aria-label="Community Meetings"><a target=_blank rel=noopener href=https://github.com/josephbarnett/ aria-label="Community Meetings"><i class="fab fa-youtube"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/josephbarnett/ aria-label=GitHub><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Resume aria-label=Resume><a target=_blank rel=noopener href=https://github.com/josephbarnett/ aria-label=Resume><i class="fab fa-linkedin"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Facebook aria-label=Facebook><a target=_blank rel=noopener href=https://github.com/josephbarnett/ aria-label=Facebook><i class="fab fa-facebook"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Contact aria-label=Contact><a target=_blank rel=noopener href=https://github.com/josephbarnett/codeblind.ai aria-label=Contact><i class="fab fa-whatsapp"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2024
<span class=td-footer__authors>Copyright Code Blind LLC</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href=https://policies.google.com/privacy target=_blank rel=noopener>Privacy Policy</a></span></div></div></div></footer></div><script src=/js/main.js></script><script src=/js/prism.js></script><script src=/js/tabpane-persist.js></script><script src=http://localhost:1313/js/asciinema-player.js></script></body></html>