<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.123.6"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel=canonical type=text/html href=http://localhost:1313/docs/getting-started/><link rel=alternate type=application/rss+xml href=http://localhost:1313/docs/getting-started/index.xml><link rel="shortcut icon" href="/favicons/favicon.ico?v=1"><link rel=apple-touch-icon href="/favicons/apple-touch-icon-180x180.png?v=1" sizes=180x180><link rel=icon type=image/png href="/favicons/favicon-16x16.png?v=1" sizes=16x16><link rel=icon type=image/png href="/favicons/favicon-32x32.png?v=1" sizes=32x32><link rel=apple-touch-icon href="/favicons/apple-touch-icon-180x180.png?v=1" sizes=180x180><title>Getting Started | </title><meta property="og:title" content="Getting Started"><meta property="og:description" content="Quickstarts for getting up and running with Code Blind
"><meta property="og:type" content="website"><meta property="og:url" content="http://localhost:1313/docs/getting-started/"><meta property="og:site_name" content="Goldydocs"><meta itemprop=name content="Getting Started"><meta itemprop=description content="Quickstarts for getting up and running with Code Blind
"><meta name=twitter:card content="summary"><meta name=twitter:title content="Getting Started"><meta name=twitter:description content="Quickstarts for getting up and running with Code Blind
"><link rel=stylesheet href=/css/prism.css><link href=/scss/main.css rel=stylesheet><link rel=stylesheet type=text/css href=http://localhost:1313/css/asciinema-player.css><script src=https://code.jquery.com/jquery-3.3.1.min.js integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-light nav-shadow flex-column flex-md-row td-navbar"><a id=agones-top class=navbar-brand href=/><svg viewBox="0 -40 700 300" xmlns="http://www.w3.org/2000/svg"><g fill="#006298" fill-rule="none" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode:normal" transform="matrix(1, 0, 0, 1, 4.033676, -59.776756)"><g data-paper-data='{"isGlobalGroup":true,"bounds":{"x":65,"y":134.91096067769388,"width":420,"height":200.17807864461224}}'><g data-paper-data='{"isPrimaryText":true}' fill-rule="nonzero" transform="matrix(1.506311, 0, 0, 1.608315, -96.423798, -293.86853)" style=""><path d="M99.87138 315.5382c-1.20049 6.40261-6.57411 11.03307-12.97673 11.03307-7.14577.0-12.80523-6.00245-12.80523-13.49122.0-7.54594 5.65945-13.60555 12.80523-13.60555 4.4018.0 8.74643 2.22948 11.8334 6.80278l6.91711-4.91629c-3.83013-6.23111-10.86158-10.34708-18.80768-10.34708C74.71825 291.01391 65 300.90366 65 313.08006s9.71825 22.00898 21.89465 22.00898c11.31891.0 20.69416-8.63209 21.95182-19.55084z" data-paper-data='{"glyphName":"C","glyphIndex":0,"firstGlyphOfWord":true,"word":1}'/><path d="M134.79992 335.08904c12.1764.0 22.00898-9.88975 22.00898-22.06615s-9.83258-22.00898-22.06615-22.00898c-12.1764.0-22.00898 9.83258-22.00898 22.00898s9.83258 22.06615 22.06615 22.06615zM134.74275 299.4745c7.20294.0 12.97673 6.05962 12.97673 13.54839.0 7.6031-5.71662 13.54839-12.91956 13.54839-7.31727.0-12.97673-5.94528-12.97673-13.54839.0-7.48877 5.65945-13.54839 12.91956-13.54839z" data-paper-data='{"glyphName":"O","glyphIndex":1,"word":1}'/><path d="M163.15435 291.75707v42.58881h17.32136c12.23356.0 22.23765-9.08942 22.23765-21.32299.0-12.11923-10.00408-21.26582-22.29481-21.26582zm8.86076 34.58554v-26.58228h8.40343c7.4316.0 13.20539 5.54512 13.20539 13.26256.0 7.66027-5.77379 13.31972-13.14822 13.31972z" data-paper-data='{"glyphName":"D","glyphIndex":2,"word":1}'/><path d="M235.46958 334.34588v-8.00327h-17.55002V315.7097h16.00653v-8.00327h-16.00653v-7.9461h13.77705v-8.00327H209.0588v42.58881z" data-paper-data='{"glyphName":"E","glyphIndex":3,"word":1}'/><path d="M256.67824 334.34588c7.83177.0 15.09187-5.03062 15.09187-13.71989.0-4.11597-1.94365-7.7746-5.77379-10.40425 2.05798-1.88648 3.02981-4.2303 3.02981-7.20294.0-7.9461-5.65945-11.26174-13.54839-11.26174h-13.66272v42.58881zM250.67579 326.34261V315.3667h6.28828c3.65864.0 5.71662 2.11515 5.71662 5.54512.0 3.31564-2.05798 5.43079-5.71662 5.43079zm0-18.69334v-7.88893h4.45896c2.45815.0 4.80196.68599 4.80196 3.94447.0 1.77215-.5145 3.94447-4.80196 3.94447z" data-paper-data='{"glyphName":"B","glyphIndex":4,"word":1}'/><path d="M278.11556 291.75707v42.58881h26.01062v-8.00327h-17.14986v-34.58555z" data-paper-data='{"glyphName":"L","glyphIndex":5,"word":1}'/><path d="M317.90323 291.75707h-8.86076v42.58881h8.86076z" data-paper-data='{"glyphName":"I","glyphIndex":6,"word":1}'/><path d="M356.31891 316.3957l-30.29808-25.43895v43.38914h8.86076v-24.46713l30.29808 25.21029v-43.33197h-8.86076z" data-paper-data='{"glyphName":"N","glyphIndex":7,"word":1}'/><path d="M373.29726 291.75707v42.58881h17.32136c12.23356.0 22.23765-9.08942 22.23765-21.32299.0-12.11923-10.00408-21.26582-22.29481-21.26582zM382.15802 326.34261v-26.58228h8.40343c7.4316.0 13.20539 5.54512 13.20539 13.26256.0 7.66027-5.77379 13.31972-13.14822 13.31972z" data-paper-data='{"glyphName":"D","glyphIndex":8,"word":1}'/></g><g data-paper-data='{"fillRule":"evenodd","fillRuleOriginal":"evenodd","isIcon":true,"iconStyle":"standalone","selectedEffects":{"container":"triangle_simple_outline3","transformation":"","pattern":""},"bounds":{"x":200.4253260667158,"y":134.91096067769388,"width":149.1493478665684,"height":129.93559557606665},"widthRatioIconToContainer":0.46864262218011316,"heightRatioIconToContainer":0.5128464428206175,"relativeBoundsIconToContainer":{"top":0.1511909708697078,"left":0.00000405714571068623},"iconType":"icon","rawIconId":"22591","isDetailed":false,"blockLetter":"A","suitableAsStandaloneIcon":true}' fill-rule="evenodd" transform="matrix(0.857575, 0, 0, 0.832887, 371.420288, 37.764965)" style=""><path d="M240.08737 218.30866l-.03565-.03565.03565-.21459c0-3.26912.85904-7.02682 2.57713-11.2738 1.07363-2.36185 2.46949-4.70062 4.18758-7.01493.90657-1.24068 2.39819-2.85113 4.47346-4.83203 2.14726-1.81315 4.21134-3.26842 6.19154-4.36651 1.76562-.97857 3.99676-1.92079 6.69271-2.82736 2.19549-.71575 5.07038-1.21692 8.62538-1.5028l.85904-.03565v.03565l.07199-.03565h2.11161l.25024.03565.03565-.03565.21528.03565c2.95807.0 6.5613.69199 10.80829 2.07597 2.38631.88281 4.74815 2.02843 7.08694 3.43617 1.45527.85904 3.14959 2.11161 5.08226 3.75771 2.33878 2.21925 3.88911 3.93664 4.65239 5.15426 1.79008 2.43314 3.18594 5.04592 4.18758 7.83763 1.14562 3.4837 1.71809 6.52566 1.71809 9.12655l.03495.14259h-.03565l.03565.03565v2.2542l-.03565.03635.03565.03635c0 1.76492-.35788 4.3057-1.07363 7.62305-.66822 2.33808-1.39586 4.34205-2.18291 6.01261-.85904 1.69432-2.02773 3.51935-3.50816 5.47579-.9541 1.16939-2.19549 2.49326-3.72205 3.97299-2.4576 2.07597-4.53287 3.61511-6.22719 4.61675-.73952.38164-1.40774.57247-2.00397.57247-1.59856.0-2.67219-.78775-3.22089-2.36254-.09576-.42917-.14329-.79963-.14329-1.10928.0-1.36021 1.19316-2.66031 3.57947-3.90099.73952-.35788 1.92009-1.26515 3.54242-2.72042 2.07597-2.0522 3.51935-3.75771 4.33086-5.11791.93034-1.43151 1.70551-2.92313 2.3262-4.47346.85904-2.43314 1.28822-4.02051 1.28822-4.76003l.35858-2.29055-.07199-.03565.07199-.21528v-.32223l.03565-.03635-.03565-.03565.03565-.14329.03565-1.61045c0-7.11-2.63584-13.29036-7.90893-18.53898-1.95644-1.74185-3.39983-2.87489-4.33016-3.39983-4.86768-3.03007-10.00935-4.54545-15.42574-4.54545h-1.64609l-.21459.03565v-.03565l-.03565.03565h-.03635c-2.40937.0-5.32062.56058-8.73232 1.68244-1.81385.69199-3.63888 1.59856-5.47579 2.72042-1.16939.69199-2.79172 2.00397-4.86768 3.93664l-1.18127 1.28822c-4.55733 5.08226-6.836 10.90405-6.836 17.46535l.03565.39352h-.03635l.03565.03565v.03565c0 4.67686 1.95644 10.04501 5.86931 16.10584 3.17336 4.72439 5.51214 8.29127 7.01493 10.70135.52493.88351 1.03728 1.86068 1.53845 2.93501h-.03565c-3.19712-1.45527-6.17966-3.16147-8.94761-5.11791-2.09972-1.64609-3.80523-3.30546-5.11791-4.97462-1.5028-2.09972-2.61278-3.88911-3.32853-5.36885-.85904-1.67055-1.65868-3.75771-2.39819-6.26353-.42917-1.57479-.77517-3.2803-1.03798-5.11722l-.17894-1.96832h.03565l-.03565-.03635-.03495-1.82503v-1.00234l.03565-.03565-.03565-.03565v-.03565zm34.03601-22.7622h2.04032l.03565.07199.03635-.07199c1.59856.04753 3.65076.38164 6.15589 1.00234 2.17103.69199 3.97299 1.44339 5.40379 2.2549 1.33645.73952 2.86371 1.86138 4.58179 3.36418 2.14726 2.07597 3.53124 3.63888 4.15123 4.68874 1.16939 1.69432 2.07597 3.49558 2.72042 5.40449.52493 1.31198.89469 3.20901 1.10928 5.69038v.03565h-.03565l.03565.03565v1.32457c0 6.46554-2.67219 12.24049-8.01727 17.32206-2.4576 2.17103-4.0324 3.29288-4.72439 3.36418-.42917.19082-.89399.28588-1.39586.28588h-.07129c-1.5035.0-2.55336-.7514-3.14959-2.2549l-.17964-1.07363c0-1.57479 1.04986-2.82736 3.14959-3.75771.66822-.33481 1.44339-.93104 2.3262-1.79008 1.40844-1.47973 2.41007-2.83924 3.007-4.08063.5487-.9541 1.07363-2.28985 1.57479-4.00793.28588-1.40774.42917-2.42195.42917-3.04195h.03565l-.03565-.0727.03565-.17894v-1.93267l-.03565-.17894h.03565l-.03565-.14329c0-1.74185-.60811-3.84158-1.82503-6.29918-.59693-1.0974-1.46785-2.26679-2.61278-3.50747-1.21622-1.24068-2.24232-2.09972-3.0776-2.57713-3.38794-2.17103-6.76401-3.25724-10.12818-3.25724h-.10694l-.03635-.07199-.03565.07199h-.10764l-.03565-.07199-.03565.07199h-.39352l-.03635-.07199-.03565.07199h-.64446l-.21459.03565v-.03565c-1.5028.14329-2.67219.33411-3.50816.57247-4.00793 1.14492-7.13376 3.03007-9.37678 5.65473-1.28891 1.40774-2.29055 2.89866-3.0063 4.47346-.93034 2.17103-1.39586 4.21134-1.39586 6.12025v.7514l-.03565.03565.03565.03565v.07129c0 3.14959 1.19316 6.47812 3.57876 9.98559 6.06083 9.6389 10.72511 17.28641 13.99423 22.94114l-.03565.03565h-.03635c-4.17569-.38164-6.96741-.77517-8.37445-1.18057-5.55897-8.78056-8.67292-13.66012-9.34113-14.63729-2.95877-4.48604-4.79568-7.77892-5.51143-9.87865-.78775-2.36185-1.18127-4.80827-1.18127-7.33716.0-5.48767 1.80126-10.52241 5.40449-15.10351.5487-.71575 1.68174-1.8495 3.39983-3.39983 3.24536-2.57713 6.78777-4.28264 10.62935-5.11791 1.38467-.30685 3.0063-.52213 4.86768-.64096v.07199zM274.69654 205.06653h1.10998l.07199.07199.03565-.07199h.03565l.03635.07199.03565-.07199c1.04986.0 2.46949.25024 4.25957.7514 3.6263 1.28822 6.38236 3.67453 8.26751 7.15823 1.04986 2.17103 1.57479 4.29522 1.57479 6.37048v.21459c0 3.96111-1.7062 7.55175-5.11791 10.77264-1.43151 1.14562-2.7323 1.71809-3.90099 1.71809-1.45597.0-2.54148-.77517-3.25724-2.3262-.11883-.33411-.19012-.68011-.21459-1.03798.0-1.19246.88281-2.39749 2.64842-3.61441 1.26445-.85904 2.07597-1.8495 2.43314-2.97065.28658-.81151.42917-1.61045.42917-2.39819v-.14329c0-2.38631-1.04986-4.49792-3.14959-6.33484-1.38328-1.0261-3.10206-1.53915-5.15356-1.53915l-.28588.03565v-.03565l-.03635.03565h-.07199c-1.88444.0-3.69829.81081-5.43944 2.43314-1.40844 1.62233-2.11161 3.4837-2.11161 5.58343.0 1.78938 1.2288 4.42593 3.68641 7.90963 6.34672 9.99747 11.22628 17.88264 14.63729 23.65759-3.05383.81081-5.40379 1.21622-7.05059 1.21622-3.14959-4.5811-6.84788-10.4623-11.09487-17.64359-1.45527-2.43384-3.0776-4.95156-4.86698-7.55245-1.59856-2.48137-2.39889-5.07038-2.39889-7.76634.0-3.74582 1.37209-7.06247 4.11628-9.94925 1.47904-1.36021 2.82736-2.32689 4.04428-2.89866 2.17103-.90657 3.61511-1.36021 4.33016-1.36021.4061-.09506 1.19316-.19082 2.36254-.28588v.07199zm74.56087 55.60127c.0215.04174.0421.08398.06181.1267.01926.04277.0374.08599.05442.12966.01747.04366.03381.08771.04904.13215.01478.04448.02867.08926.04165.13436.01299.04515.02486.09058.0356.13631.0103.04573.0197.09168.02822.13785.00851.04618.0159.09253.02217.13907.00582.04653.01075.0932.01478.14001.00358.04676.00627.09361.00806.14054.00134.04694.00179.09385.00134.14074-89e-5.04694-.00291.09383-.00605.14068-.00313.04685-.00739.09358-.01277.14021-.00538.04667-.01186.09316-.01948.13947-.00761.04631-.01635.0924-.0262.13825-.00985.04591-.02083.09153-.03292.13684-.0121.04537-.0253.09038-.03964.13503-.01478.0447-.03023.08901-.04636.13295-.01657.04394-.03426.08745-.05307.13053-.01881.04304-.03852.08561-.05912.12771s-.04232.08369-.06516.12476c-.02284.04102-.0468.08147-.07188.12133-.02463.03986-.05038.07909-.07726.1177-.02642.03856-.05397.07648-.08263.11373-.02867.03722-.05822.07374-.08868.10957-.03046.03579-.06158.07081-.09338.10507-.03225.03426-.06516.06772-.09875.10037s-.06808.06445-.10346.0954c-.03538.03095-.07144.061-.10816.09015-.03673.0292-.07412.05746-.11219.08478-.03852.02736-.07748.05377-.1169.07921-.03941.02544-.0795.04989-.12025.07336-.21766.12585-.44809.22136-.69128.28652-.2432.06516-.49064.09775-.74234.09775H203.29356c-.04694.0-.09385-.00116-.14074-.00349-.04689-.00228-.0937-.00573-.14041-.01034-.04671-.00457-.09327-.0103-.13967-.0172-.04645-.0069-.09269-.01494-.13872-.02412-.04604-.00914-.09184-.01941-.13738-.03084-.04551-.01137-.09071-.02389-.13564-.03756-.04492-.01362-.08948-.02833-.13369-.04414-.04421-.01581-.08798-.03269-.13134-.05065-.0434-.01796-.08631-.03697-.12872-.05703-.04246-.02007-.08438-.04116-.12576-.06328-.04138-.02217-.0822-.0453-.12247-.0694-.04026-.02414-.07992-.04926-.11898-.07537-.03901-.02606-.07737-.05307-.11508-.08102-.03771-.028-.0747-.05686-.11098-.0866-.03628-.02979-.07182-.06044-.10661-.09197-.0348-.03153-.0688-.06389-.10198-.09707-.03319-.03319-.06554-.06718-.09707-.10198-.03153-.03475-.06217-.07029-.09191-.10661-.02979-.03628-.05867-.07327-.08666-.11098-.02795-.03771-.05495-.07607-.08102-.11508-.02611-.03905-.05121-.07871-.07531-.11898-.02414-.04022-.04727-.08104-.0694-.12247-.02213-.04138-.04324-.0833-.06335-.12576-.02007-.04241-.03908-.0853-.05703-.12865-.01796-.0434-.03484-.0872-.05065-.13141-.01581-.04416-.03052-.0887-.04414-.13362-.01366-.04492-.02618-.09015-.03756-.1357-.01142-.04555-.0217-.09134-.03084-.13738-.00918-.04604-.01722-.09226-.02412-.13866-.00685-.04645-.01259-.09302-.0172-.13974-.00462-.04671-.00806-.09352-.01034-.14041-.00233-.04689-.00349-.09381-.00349-.14074.0-.25175.03258-.4992.09775-.74234.06516-.2432.16067-.47378.28652-.69175l71.7064-124.19911c.02347-.04067.04792-.08073.07336-.12018.02544-.03946.05184-.07827.07921-.11643.02732-.03816.05558-.07563.08478-.11239.02916-.03677.0592-.0728.09015-.1081.03095-.03529.06275-.0698.0954-.10352.03265-.03372.0661-.06662.10037-.09868.03426-.03211.06929-.06335.10507-.09372.03579-.03037.07231-.05984.10957-.08841.03722-.02858.07513-.05623.11373-.08296.03861-.02669.07784-.05245.1177-.07726.03986-.02477.0803-.04855.12133-.07135.04102-.0228.08261-.04459.12476-.06536.0421-.02074.08467-.04044.12771-.05912.04308-.01867.0866-.03628.13053-.05281.04394-.01657.08823-.03202.13288-.04636.0447-.01438.08973-.02763.1351-.03977.04533-.01214.09094-.02318.13684-.03312.04586-.0099.09195-.01867.13825-.02633.04631-.00761.09278-.01411.1394-.01948.04667-.00538.09343-.00958.14027-.01263.0468-.00309.09367-.00502.14061-.00578.04694-76e-5.09387-38e-5.14081.00114.04689.00152.09374.00421.14054.00806.0468.00385.09347.00882.14001.01491.04653.00614.09289.01342.13907.02184.04618.00837.09213.01789.13785.02855.04573.01066.09116.02244.13631.03533.0451.0129.08988.02689.13436.04199.04443.01509.08848.03126.13215.0485.04366.01724.08686.03556.12959.05495.04277.01934.08503.03975.12677.0612.04178.02146.08299.04392.12361.06738.21802.1259.41604.27784.59408.45582.17798.17802.32993.37605.45582.59408l71.70627 124.19911c.02374.04062.04613.08182.06718.12361zM274.99998 143.5157l-66.73842 115.59433H341.7386z" data-paper-data='{"isPathIcon":true}'/></g></g></g></svg> <span class="text-uppercase fw-bold"></span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/docs/><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><span>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/josephbarnett/codeblind.ai>GitHub</a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://app.codeblind.ai/login>Login</a></li></ul></div><div class="navbar-nav mx-lg-2 d-none d-lg-block"></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/getting-started/>Return to the regular view of this page</a>.</p></div><h1 class=title>Getting Started</h1><div class=lead>Quickstarts for getting up and running with Code Blind</div><ul><li>1: <a href=#pg-1995d0d2405f561f81a874a6a93513aa>Quickstart: Create a Game Server</a></li><li>2: <a href=#pg-f633728ddda1aa13c4e952cb0fffec2f>Quickstart: Create a Game Server Fleet</a></li><li>3: <a href=#pg-b26271778305c658b9e01a31ccaf98b4>Quickstart: Create a Fleet Autoscaler</a></li><li>4: <a href=#pg-41eab8b673334ca9325b8ab33261f1a3>Quickstart: Create a Fleet Autoscaler with Webhook Policy</a></li><li>5: <a href=#pg-968dadb4e3c831fafc44763def50a585>Quickstart: Edit a Game Server</a></li></ul><div class=content></div></div><div class=td-content><h1 id=pg-1995d0d2405f561f81a874a6a93513aa>1 - Quickstart: Create a Game Server</h1><div class=lead>This guide covers how you can quickly get started using Code Blind to create GameServers.</div><h2 id=prerequisites>Prerequisites</h2><p>The following prerequisites are required to create a GameServer:</p><ol><li>A Kubernetes cluster with the UDP port range 7000-8000 open on each node.</li><li>Code Blind controller installed in the targeted cluster</li><li>kubectl properly configured</li><li>Netcat which is already installed on most Linux/macOS distributions, for windows you can use <a href=https://docs.microsoft.com/en-us/windows/wsl/install-win10>WSL</a>.</li></ol><p>If you don’t have a Kubernetes cluster you can follow <a href=/docs/installation/>these instructions</a> to create a cluster on Google Kubernetes Engine (GKE), Minikube or Azure Kubernetes Service (AKS), and install Code Blind.</p><p>For the purpose of this guide we’re going to use the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/examples/simple-game-server/ target=_blank data-proofer-ignore>simple-game-server</a>
example as the GameServer container. This example is a very simple UDP server written in Go. Don’t hesitate to look at the code of this example for more information.</p><h2 id=objectives>Objectives</h2><ul><li>Create a GameServer in Kubernetes using Code Blind custom resource.</li><li>Get information about the GameServer such as IP address, port and state.</li><li>Connect to the GameServer.</li></ul><h3 id=1-create-a-gameserver>1. Create a GameServer</h3><p>Let&rsquo;s create a GameServer using the following command :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/simple-game-server/gameserver.yaml
</span></span></code></pre></div><p>You should see a successful output similar to this :</p><pre tabindex=0><code>gameserver.agones.dev/simple-game-server-4ss4j created
</code></pre><p>This has created a GameServer record inside Kubernetes, which has also created a backing <a href=https://kubernetes.io/docs/concepts/workloads/pods/pod/>Pod</a> to run our simple udp game server code in.
If you want to see all your running GameServers you can run:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get gameservers
</span></span></code></pre></div><p>It should look something like this:</p><pre tabindex=0><code>NAME                       STATE     ADDRESS       PORT   NODE     AGE
simple-game-server-7pjrq   Ready   35.233.183.43   7190   agones   3m
</code></pre><p>You can also see the <a href=https://kubernetes.io/docs/concepts/workloads/pods/pod/>Pod</a> that got created by running <code>kubectl get pods</code>, the Pod will be prefixed by <code>simple-game-server</code>.</p><pre tabindex=0><code>NAME                        READY     STATUS    RESTARTS   AGE
simple-game-server-7pjrq    2/2       Running   0          5m
</code></pre><p>As you can see above it says <code>READY: 2/2</code> this means there are two containers running in this Pod, this is because Code Blind injected the <a href=https://agones.dev/docs/guides/troubleshooting/#how-do-i-see-the-logs-for-agones>SDK sidecar</a> for readiness
and health checking of your Game Server.</p><p>For the full details of the YAML file head to the <a href=http://localhost:1313/docs/reference/gameserver/>GameServer Specification Guide</a></p><h3 id=2-fetch-the-gameserver-status>2. Fetch the GameServer Status</h3><p>Let&rsquo;s wait for the GameServer state to become <code>Ready</code>. You can use the <code>watch</code>
tool to see the state change. If your operating system does not have <code>watch</code>,
manually run <code>kubectl describe gameserver</code> until the state changes.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>watch kubectl describe gameserver
</span></span></code></pre></div><pre tabindex=0><code>Name:         simple-game-server-7pjrq
Namespace:    default
Labels:       &lt;none&gt;
Annotations:  agones.dev/sdk-version: 0.9.0-764fa53
API Version:  agones.dev/v1
Kind:         GameServer
Metadata:
  Creation Timestamp:  2019-02-27T15:06:20Z
  Finalizers:
    agones.dev
  Generate Name:     simple-game-server-
  Generation:        1
  Resource Version:  30377
  Self Link:         /apis/agones.dev/v1/namespaces/default/gameservers/simple-game-server-7pjrq
  UID:               3d7ac3e1-3aa1-11e9-a4f5-42010a8a0019
Spec:
  Container:  simple-game-server
  Health:
    Failure Threshold:      3
    Initial Delay Seconds:  5
    Period Seconds:         5
  Ports:
    Container Port:  7654
    Host Port:       7190
    Name:            default
    Port Policy:     Dynamic
    Protocol:        UDP
  Scheduling:        Packed
  Template:
    Metadata:
      Creation Timestamp:  &lt;nil&gt;
    Spec:
      Containers:
        Image:  us-docker.pkg.dev/codeblind/examples/simple-server:0.27
        Name:   simple-game-server
        Resources:
          Limits:
            Cpu:     20m
            Memory:  32Mi
          Requests:
            Cpu:     20m
            Memory:  32Mi
Status:
  Address:    35.233.183.43
  Node Name:  agones
  Ports:
    Name:  default
    Port:  7190
  State:   Ready
Events:
  Type    Reason          Age   From                   Message
  ----    ------          ----  ----                   -------
  Normal  PortAllocation  34s   gameserver-controller  Port allocated
  Normal  Creating        34s   gameserver-controller  Pod simple-game-server-7pjrq created
  Normal  Scheduled       34s   gameserver-controller  Address and port populated
  Normal  Ready           27s   gameserver-controller  SDK.Ready() executed
</code></pre><p>If you look towards the bottom, you can see there is a <code>Status > State</code> value. We are waiting for it to move to <code>Ready</code>, which means that the game server is ready to accept connections.</p><p>You might also be interested to see the <code>Events</code> section, which outlines when various lifecycle events of the <code>GameServer</code> occur. We can also see when the <code>GameServer</code> is ready on the event stream as well - at which time the <code>Status > Address</code> and <code>Status > Ports > Port</code> have also been populated, letting us know what IP and port our client can now connect to!</p><p>Let&rsquo;s retrieve the IP address and the allocated port of your Game Server :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get gs
</span></span></code></pre></div><p>This should output your Game Server IP address and ports, eg:</p><pre tabindex=0><code>NAME                       STATE   ADDRESS         PORT   NODE     AGE
simple-game-server-7pjrq   Ready   35.233.183.43   7190   agones   4m
</code></pre><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>If you have Code Blind installed on minikube, or other local Kubernetes tooling, and you are having issues connecting
to the <code>GameServer</code>, please check the
<a href=http://localhost:1313/docs/installation/creating-cluster/minikube/#local-connection-workarounds>Minikube local connection workarounds</a>.</div><h3 id=3-connect-to-the-gameserver>3. Connect to the GameServer</h3><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>If you have Code Blind installed on Google Kubernetes Engine, and are using
Cloud Shell for your terminal, UDP is blocked. For this step, we recommend
SSH&rsquo;ing into a running VM in your project, such as a Kubernetes node.
You can click the &lsquo;SSH&rsquo; button on the <a href=https://console.cloud.google.com/compute/instances>Google Compute Engine Instances</a>
page to do this.
Run <code>toolbox</code> on GKE Node to run docker container with tools and then <code>nc</code> command would be available.</div><p>You can now communicate with the Game Server :</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4><p>If you do not have netcat installed
(i.e. you get a response of <code>nc: command not found</code>),
you can install netcat by running <code>sudo apt install netcat</code>.</p><p>If you are on Windows, you can alternatively install netcat on
<a href=https://docs.microsoft.com/en-us/windows/wsl/install-win10>WSL</a>,
or download a version of netcat for Windows from <a href=https://nmap.org/ncat/>nmap.org</a>.</p></div><pre tabindex=0><code>nc -u {IP} {PORT}
Hello World !
ACK: Hello World !
EXIT
</code></pre><p>You can finally type <code>EXIT</code> which tells the SDK to run the <a href=http://localhost:1313/docs/guides/client-sdks/#shutdown>Shutdown command</a>, and therefore shuts down the <code>GameServer</code>.</p><p>If you run <code>kubectl describe gameserver</code> again - either the GameServer will be gone completely, or it will be in <code>Shutdown</code> state, on the way to being deleted.</p><h2 id=next-step>Next Step</h2><p>If you want to use your own GameServer container make sure you have properly integrated the <a href=http://localhost:1313/docs/guides/client-sdks/>Code Blind SDK</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-f633728ddda1aa13c4e952cb0fffec2f>2 - Quickstart: Create a Game Server Fleet</h1><div class=lead>This guide covers how you can quickly get started using Code Blind to create a Fleet of warm GameServers ready for you to allocate out of and play on!</div><h2 id=prerequisites>Prerequisites</h2><p>The following prerequisites are required to create a GameServer:</p><ol><li>A Kubernetes cluster with the UDP port range 7000-8000 open on each node.</li><li>Code Blind controller installed in the targeted cluster</li><li>kubectl properly configured</li><li>Netcat which is already installed on most Linux/macOS distributions, for windows you can use <a href=https://docs.microsoft.com/en-us/windows/wsl/install-win10>WSL</a>.</li></ol><p>If you don’t have a Kubernetes cluster you can follow <a href=/docs/installation/>these instructions</a> to create a cluster on Google Kubernetes Engine (GKE), Minikube or Azure Kubernetes Service (AKS), and install Code Blind.</p><p>For the purpose of this guide we’re going to use the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/examples/simple-game-server/ target=_blank data-proofer-ignore>simple-game-server</a>
example as the GameServer container. This example is a very simple UDP server written in Go. Don’t hesitate to look at the code of this example for more information.</p><p>While not required, you may wish to go through the <a href=/docs/getting-started/create-gameserver/>Create a Game Server</a> quickstart before this one.</p><h2 id=objectives>Objectives</h2><ul><li>Create a <a href=https://agones.dev/docs/reference/fleet/>Fleet</a> in Kubernetes using an Code Blind custom resource.</li><li>Scale the Fleet up from its initial configuration.</li><li>Request a GameServer allocation from the Fleet to play on.</li><li>Connect to the allocated GameServer.</li><li>Deploy a new GameServer configuration to the Fleet.</li></ul><h3 id=1-create-a-fleet>1. Create a Fleet</h3><p>Let&rsquo;s create a Fleet using the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/simple-game-server/fleet.yaml
</span></span></code></pre></div><p>You should see a successful output similar to this :</p><pre tabindex=0><code>fleet.agones.dev/simple-game-server created
</code></pre><p>This has created a Fleet record inside Kubernetes, which in turn creates two warm <a href=http://localhost:1313/docs/reference/gameserver/>GameServers</a>
that are available to be allocated for a game session.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get fleet
</span></span></code></pre></div><p>It should look something like this:</p><pre tabindex=0><code>NAME                 SCHEDULING   DESIRED   CURRENT   ALLOCATED   READY     AGE
simple-game-server   Packed       2         3         0           2         9m
</code></pre><p>You can also see the GameServers that have been created by the Fleet by running <code>kubectl get gameservers</code>,
the GameServer will be prefixed by <code>simple-game-server</code>.</p><pre tabindex=0><code>NAME                             STATE     ADDRESS            PORT   NODE      AGE
simple-game-server-llg4x-rx6rc   Ready     192.168.122.205    7752   minikube   9m
simple-game-server-llg4x-v6g2r   Ready     192.168.122.205    7623   minikube   9m
</code></pre><p>For the full details of the YAML file head to the <a href=http://localhost:1313/docs/reference/fleet/>Fleet Specification Guide</a></p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>The game servers deployed from a <code>Fleet</code> resource will be deployed in the same namespace. The above example omits specifying a namespace, which implies both the <code>Fleet</code> and the associated <code>GameServer</code> resources will be deployed to the <code>default</code> namespace.</div><h3 id=2-fetch-the-fleet-status>2. Fetch the Fleet status</h3><p>Let&rsquo;s wait for the two <code>GameServers</code> to become ready.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>watch kubectl describe fleet simple-game-server
</span></span></code></pre></div><pre tabindex=0><code>Name:         simple-game-server
Namespace:    default
Labels:       &lt;none&gt;
Annotations:  kubectl.kubernetes.io/last-applied-configuration={&#34;apiVersion&#34;:&#34;agones.dev/v1&#34;,&#34;kind&#34;:&#34;Fleet&#34;,&#34;metadata&#34;:{&#34;annotations&#34;:{},&#34;name&#34;:&#34;simple-game-server&#34;,&#34;namespace&#34;:&#34;default&#34;},&#34;spec&#34;:{&#34;replicas&#34;:2,...
API Version:  agones.dev/v1
Kind:         Fleet
Metadata:
  Cluster Name:
  Creation Timestamp:  2018-07-01T18:55:35Z
  Generation:          1
  Resource Version:    24685
  Self Link:           /apis/agones.dev/v1/namespaces/default/fleets/simple-game-server
  UID:                 56710a91-7d60-11e8-b2dd-08002703ef08
Spec:
  Replicas:  2
  Strategy:
    Rolling Update:
      Max Surge:        25%
      Max Unavailable:  25%
    Type:               RollingUpdate
  Template:
    Metadata:
      Creation Timestamp:  &lt;nil&gt;
    Spec:
      Health:
      Ports:
        Container Port:  7654
        Name:            default
        Port Policy:     Dynamic
      Template:
        Metadata:
          Creation Timestamp:  &lt;nil&gt;
        Spec:
          Containers:
            Image:  us-docker.pkg.dev/codeblind/examples/simple-server:0.27
            Name:   simple-game-server
            Resources:
Status:
  Allocated Replicas:  0
  Ready Replicas:      2
  Replicas:            2
Events:
  Type    Reason                 Age   From              Message
  ----    ------                 ----  ----              -------
  Normal  CreatingGameServerSet  13s   fleet-controller  Created GameServerSet simple-game-server-wlqnd
</code></pre><p>If you look towards the bottom, you can see there is a section of <code>Status > Ready Replicas</code> which will tell you
how many <code>GameServers</code> are currently in a Ready state. After a short period, there should be 2 <code>Ready Replicas</code>.</p><h3 id=3-scale-up-the-fleet>3. Scale up the Fleet</h3><p>Let&rsquo;s scale up the <code>Fleet</code> from 2 <code>replicates</code> to 5.</p><p>Run <code>kubectl scale fleet simple-game-server --replicas=5</code> to change Replicas count from 2 to 5.</p><p>If we now run <code>kubectl get gameservers</code> we should see 5 <code>GameServers</code> prefixed by <code>simple-game-server</code>.</p><pre tabindex=0><code>NAME                             STATE    ADDRESS           PORT    NODE       AGE
simple-game-server-sdhzn-kcmh6   Ready    192.168.122.205   7191    minikube   52m
simple-game-server-sdhzn-pdpk5   Ready    192.168.122.205   7752    minikube   53m
simple-game-server-sdhzn-r4d6x   Ready    192.168.122.205   7623    minikube   52m
simple-game-server-sdhzn-wng5k   Ready    192.168.122.205   7709    minikube   53m
simple-game-server-sdhzn-wnhsw   Ready    192.168.122.205   7478    minikube   52m
</code></pre><h3 id=4-allocate-a-game-server-from-the-fleet>4. Allocate a Game Server from the Fleet</h3><p>Since we have a fleet of warm gameservers, we need a way to request one of them for usage, and mark that it has
players accessing it (and therefore, it should not be deleted until they are finished with it).</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>In production, you would likely do the following through a <a href=http://localhost:1313/docs/guides/access-api/>Kubernetes API call</a>, but we can also
do this through <code>kubectl</code> as well, and ask it to return the response in yaml so that we can see what has happened.</div><p>We can do the allocation of a GameServer for usage through a <code>GameServerAllocation</code>, which will both
return to us the details of a <code>GameServer</code> (assuming one is available), and also move it to the <code>Allocated</code> state,
which demarcates that it has players on it, and should not be removed until <code>SDK.Shutdown()</code> is called, or it is manually deleted.</p><p>It is worth noting that there is nothing specific that ties a <code>GameServerAllocation</code> to a fleet.
A <code>GameServerAllocation</code> uses a <a href=https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/>label selector</a>
to determine what group of <code>GameServers</code> it will attempt to allocate out of. That being said, a <code>Fleet</code> and <code>GameServerAllocation</code>
are often used in conjunction.</p><p><a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>This example</a> uses the label selector to specifically target the <code>simple-game-server</code> fleet that we just created.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/simple-game-server/gameserverallocation.yaml -o yaml
</span></span></code></pre></div><p>For the full details of the YAML file head to the <a href=http://localhost:1313/docs/reference/gameserverallocation/>GameServerAllocation Specification Guide</a></p><p>You should get back a response that looks like the following:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>allocation.agones.dev/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>GameServerAllocation</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>creationTimestamp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>2019-02-19T02:13:12Z</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>simple-game-server-dph9b-hfk24</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>default</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>{}<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>required</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>agones.dev/fleet</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>simple-game-server</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>scheduling</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Packed</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>status</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>address</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>192.168.122.152</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>gameServerName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>simple-game-server-dph9b-hfk24</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>nodeName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>minikube</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>ports</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>default</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>7714</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>state</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Allocated</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>If you look at the <code>status</code> section, there are several things to take note of. The <code>state</code> value will tell if
a <code>GameServer</code> was allocated or not. If a <code>GameServer</code> could not be found, this will be set to <code>UnAllocated</code>.
If there are too many concurrent requests overwhelmed the system, <code>state</code> will be set to
<code>Contention</code> even though there are available <code>GameServers</code>.</p><p>However, we see that the <code>status.state</code> value was set to <code>Allocated</code>.
This means you have been successfully allocated a <code>GameServer</code> out of the fleet, and you can now connect your players to it!</p><p>You can see various immutable details of the <code>GameServer</code> in the status - the <code>address</code>, <code>ports</code> and the name
of the <code>GameServer</code>, in case you want to use it to retrieve more details.</p><p>We can also check to see how many <code>GameServers</code> you have <code>Allocated</code> vs <code>Ready</code> with the following command
(&ldquo;gs&rdquo; is shorthand for &ldquo;gameserver&rdquo;).</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get gs
</span></span></code></pre></div><p>This will get you a list of all the current <code>GameServers</code> and their <code>Status.State</code>.</p><pre tabindex=0><code>NAME                             STATE       ADDRESS           PORT   NODE      AGE
simple-game-server-sdhzn-kcmh6   Ready       192.168.122.205   7191   minikube  52m
simple-game-server-sdhzn-pdpk5   Ready       192.168.122.205   7752   minikube  53m
simple-game-server-sdhzn-r4d6x   Allocated   192.168.122.205   7623   minikube  52m
simple-game-server-sdhzn-wng5k   Ready       192.168.122.205   7709   minikube  53m
simple-game-server-sdhzn-wnhsw   Ready       192.168.122.205   7478   minikube  52m
</code></pre><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4><code>GameServerAllocations</code> are create only and not stored for performance reasons, so you won&rsquo;t be able to list
them after they have been created - but you can see their effects on <code>GameServers</code></div><p>A handy trick for checking to see how many <code>GameServers</code> you have <code>Allocated</code> vs <code>Ready</code>, run the following:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get gs
</span></span></code></pre></div><p>This will get you a list of all the current <code>GameServers</code> and their <code>Status > State</code>.</p><pre tabindex=0><code>NAME                             STATE       ADDRESS          PORT   NODE        AGE
simple-game-server-tfqn7-c9tqz   Ready       192.168.39.150   7136   minikube    52m
simple-game-server-tfqn7-g8fhq   Allocated   192.168.39.150   7148   minikube    53m
simple-game-server-tfqn7-p8wnl   Ready       192.168.39.150   7453   minikube    52m
simple-game-server-tfqn7-t6bwp   Ready       192.168.39.150   7228   minikube    53m
simple-game-server-tfqn7-wkb7b   Ready       192.168.39.150   7226   minikube    52m
</code></pre><h3 id=5-scale-down-the-fleet>5. Scale down the Fleet</h3><p>Not only can we scale our fleet up, but we can scale it down as well.</p><p>The nice thing about Code Blind is that it is smart enough to know when <code>GameServers</code> have been moved to <code>Allocated</code>
and will automatically leave them running on scale down &ndash; as we assume that players are playing on this game server,
and we shouldn&rsquo;t disconnect them!</p><p>Let&rsquo;s scale down our Fleet to 0 (yep! you can do that!), and watch what happens.</p><p>Run <code>kubectl scale fleet simple-game-server --replicas=0</code> to change Replicas count from 5 to 0.</p><p>It may take a moment for all the <code>GameServers</code> to shut down, so let&rsquo;s watch them all and see what happens:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>watch kubectl get gs
</span></span></code></pre></div><p>Eventually, one by one they will be removed from the list, and you should simply see:</p><pre tabindex=0><code>NAME                             STATUS      ADDRESS          PORT    NODE       AGE
simple-game-server-tfqn7-g8fhq   Allocated   192.168.39.150   7148    minikube   55m
</code></pre><p>That lone <code>Allocated</code> <code>GameServer</code> is left all alone, but still running!</p><p>If you would like, try editing the <code>Fleet</code> configuration <code>replicas</code> field and watch the list of <code>GameServers</code>
grow and shrink.</p><h3 id=6-connect-to-the-gameserver>6. Connect to the GameServer</h3><p>Since we&rsquo;ve only got one allocation, we&rsquo;ll just grab the details of the IP and port of the
only allocated <code>GameServer</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get gameservers <span style=color:#000;font-weight:700>|</span> grep Allocated <span style=color:#000;font-weight:700>|</span> awk <span style=color:#4e9a06>&#39;{print $3&#34;:&#34;$4 }&#39;</span>
</span></span></code></pre></div><p>This should output your Game Server IP address and port. (eg <code>10.130.65.208:7936</code>)</p><p>You can now communicate with the <code>GameServer</code>:</p><pre tabindex=0><code>nc -u {IP} {PORT}
Hello World !
ACK: Hello World !
EXIT
</code></pre><p>You can finally type <code>EXIT</code> which tells the SDK to run the <a href=http://localhost:1313/docs/guides/client-sdks/#shutdown>Shutdown command</a>, and therefore shuts down the <code>GameServer</code>.</p><p>If you run <code>kubectl describe gs | grep State</code> again - either the GameServer will be replaced with a new, <code>Ready</code> <code>GameServer</code>
, or it will be in <code>Shutdown</code> state, on the way to being deleted.</p><p>Since we are running a <code>Fleet</code>, Code Blind will always do it&rsquo;s best to ensure there are always the configured number
of <code>GameServers</code> in the pool in either a <code>Ready</code> or <code>Allocated</code> state.</p><h3 id=7-deploy-a-new-version-of-the-gameserver-on-the-fleet>7. Deploy a new version of the GameServer on the Fleet</h3><p>We can also change the configuration of the <code>GameServer</code> of the running <code>Fleet</code>, and have the changes
roll out, without interrupting the currently <code>Allocated</code> <code>GameServers</code>.</p><p>Let&rsquo;s take this for a spin! Run <code>kubectl scale fleet simple-game-server --replicas=5</code> to return Replicas count back to 5.</p><p>Let&rsquo;s also allocate ourselves a <code>GameServer</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/simple-game-server/gameserverallocation.yaml -o yaml
</span></span></code></pre></div><p>We should now have four <code>Ready</code> <code>GameServers</code> and one <code>Allocated</code>.</p><p>We can check this by running <code>kubectl get gs</code>.</p><pre tabindex=0><code>NAME                             STATE       ADDRESS          PORT   NODE       AGE
simple-game-server-tfqn7-c9tz7   Ready       192.168.39.150   7136   minikube   5m
simple-game-server-tfqn7-g8fhq   Allocated   192.168.39.150   7148   minikube   5m
simple-game-server-tfqn7-n0wnl   Ready       192.168.39.150   7453   minikube   5m
simple-game-server-tfqn7-hiiwp   Ready       192.168.39.150   7228   minikube   5m
simple-game-server-tfqn7-w8z7b   Ready       192.168.39.150   7226   minikube   5m
</code></pre><p>In production, we&rsquo;d likely be changing a <code>containers > image</code> configuration to update our <code>Fleet</code>
to run a new game server process, but to make this example simple, change <code>containerPort</code> from <code>7654</code>
to <code>6000</code>.</p><p>Run <code>kubectl edit fleet simple-game-server</code>, and make the necessary changes, and then save and exit your editor.</p><p>This will start the deployment of a new set of <code>GameServers</code> running
with a Container Port of <code>6000</code>.</p><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4>This will make it such that you can no longer connect to the simple-game-server game server.</div><p>Run <code>kubectl describe gs | grep "Container Port"</code>
until you can see that there is
one with a containerPort of <code>7654</code>, which is the <code>Allocated</code> <code>GameServer</code>, and four instances with a containerPort of <code>6000</code> which
is the new configuration. You can also run <code>kubectl get gs</code> and look at the <strong>Age</strong> column to see that one <code>GameServer</code> is much
older than the other four.</p><p>You have now deployed a new version of your game!</p><h2 id=next-steps>Next Steps</h2><ul><li>Have a look at the <a href=http://localhost:1313/docs/reference/gameserverallocation/>GameServerAllocation specification</a>, and see
how the extra functionality can enable smoke testing, server information communication, and more.</li><li>You can now create a fleet autoscaler to automatically resize your fleet based on the actual usage.
See <a href=/docs/getting-started/create-fleetautoscaler/>Create a Fleet Autoscaler</a>.</li><li>Have a look at the <a href=http://localhost:1313/docs/integration-patterns/>GameServer Integration Patterns</a>,
to give you a set of examples on how all the pieces fit together with your matchmaker and other systems.</li><li>Or if you want to try to use your own GameServer container make sure you have properly integrated the <a href=http://localhost:1313/docs/guides/client-sdks/>Code Blind SDK</a>.</li><li>If you would like to learn how to programmatically allocate a Game Server from the fleet, see how to <a href=/docs/guides/access-api/>Access Code Blind via the Kubernetes API</a> or alternatively use the <a href=/docs/advanced/allocator-service/>Allocator Service</a>, depending on your needs.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-b26271778305c658b9e01a31ccaf98b4>3 - Quickstart: Create a Fleet Autoscaler</h1><div class=lead>This guide covers how you can quickly get started using Code Blind to create a Fleet Autoscaler to manage your fleet size automatically, based on actual load.</div><h2 id=prerequisites>Prerequisites</h2><p>It is assumed that you have followed the instructions to <a href=http://localhost:1313/docs/getting-started/create-fleet/>Create a Game Server Fleet</a>
and you have a running fleet of game servers.</p><h2 id=objectives>Objectives</h2><ul><li>Create a Fleet Autoscaler in Kubernetes using Code Blind custom resource.</li><li>Watch the Fleet scale up when allocating GameServers</li><li>Watch the Fleet scale down when shutting down allocated GameServers</li><li>Edit the autoscaler specification to apply live changes</li></ul><h3 id=1-create-a-fleet-autoscaler>1. Create a Fleet Autoscaler</h3><p>Let&rsquo;s create a Fleet Autoscaler using the following command :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/simple-game-server/fleetautoscaler.yaml
</span></span></code></pre></div><p>You should see a successful output similar to this :</p><pre tabindex=0><code>fleetautoscaler.autoscaling.agones.dev/simple-game-server-autoscaler created
</code></pre><p>This has created a FleetAutoscaler record inside Kubernetes.</p><h3 id=2-see-the-autoscaler-status>2. See the autoscaler status.</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe fleetautoscaler simple-game-server-autoscaler
</span></span></code></pre></div><p>It should look something like this:</p><pre tabindex=0><code>Name:         simple-game-server-autoscaler
Namespace:    default
Labels:       &lt;none&gt;
Annotations:  kubectl.kubernetes.io/last-applied-configuration={&#34;apiVersion&#34;:&#34;au
toscaling.agones.dev/v1&#34;,&#34;kind&#34;:&#34;FleetAutoscaler&#34;,&#34;metadata&#34;:{&#34;annotations&#34;:{},
&#34;name&#34;:&#34;simple-game-server-autoscaler&#34;,&#34;namespace&#34;:&#34;default&#34;},...
API Version:  autoscaling.agones.dev/v1
Kind:         FleetAutoscaler
Metadata:
  Cluster Name:
  Creation Timestamp:  2018-10-02T15:19:58Z
  Generation:          1
  Owner References:
    API Version:           autoscaling.agones.dev/v1
    Block Owner Deletion:  true
    Controller:            true
    Kind:                  Fleet
    Name:                  simple-game-server
    UID:                   9960762e-c656-11e8-933e-fa163e07a1d4
  Resource Version:        6123197
  Self Link:               /apis/autoscaling.agones.dev/v1/namespaces/default/fleetautoscalers/simple-game-server-autoscaler
  UID:                     9fd0efa1-c656-11e8-933e-fa163e07a1d4
Spec:
  Fleet Name:  simple-game-server
  Policy:
    Buffer:
      Buffer Size:   2
      Max Replicas:  10
      Min Replicas:  2
    Type:            Buffer
Status:
  Able To Scale:     true
  Current Replicas:  2
  Desired Replicas:  2
  Last Scale Time:   &lt;nil&gt;
  Scaling Limited:   false
Events:              &lt;none&gt;
</code></pre><p>You can see the status (able to scale, not limited), the last time the fleet was scaled (nil for never)
and the current and desired fleet size.</p><p>The autoscaler works by changing the desired size, and the fleet creates/deletes game server instances
to achieve that number. The convergence is achieved in time, which is usually measured in seconds.</p><h3 id=3-allocate-a-game-server-from-the-fleet>3. Allocate a Game Server from the Fleet</h3><p>If you&rsquo;re interested in more details for game server allocation, you should consult the <a href=http://localhost:1313/docs/getting-started/create-fleet/>Create a Game Server Fleet</a> page.
In here we are only interested in triggering allocations to see the autoscaler in action.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/simple-game-server/gameserverallocation.yaml -o yaml
</span></span></code></pre></div><p>You should get in return the allocated game server details, which should end with something like:</p><pre tabindex=0><code>status:
  address: 34.94.118.237
  gameServerName: simple-game-server-v6jwb-6bzkz
  nodeName: gke-test-cluster-default-f11755a7-5km3
  ports:
  - name: default
    port: 7832
  state: Allocated
</code></pre><p>Note the address and port, you might need them later to connect to the server.</p><h3 id=4-see-the-autoscaler-in-action>4. See the autoscaler in action</h3><p>Now let&rsquo;s wait a few seconds to allow the autoscaler to detect the change in the fleet and check again its status</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe fleetautoscaler simple-game-server-autoscaler
</span></span></code></pre></div><p>The last part should look something like this:</p><pre tabindex=0><code>Spec:
  Fleet Name:  simple-game-server
  Policy:
    Buffer:
      Buffer Size:   2
      Max Replicas:  10
      Min Replicas:  2
    Type:            Buffer
Status:
  Able To Scale:     true
  Current Replicas:  3
  Desired Replicas:  3
  Last Scale Time:   2018-10-02T16:00:02Z
  Scaling Limited:   false
Events:
  Type    Reason            Age   From                        Message
  ----    ------            ----  ----                        -------
  Normal  AutoScalingFleet  2m    fleetautoscaler-controller  Scaling fleet simple-game-server from 2 to 3
</code></pre><p>You can see that the fleet size has increased, the autoscaler having compensated for the allocated instance.
Last Scale Time has been updated, and a scaling event has been logged.</p><p>Double-check the actual number of game server instances and status by running</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get gs
</span></span></code></pre></div><p>This will get you a list of all the current <code>GameServers</code> and their <code>Status > State</code>.</p><pre tabindex=0><code>NAME                             STATE       ADDRESS        PORT     NODE        AGE
simple-game-server-mzhrl-hz8wk   Allocated   10.30.64.99    7131     minikube    5m
simple-game-server-mzhrl-k6jg5   Ready       10.30.64.100   7243     minikube    5m  
simple-game-server-mzhrl-n2sk2   Ready       10.30.64.168   7658     minikube    5m
</code></pre><h3 id=5-shut-the-allocated-instance-down>5. Shut the allocated instance down</h3><p>Since we&rsquo;ve only got one allocation, we&rsquo;ll just grab the details of the IP and port of the
only allocated <code>GameServer</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get gameservers <span style=color:#000;font-weight:700>|</span> grep Allocated <span style=color:#000;font-weight:700>|</span> awk <span style=color:#4e9a06>&#39;{print $3&#34;:&#34;$4 }&#39;</span>
</span></span></code></pre></div><p>This should output your Game Server IP address and port. (eg <code>10.130.65.208:7936</code>)</p><p>You can now communicate with the <code>GameServer</code>:</p><pre tabindex=0><code>nc -u {IP} {PORT}
Hello World !
ACK: Hello World !
EXIT
</code></pre><p>You can finally type <code>EXIT</code> which tells the SDK to run the <a href=http://localhost:1313/docs/guides/client-sdks/#shutdown>Shutdown command</a>, and therefore shuts down the <code>GameServer</code>.</p><h3 id=6-see-the-fleet-scaling-down>6. See the fleet scaling down</h3><p>Now let&rsquo;s wait a few seconds to allow the autoscaler to detect the change in the fleet and check again its status</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe fleetautoscaler simple-game-server-autoscaler
</span></span></code></pre></div><p>It should look something like this:</p><pre tabindex=0><code>Spec:
  Fleet Name:  simple-game-server
  Policy:
    Buffer:
      Buffer Size:   2
      Max Replicas:  10
      Min Replicas:  2
    Type:            Buffer
Status:
  Able To Scale:     true
  Current Replicas:  3
  Desired Replicas:  2
  Last Scale Time:   2018-10-02T16:09:02Z
  Scaling Limited:   false
Events:
  Type    Reason            Age   From                        Message
  ----    ------            ----  ----                        -------
  Normal  AutoScalingFleet  9m    fleetautoscaler-controller  Scaling fleet simple-game-server from 2 to 3
  Normal  AutoScalingFleet  45s   fleetautoscaler-controller  Scaling fleet simple-game-server from 3 to 2
</code></pre><p>You can see that the fleet size has decreased, the autoscaler adjusting to game server instance being de-allocated,
the Last Scale Time and the events have been updated. Note that simple-game-server game server instance you just closed earlier
might stay a bit in &lsquo;Unhealthy&rsquo; state (and its pod in &lsquo;Terminating&rsquo; until it gets removed.</p><p>Double-check the actual number of game server instances and status by running</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get gs
</span></span></code></pre></div><p>This will get you a list of all the current <code>GameServers</code> and their <code>Status > State</code>.</p><pre tabindex=0><code>NAME                             STATE     ADDRESS        PORT    NODE       AGE
simple-game-server-mzhrl-k6jg5   Ready     10.30.64.100   7243    minikube   5m
simple-game-server-mzhrl-t7944   Ready     10.30.64.168   7561    minikube   5m
</code></pre><h3 id=7-change-autoscaling-parameters>7. Change autoscaling parameters</h3><p>We can also change the configuration of the <code>FleetAutoscaler</code> of the running <code>Fleet</code>, and have the changes
applied live, without interruptions of service.</p><p>Run <code>kubectl edit fleetautoscaler simple-game-server-autoscaler</code> and set the <code>bufferSize</code> field to <code>5</code>.</p><p>Let&rsquo;s look at the list of game servers again. Run <code>watch kubectl get gs</code>
until you can see that are 5 ready server instances:</p><pre tabindex=0><code>NAME                             STATE     ADDRESS        PORT    NODE         AGE
simple-game-server-mzhrl-7jpkp   Ready     10.30.64.100   7019    minikube     5m
simple-game-server-mzhrl-czt8v   Ready     10.30.64.168   7556    minikube     5m
simple-game-server-mzhrl-k6jg5   Ready     10.30.64.100   7243    minikube     5m
simple-game-server-mzhrl-nb8h2   Ready     10.30.64.168   7357    minikube     5m
simple-game-server-mzhrl-qspb6   Ready     10.30.64.99    7859    minikube     5m
simple-game-server-mzhrl-zg9rq   Ready     10.30.64.99    7745    minikube     5m
</code></pre><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4><p>If you want to update a <code>Fleet</code> which has <code>RollingUpdate</code> replacement strategy and is controlled by a <code>FleetAutoscaler</code>:</p><ol><li>With <code>kubectl apply</code>: you should omit <code>replicas</code> parameter in a <code>Fleet</code> Spec before re-applying the <code>Fleet</code> configuration.</li><li>With <code>kubectl edit</code>: you should not change the <code>replicas</code> parameter in the <code>Fleet</code> Spec when updating other field parameters.</li></ol><p>If you follow the rules above, then the <code>maxSurge</code> and <code>maxUnavailable</code> parameters will be used as the RollingUpdate strategy updates your Fleet.
Otherwise the Fleet would be scaled according to Fleet <code>replicas</code> parameter first and only after a certain amount of time it would be rescaled to fit <code>FleetAutoscaler</code> <code>BufferSize</code> parameter.</p><p>You could also check the behaviour of the Fleet with Fleetautoscaler on a test <code>Fleet</code> to preview what would occur in your production environment.</p></div><h2 id=next-steps>Next Steps</h2><p>Read the advanced <a href=/docs/advanced/scheduling-and-autoscaling/>Scheduling and Autoscaling</a> guide, for more details on autoscaling.</p><p>If you want to use your own GameServer container make sure you have properly integrated the <a href=http://localhost:1313/docs/guides/client-sdks/>Code Blind SDK</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-41eab8b673334ca9325b8ab33261f1a3>4 - Quickstart: Create a Fleet Autoscaler with Webhook Policy</h1><div class=lead>This guide covers how you can create a webhook fleet autoscaler policy.</div><p>In some cases, your game servers may need to use custom logic for scaling your fleet that is more complex than what
can be expressed using the Buffer policy in the fleetautoscaler. This guide shows how you can extend Code Blind
with an autoscaler webhook to implement a custom autoscaling policy.</p><p>When you use an autoscaler webhook the logic computing the number of target replicas is delegated to an external
HTTP/S endpoint, such as one provided by a Kubernetes deployment and service in the same cluster (as shown in the
examples below). The fleetautoscaler will send a request to the webhook autoscaler&rsquo;s <code>/scale</code> endpoint every sync
period (currently 30s) with a JSON body, and scale the target fleet based on the data that is returned.</p><h2 id=chapter-1-configuring-http-fleetautoscaler-webhook>Chapter 1 Configuring HTTP fleetautoscaler webhook</h2><h3 id=prerequisites>Prerequisites</h3><p>It is assumed that you have completed the instructions to <a href=/docs/getting-started/create-fleet/>Create a Game Server Fleet</a> and have a running fleet of game servers.</p><h3 id=objectives>Objectives</h3><ul><li>Run a fleet</li><li>Deploy the Webhook Pod and service for autoscaling</li><li>Create a Fleet Autoscaler with Webhook policy type in Kubernetes using Code Blind custom resource</li><li>Watch the Fleet scales up when allocating GameServers</li><li>Watch the Fleet scales down after GameServer shutdown</li></ul><h4 id=1-deploy-the-fleet>1. Deploy the fleet</h4><p>Run a fleet in a cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/simple-game-server/fleet.yaml
</span></span></code></pre></div><h4 id=2-deploy-a-webhook-service-for-autoscaling>2. Deploy a Webhook service for autoscaling</h4><p>In this step we would deploy an example webhook that will control the size of the fleet based on allocated gameservers
portion in a fleet. You can see the source code for this example webhook server
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>here</a>.
The fleetautoscaler would trigger this endpoint every 30 seconds. More details could be found
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>also here</a>.
We need to create a pod which will handle HTTP requests with json payload
<a href=/docs/reference/fleetautoscaler/#webhook-endpoint-specification><code>FleetAutoscaleReview</code></a> and return back it
with <a href=/docs/reference/fleetautoscaler/#webhook-endpoint-specification><code>FleetAutoscaleResponse</code></a> populated.</p><p>The <code>Scale</code> flag and <code>Replicas</code> values returned in the <code>FleetAutoscaleResponse</code> tells the FleetAutoscaler what target size the backing Fleet should be scaled up or down to. If <code>Scale</code> is false - no scaling occurs.</p><p>Run next command to create a service and a Webhook pod in a cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/autoscaler-webhook/autoscaler-service.yaml
</span></span></code></pre></div><p>To check that it is running and liveness probe is fine:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe pod autoscaler-webhook
</span></span></code></pre></div><pre tabindex=0><code>Name:           autoscaler-webhook-86944884c4-sdtqh
Namespace:      default
Node:           gke-test-cluster-default-1c5dec79-h0tq/10.138.0.2
...
Status:         Running
</code></pre><h4 id=3-create-a-fleet-autoscaler>3. Create a Fleet Autoscaler</h4><p>Let&rsquo;s create a Fleet Autoscaler using the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/webhookfleetautoscaler.yaml
</span></span></code></pre></div><p>You should see a successful output similar to this:</p><pre tabindex=0><code>fleetautoscaler.autoscaling.agones.dev &#34;webhook-fleet-autoscaler&#34; created
</code></pre><p>This has created a FleetAutoscaler record inside Kubernetes.
It has the link to Webhook service we deployed above.</p><h4 id=4-see-the-fleet-and-autoscaler-status>4. See the fleet and autoscaler status.</h4><p>In order to track the list of gameservers which run in your fleet you can run this command in a separate terminal tab:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> watch <span style=color:#4e9a06>&#34;kubectl get gs -n default&#34;</span>
</span></span></code></pre></div><p>In order to get autoscaler status use the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe fleetautoscaler webhook-fleet-autoscaler
</span></span></code></pre></div><p>It should look something like this:</p><pre tabindex=0><code>Name:         webhook-fleet-autoscaler
Namespace:    default
Labels:       &lt;none&gt;
Annotations:  kubectl.kubernetes.io/last-applied-configuration={&#34;apiVersion&#34;:
&#34;autoscaling.agones.dev/v1&#34;,&#34;kind&#34;:&#34;FleetAutoscaler&#34;,&#34;metadata&#34;:{&#34;annotations&#34;
:{},&#34;name&#34;:&#34;webhook-fleet-autoscaler&#34;,&#34;namespace&#34;:&#34;default...
API Version:  autoscaling.agones.dev/v1
Kind:         FleetAutoscaler
etadata:
  Cluster Name:
  Creation Timestamp:  2018-12-22T12:52:23Z
  Generation:          1
  Resource Version:    2274579
  Self Link:           /apis/autoscaling.agones.dev/v1/namespaces/default/fleet
autoscalers/webhook-fleet-autoscaler
  UID:                 6d03eae4-05e8-11e9-84c2-42010a8a01c9
Spec:
  Fleet Name:  simple-game-server
  Policy:
    Type:  Webhook
    Webhook:
      Service:
        Name:       autoscaler-webhook-service
        Namespace:  default
        Path:       scale
      URL:
Status:
  Able To Scale:     true
  Current Replicas:  2
  Desired Replicas:  2
  Last Scale Time:   &lt;nil&gt;
  Scaling Limited:   false
Events:              &lt;none&gt;
</code></pre><p>You can see the status (able to scale, not limited), the last time the fleet was scaled (nil for never), current and desired fleet size.</p><p>The autoscaler makes a query to a webhoook service deployed on step 1 and on response changing the target Replica size, and the fleet creates/deletes game server instances
to achieve that number. The convergence is achieved in time, which is usually measured in seconds.</p><h4 id=5-allocate-game-servers-from-the-fleet-to-trigger-scale-up>5. Allocate Game Servers from the Fleet to trigger scale up</h4><p>If you&rsquo;re interested in more details for game server allocation, you should consult the <a href=/docs/getting-started/create-fleet/>Create a Game Server Fleet</a> page.
Here we only interested in triggering allocations to see the autoscaler in action.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/simple-game-server/gameserverallocation.yaml -o yaml
</span></span></code></pre></div><p>You should get in return the allocated game server details, which should end with something like:</p><pre tabindex=0><code>status:
  address: 34.94.118.237
  gameServerName: simple-game-server-v6jwb-6bzkz
  nodeName: gke-test-cluster-default-f11755a7-5km3
  ports:
  - name: default
    port: 7832
  state: Allocated
</code></pre><p>Note the address and port, you might need them later to connect to the server.</p><p>Run the kubectl command one more time so that we have both servers allocated:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/simple-game-server/gameserverallocation.yaml -o yaml
</span></span></code></pre></div><h4 id=6-check-new-autoscaler-and-fleet-status>6. Check new Autoscaler and Fleet status</h4><p>Now let&rsquo;s wait a few seconds to allow the autoscaler to detect the change in the fleet and check again its status</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe fleetautoscaler webhook-fleet-autoscaler
</span></span></code></pre></div><p>The last part should look similar to this:</p><pre tabindex=0><code>Spec:
  Fleet Name:  simple-game-server
  Policy:
    Type:  Webhook
    Webhook:
      Service:
        Name:       autoscaler-webhook-service
        Namespace:  default
        Path:       scale
      URL:
Status:
  Able To Scale:     true
  Current Replicas:  4
  Desired Replicas:  4
  Last Scale Time:   2018-12-22T12:53:47Z
  Scaling Limited:   false
Events:
  Type    Reason            Age   From                        Message
  ----    ------            ----  ----                        -------
  Normal  AutoScalingFleet  35s   fleetautoscaler-controller  Scaling fleet simple-game-server from 2 to 4
</code></pre><p>You can see that the fleet size has increased in particular case doubled to 4 gameservers (based on our custom logic in our webhook), the autoscaler having compensated for the two allocated instances.
Last Scale Time has been updated and a scaling event has been logged.</p><p>Double-check the actual number of game server instances and status by running:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> kubectl get gs -n default
</span></span></code></pre></div><p>This will get you a list of all the current <code>GameServers</code> and their <code>Status > State</code>.</p><pre tabindex=0><code>NAME                     STATE       ADDRESS         PORT     NODE        AGE
simple-game-server-dmkp4-8pkk2   Ready       35.247.13.175   7386     minikube     5m
simple-game-server-dmkp4-b7x87   Allocated   35.247.13.175   7219     minikube     5m
simple-game-server-dmkp4-r4qtt   Allocated   35.247.13.175   7220     minikube     5m
simple-game-server-dmkp4-rsr6n   Ready       35.247.13.175   7297     minikube     5m
</code></pre><h4 id=7-check-downscaling-using-webhook-autoscaler-policy>7. Check downscaling using Webhook Autoscaler policy</h4><p>Based on our custom webhook deployed earlier, if the fraction of allocated replicas in whole Replicas count would be less than threshold (0.3) then the fleet would scale down by scaleFactor, in our example by 2.</p><p>Note that the example webhook server has a limitation that it would not decrease fleet replica count under <code>minReplicasCount</code>, which is equal to 2.</p><p>We need to run EXIT command on one gameserver (Use IP address and port of the allocated gameserver from the previous step) in order to decrease the number of allocated gameservers in a fleet (&lt;0.3).</p><pre tabindex=0><code>nc -u 35.247.13.175 7220
EXIT
</code></pre><p>Server would be in shutdown state.
Wait about 30 seconds.
Then you should see scaling down event in the output of next command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe fleetautoscaler webhook-fleet-autoscaler
</span></span></code></pre></div><p>You should see these lines in events:</p><pre tabindex=0><code>  Normal   AutoScalingFleet  11m                fleetautoscaler-controller  Scaling fleet simple-game-server from 2 to 4
  Normal   AutoScalingFleet  1m                 fleetautoscaler-controller  Scaling fleet simple-game-server from 4 to 2
</code></pre><p>And get gameservers command output:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get gs -n default
</span></span></code></pre></div><pre tabindex=0><code>NAME                             STATUS      ADDRESS          PORT     NODE       AGE
simple-game-server-884fg-6q5sk   Ready       35.247.117.202   7373     minikube   5m
simple-game-server-884fg-b7l58   Allocated   35.247.117.202   7766     minikube   5m
</code></pre><h4 id=8-cleanup>8. Cleanup</h4><p>You can delete the autoscaler service and associated resources with the following commands.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl delete -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/autoscaler-webhook/autoscaler-service.yaml
</span></span></code></pre></div><p>Removing the fleet:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl delete -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/simple-game-server/fleet.yaml
</span></span></code></pre></div><h2 id=chapter-2-configuring-https-fleetautoscaler-webhook-with-ca-bundle>Chapter 2 Configuring HTTPS fleetautoscaler webhook with CA Bundle</h2><h3 id=objectives-1>Objectives</h3><p>Using TLS and a certificate authority (CA) bundle we can establish trusted communication between Fleetautoscaler and
an HTTPS server running the autoscaling webhook that controls the size of the fleet (Replicas count). The certificate of the
autoscaling webhook must be signed by the CA provided in fleetautoscaler yaml configuration file. Using TLS eliminates
the possibility of a man-in-the-middle attack between the fleetautoscaler and the autoscaling webhook.</p><h4 id=1-deploy-the-fleet-1>1. Deploy the fleet</h4><p>Run a fleet in a cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/simple-game-server/fleet.yaml
</span></span></code></pre></div><h4 id=2-create-x509-root-and-webhook-certificates>2. Create X509 Root and Webhook certificates</h4><p>The procedure of generating a Self-signed CA certificate is as follows:</p><p>The first step is to create the private root key:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl genrsa -out rootCA.key <span style=color:#0000cf;font-weight:700>2048</span>
</span></span></code></pre></div><p>The next step is to self-sign this certificate:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl req -x509 -new -nodes -key rootCA.key -sha256 -days <span style=color:#0000cf;font-weight:700>1024</span> -out rootCA.pem
</span></span></code></pre></div><p>This will start an interactive script that will ask you for various bits of information. Fill it out as you see fit.</p><p>Every webhook that you wish to install a trusted certificate will need to go through this process. First, just like with the root CA step, you’ll need to create a private key (different from the root CA):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl genrsa -out webhook.key <span style=color:#0000cf;font-weight:700>2048</span>
</span></span></code></pre></div><p>Next create configuration file <code>cert.conf</code> for the certificate signing request:</p><pre tabindex=0><code class=language-none data-lang=none>[req]
distinguished_name = req_distinguished_name
req_extensions = v3_req
prompt = no
[req_distinguished_name]
CN = autoscaler-tls-service.default.svc
[v3_req]
keyUsage = digitalSignature
extendedKeyUsage = serverAuth
subjectAltName = @alt_names
[alt_names]
DNS.1 = autoscaler-tls-service.default.svc
</code></pre><p>Generate the certificate signing request, use valid hostname which in this case will be <code>autoscaler-tls-service.default.svc</code> as <code>Common Name (eg, fully qualified host name)</code> as well as <code>DNS.1</code> in the <code>alt_names</code> section of the config file.</p><p>Check the <a href=https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/#a-aaaa-records>Kubernetes documentation</a> to see how Services get assigned DNS entries.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl req -new -out webhook.csr -key webhook.key -config cert.conf
</span></span></code></pre></div><p>Once that’s done, you’ll sign the CSR, which requires the CA root key:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl x509 -req -in webhook.csr -CA rootCA.pem -CAkey rootCA.key -CAcreateserial -out webhook.crt -days <span style=color:#0000cf;font-weight:700>500</span> -sha256 -extfile cert.conf -extensions v3_req
</span></span></code></pre></div><p>This would generate webhook.crt certificate</p><p>Add secret which later would be mounted to autoscaler-webhook-tls pod.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create secret tls autoscalersecret --cert<span style=color:#ce5c00;font-weight:700>=</span>webhook.crt --key<span style=color:#ce5c00;font-weight:700>=</span>webhook.key
</span></span></code></pre></div><p>You need to put Base64-encoded string into caBundle field in your fleetautoscaler yaml configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>base64 -i ./rootCA.pem
</span></span></code></pre></div><p>Copy the output of the command above and replace the caBundle field in your text editor (say vim) with the new value:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/webhookfleetautoscalertls.yaml
</span></span><span style=display:flex><span>vim ./webhookfleetautoscalertls.yaml
</span></span></code></pre></div><h4 id=3-deploy-a-webhook-service-for-autoscaling>3. Deploy a Webhook service for autoscaling</h4><p>Run next command to create a service and a Webhook pod in a cluster:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/autoscaler-webhook/autoscaler-service-tls.yaml
</span></span></code></pre></div><p>To check that it is running and liveness probe is fine:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe pod autoscaler-webhook-tls
</span></span></code></pre></div><p>Wait for the Running status results:</p><pre tabindex=0><code>Name:               autoscaler-webhook-tls-f74c9bff7-ssrsc
Namespace:          default
...
Status:         Running
</code></pre><h4 id=4-create-a-fleet-autoscaler>4. Create a Fleet Autoscaler</h4><p>Let&rsquo;s create a Fleet Autoscaler using the following command (caBundle should be set properly on Step 2):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f ./webhookfleetautoscalertls.yaml
</span></span></code></pre></div><h4 id=5-see-the-fleet-and-autoscaler-status>5. See the fleet and autoscaler status.</h4><p>In order to track the list of gameservers which run in your fleet you can run this command in a separate terminal tab:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> watch <span style=color:#4e9a06>&#34;kubectl get gs -n default&#34;</span>
</span></span></code></pre></div><h4 id=6-allocate-two-game-servers-from-the-fleet-to-trigger-scale-up>6. Allocate two Game Servers from the Fleet to trigger scale up</h4><p>If you&rsquo;re interested in more details for game server allocation, you should consult the <a href=/docs/getting-started/create-fleet/>Create a Game Server Fleet</a> page.
Here we only interested in triggering allocations to see the autoscaler in action.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87;font-weight:700>for</span> i in <span style=color:#ce5c00;font-weight:700>{</span>0..1<span style=color:#ce5c00;font-weight:700>}</span> <span style=color:#000;font-weight:700>;</span> <span style=color:#204a87;font-weight:700>do</span> kubectl create -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/simple-game-server/gameserverallocation.yaml -o yaml <span style=color:#000;font-weight:700>;</span> <span style=color:#204a87;font-weight:700>done</span>
</span></span></code></pre></div><h4 id=7-check-new-autoscaler-and-fleet-status>7. Check new Autoscaler and Fleet status</h4><p>Now let&rsquo;s wait a few seconds to allow the autoscaler to detect the change in the fleet and check again its status</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe fleetautoscaler  webhook-fleetautoscaler-tls
</span></span></code></pre></div><p>The last part should look similar to this:</p><pre tabindex=0><code>Spec:
  Fleet Name:  simple-game-server
  Policy:
    Type:  Webhook
    Webhook:
      Ca Bundle:  LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUN1RENDQWFBQ0NRQ29kcEFNbTlTd0pqQU5CZ2txaGtpRzl3MEJBUXNGQURBZU1Rc3dDUVlEVlFRR0V3SlYKVXpFUE1BMEdBMVVFQ3d3R1FXZHZibVZ6TUI0WERURTVNREV3TkRFeE5URTBORm9YRFRJeE1UQXlOREV4TlRFMApORm93SGpFTE1Ba0dBMVVFQmhNQ1ZWTXhEekFOQmdOVkJBc01Ca0ZuYjI1bGN6Q0NBU0l3RFFZSktvWklodmNOCkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFOQ0h5dndDOTZwZDlTdkFhMUIvRWg2ekcxeDBLS1dPaVhtNzhJcngKKzZ5WHd5YVpsMVo1cVExbUZoOThMSGVZUmQwWVgzRTJnelZ5bFpvUlUra1ZESzRUc0VzV0tNUFVpdVo0MUVrdApwbythbEN6alAyaXZzRGZaOGEvdnByL3dZZ2FrWGtWalBUaGpKUk9xTnFIdWROMjZVcUFJYnNOTVpoUkxkOVFFCnFLSjRPNmFHNVMxTVNqZFRGVHFlbHJiZitDcXNKaHltZEIzZmxGRUVvdXExSmoxS0RoQjRXWlNTbS9VSnpCNkcKNHUzY3BlQm1jTFVRR202ZlFHb2JFQSt5SlpMaEVXcXBrd3ZVZ2dCNmRzWE8xZFNIZXhhZmlDOUVUWGxVdFRhZwo1U2JOeTVoYWRWUVV3Z253U0J2djR2R0t1UUxXcWdXc0JyazB5Wll4Sk5Bb0V5RUNBd0VBQVRBTkJna3Foa2lHCjl3MEJBUXNGQUFPQ0FRRUFRMkgzaWJRcWYzQTNES2l1eGJISURkbll6TlZ2Z0dhRFpwaVZyM25ocm55dmxlNVgKR09hRm0rMjdRRjRWV29FMzZDTGhYZHpEWlM4bEpIY09YUW5KOU83Y2pPYzkxVmh1S2NmSHgwS09hU1oweVNrVAp2bEtXazlBNFdoNGE0QXFZSlc3Z3BUVHR1UFpydnc4VGsvbjFaWEZOYVdBeDd5RU5OdVdiODhoNGRBRDVaTzRzCkc5SHJIdlpuTTNXQzFBUXA0Q3laRjVyQ1I2dkVFOWRkUmlKb3IzM3pLZTRoRkJvN0JFTklZZXNzZVlxRStkcDMKK0g4TW5LODRXeDFUZ1N5Vkp5OHlMbXFpdTJ1aThjaDFIZnh0OFpjcHg3dXA2SEZLRlRsTjlBeXZUaXYxYTBYLwpEVTk1eTEwdi9oTlc0WHpuMDJHNGhrcjhzaUduSEcrUEprT3hBdz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
      Service:    &lt;nil&gt;
      URL:        https://autoscaler-tls-service.default.svc:8000/scale
Events:
  Type    Reason            Age   From                        Message
  ----    ------            ----  ----                        -------
  Normal  AutoScalingFleet  5s   fleetautoscaler-controller  Scaling fleet simple-game-server from 2 to 4
</code></pre><p>You can see that the fleet size has increased in particular case doubled to 4 gameservers (based on our custom logic in our webhook), the autoscaler having compensated for the two allocated instances.
Last Scale Time has been updated and a scaling event has been logged.</p><p>Double-check the actual number of game server instances and status by running:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> kubectl get gs -n default
</span></span></code></pre></div><p>This will get you a list of all the current <code>GameServers</code> and their <code>Status > State</code>.</p><pre tabindex=0><code>NAME                     STATE       ADDRESS         PORT      NODE      AGE
simple-game-server-njmr7-2t4nx   Ready       35.203.159.68   7330      minikube   1m
simple-game-server-njmr7-65rp6   Allocated   35.203.159.68   7294      minikube   4m
</code></pre><h4 id=8-cleanup-1>8. Cleanup</h4><p>You can delete the autoscaler service and associated resources with the following commands.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl delete -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/autoscaler-webhook/autoscaler-service-tls.yaml
</span></span></code></pre></div><p>Removing x509 key secret:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl delete secret autoscalersecret
</span></span></code></pre></div><p>Removing the fleet:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl delete -f https://raw.githubusercontent.com/googleforgames/agones/release-1.38.0/examples/simple-game-server/fleet.yaml
</span></span></code></pre></div><h3 id=comments>Comments</h3><p>Note that secure communication has been established and we can trust that communication between the fleetautoscaler and
the autoscaling webhook. If you need to run the autoscaling webhook outside of the Kubernetes cluster, you can use
another root certificate authority as long as you put it into the caBundle parameter in fleetautoscaler configuration
(in pem format, base64-encoded).</p><h2 id=troubleshooting-guide>Troubleshooting Guide</h2><p>If you run into problems with the configuration of your fleetautoscaler and webhook service the easiest way to debug
them is to run:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe fleetautoscaler &lt;FleetAutoScalerName&gt;
</span></span></code></pre></div><p>and inspect the events at the bottom of the output.</p><h3 id=common-error-messages>Common error messages.</h3><p>If you have configured the wrong service Path for the FleetAutoscaler you will see a message like</p><pre tabindex=0><code>Error calculating desired fleet size on FleetAutoscaler simple-fleet-r7fdv-autoscaler. Error: bad status code 404 from the server: https://autoscaler-tls-service.default.svc:8000/scale
</code></pre><p>If you are using a hostname other than <code>autoscaler-tls-service.default.svc</code> as the
<code>Common Name (eg, fully qualified host name)</code> when creating a certificate using <code>openssl</code> tool you will see a
message like</p><pre tabindex=0><code>Post https://autoscaler-tls-service.default.svc:8000/scale: x509: certificate is not valid for any names, but wanted to match autoscaler-tls-service.default.svc
</code></pre><p>If you see errors like the following in <code>autoscaler-webhook-tls</code> pod logs:</p><pre tabindex=0><code>http: TLS handshake error from 10.48.3.125:33374: remote error: tls: bad certificate
</code></pre><p>Then there could be an issue with your <code>./rootCA.pem</code>.</p><p>You can repeat the process from step 2, in order to fix your certificates setup.</p><h2 id=next-steps>Next Steps</h2><p>Read the advanced <a href=/docs/advanced/scheduling-and-autoscaling/>Scheduling and Autoscaling</a> guide, for more details on autoscaling.</p><p>If you want to use your own GameServer container make sure you have properly integrated the <a href=/docs/guides/client-sdks/>Code Blind SDK</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-968dadb4e3c831fafc44763def50a585>5 - Quickstart: Edit a Game Server</h1><div class=lead>The following guide is for developers without Docker or Kubernetes experience, that want to use the simple-game-server example as a starting point for a custom game server.</div><p>This guide addresses Google Kubernetes Engine and Minikube. We would welcome a Pull Request to expand this to include other platforms as well.</p><h2 id=prerequisites>Prerequisites</h2><ol><li>A <a href=https://golang.org/dl/>Go</a> environment</li><li><a href=https://www.docker.com/get-started/>Docker</a></li><li>Code Blind installed on GKE or Minikube</li><li>kubectl properly configured</li></ol><p>To install on GKE, follow the install instructions (if you haven&rsquo;t already) at
<a href=http://localhost:1313/docs/installation/creating-cluster/gke/>Setting up a Google Kubernetes Engine (GKE) cluster</a>.
Also complete the &ldquo;Enabling creation of RBAC resources&rdquo; and &ldquo;Installing Code Blind&rdquo; sets of instructions on the same page.</p><p>To install locally on Minikube, read <a href=http://localhost:1313/docs/installation/creating-cluster/minikube/>Setting up a Minikube cluster</a>.
Also complete the &ldquo;Enabling creation of RBAC resources&rdquo; and &ldquo;Installing Code Blind&rdquo; sets of instructions on the same page.</p><h2 id=modify-the-code-and-push-another-new-image>Modify the code and push another new image</h2><h3 id=modify-the-simple-game-server-example-source-code>Modify the simple-game-server example source code</h3><p>Modify the
<a href=https://github.com/josephbarnett/codeblind.ai/blob/release-1.38.0/ target=_blank data-proofer-ignore>main.go</a> file. For example:</p><p>Change the following line in <code>main.go</code>:</p><p>From:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>respond</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>conn</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>sender</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;ACK: &#34;</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#000>txt</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#4e9a06>&#34;\n&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><p>To:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>respond</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>conn</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>sender</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;ACK: Echo says &#34;</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#000>txt</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#4e9a06>&#34;\n&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><h3 id=build-server>Build Server</h3><p>Since Docker image is using Alpine Linux, the &ldquo;go build&rdquo; command has to include few more environment variables.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>go get agones.dev/agones/pkg/sdk
</span></span><span style=display:flex><span><span style=color:#000>GOOS</span><span style=color:#ce5c00;font-weight:700>=</span>linux <span style=color:#000>GOARCH</span><span style=color:#ce5c00;font-weight:700>=</span>amd64 <span style=color:#000>CGO_ENABLED</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>0</span> go build -o bin/server -a -v main.go
</span></span></code></pre></div><h2 id=using-docker-file>Using Docker File</h2><h3 id=create-a-new-docker-image>Create a new docker image</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker build -t gcr.io/<span style=color:#ce5c00;font-weight:700>[</span>PROJECT_ID<span style=color:#ce5c00;font-weight:700>]</span>/agones-simple-game-server:modified .
</span></span></code></pre></div><p>Note: you can change the image name &ldquo;agones-simple-game-server&rdquo; to something else.</p><h3 id=if-using-gke-push-the-image-to-gcp-registry>If using GKE, push the image to GCP Registry</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker push gcr.io/<span style=color:#ce5c00;font-weight:700>[</span>PROJECT_ID<span style=color:#ce5c00;font-weight:700>]</span>/agones-simple-game-server:modified
</span></span></code></pre></div><p>Note: Review <a href=https://cloud.google.com/container-registry/docs/advanced-authentication>Authentication Methods</a>
for additional information regarding use of gcloud as a Docker credential helper
and advanced authentication methods to the Google Container Registry.</p><h3 id=if-using-minikube-load-the-image-into-minikube>If using Minikube, load the image into Minikube</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>minikube cache add gcr.io/<span style=color:#ce5c00;font-weight:700>[</span>PROJECT_ID<span style=color:#ce5c00;font-weight:700>]</span>/agones-agones-simple-game-server:modified
</span></span></code></pre></div><h3 id=modify-gameserveryaml>Modify gameserver.yaml</h3><p>Modify the following line from gameserver.yaml to use the new configuration.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>containers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>agones-simple-game-server</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>image</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>gcr.io/[PROJECT_ID]/agones-simple-game-server:modified</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=if-using-gke-deploy-server-to-gke>If using GKE, deploy Server to GKE</h3><p>Apply the latest settings to the Kubernetes container.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gcloud config <span style=color:#204a87>set</span> container/cluster <span style=color:#ce5c00;font-weight:700>[</span>CLUSTER_NAME<span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span>gcloud container clusters get-credentials <span style=color:#ce5c00;font-weight:700>[</span>CLUSTER_NAME<span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span>kubectl apply -f gameserver.yaml
</span></span></code></pre></div><h3 id=if-using-minikube-deploy-the-server-to-minikube>If using Minikube, deploy the Server to Minikube</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f gameserver.yaml
</span></span></code></pre></div><h3 id=check-the-gameserver-status>Check the GameServer Status</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl describe gameserver
</span></span></code></pre></div><h3 id=verify>Verify</h3><p>Let&rsquo;s retrieve the IP address and the allocated port of your Game Server:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get gs simple-game-server -o <span style=color:#000>jsonpath</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;{.status.address}:{.status.ports[0].port}&#39;</span>
</span></span></code></pre></div><p>You can now communicate with the Game Server :</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>If you do not have netcat installed
(i.e. you get a response of <code>nc: command not found</code>),
you can install netcat by running <code>sudo apt install netcat</code>.</div><pre tabindex=0><code>nc -u {IP} {PORT}
Hello World!
ACK:  Echo says  Hello World!
EXIT
</code></pre><p>You can finally type <code>EXIT</code> which tells the SDK to run the <a href=http://localhost:1313/docs/guides/client-sdks/#shutdown>Shutdown command</a>, and therefore shuts down the <code>GameServer</code>.</p><p>If you run <code>kubectl describe gameserver</code> again - either the GameServer will be gone completely, or it will be in <code>Shutdown</code> state, on the way to being deleted.</p><h2 id=next-steps>Next Steps</h2><p>If you want to perform rolling updates of modified game servers, see <a href=/docs/getting-started/create-fleet/>Quickstart Create a Game Server Fleet</a>.</p></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Discord aria-label=Discord><a target=_blank rel=noopener href=https://discord.gg/XCuWVReewp aria-label=Discord><i class="fab fa-discord"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="User mailing list" aria-label="User mailing list"><a target=_blank rel=noopener href=https://groups.google.com/forum/#!forum/codeblind-discuss aria-label="User mailing list"><i class="fa fa-envelope"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=X aria-label=X><a target=_blank rel=noopener href=https://twitter.com/codeblind aria-label=X><i class="fab fa-x-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="Community Meetings" aria-label="Community Meetings"><a target=_blank rel=noopener href=https://github.com/josephbarnett/ aria-label="Community Meetings"><i class="fab fa-youtube"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/josephbarnett/ aria-label=GitHub><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Resume aria-label=Resume><a target=_blank rel=noopener href=https://github.com/josephbarnett/ aria-label=Resume><i class="fab fa-linkedin"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Facebook aria-label=Facebook><a target=_blank rel=noopener href=https://github.com/josephbarnett/ aria-label=Facebook><i class="fab fa-facebook"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Contact aria-label=Contact><a target=_blank rel=noopener href=https://github.com/josephbarnett/codeblind.ai aria-label=Contact><i class="fab fa-whatsapp"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2024
<span class=td-footer__authors>Copyright Code Blind LLC</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href=https://policies.google.com/privacy target=_blank rel=noopener>Privacy Policy</a></span></div></div></div></footer></div><script src=/js/main.js></script><script src=/js/prism.js></script><script src=/js/tabpane-persist.js></script><script src=http://localhost:1313/js/asciinema-player.js></script></body></html>